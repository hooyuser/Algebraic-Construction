%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PACKAGE IMPORTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% --- 1. SETUP & FUNDAMENTALS (Load these first to define page/colors) ---
% Load xcolor FIRST to avoid "Option Clash" with tikz/tcolorbox
\usepackage[table]{xcolor} 
\usepackage[tmargin=2cm,rmargin=1in,lmargin=1in,margin=0.85in,bmargin=1.5cm,footskip=0.8cm]{geometry}
\usepackage{etoolbox}
\usepackage{anyfontsize}


% --- 2. MATH PACKAGES ---
\usepackage{amsmath,amsfonts,amsthm,amssymb,mathtools}
\usepackage{cancel}
\usepackage{leftindex}
\usepackage{relsize}
\usepackage{mathrsfs}
\usepackage{stmaryrd}

% --- 3. FONTS ---
\usepackage{dsfont}
\usepackage{bbm}
% \usepackage[bb=dsserif]{mathalpha}
\usepackage{bm}

% --- 4. GRAPHICS & DRAWING ---
\usepackage{graphicx}
\graphicspath{ {./images/} }
\usepackage{tikz-cd}
\usepackage{chemfig}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usepgfplotslibrary{patchplots}


% --- 5. TABLES, BOXES & LISTS ---
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{colortbl}
\usepackage{multicol,array}
\usepackage{varwidth}
\usepackage{enumerate}
\usepackage[shortlabels]{enumitem}
% Load tcolorbox after xcolor to ensure it sees the colors correctly
\usepackage[most]{tcolorbox}


% --- 6. STRUCTURE & UTILITIES ---
\usepackage{imakeidx}
\usepackage{sectsty}
\usepackage{fancyhdr}
\usepackage[page,toc,titletoc,title]{appendix}

% --- 7. HYPERLINKS & REFERENCES (MUST be last) ---
% Hyperref goes last (with very few exceptions)
\usepackage[hidelinks]{hyperref} 
% Packages that MUST go AFTER hyperref:
\usepackage{bookmark}
\usepackage{nameref}
\usepackage[nameinlink]{cleveref}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% HEADER AND FOOTER
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pagestyle{fancy}

% Clear all header and footer fields
\fancyhf{}

% Redefine the chaptermark
\renewcommand{\chaptermark}[1]{%
  \markboth{\thechapter.\ \MakeUppercase{#1}}{}%
}

% Chapter name on the left of the header
\fancyhead[L]{\leftmark}

% Section name on the right of the header
\fancyhead[R]{\rightmark}

% Page number on the bottom right 
\fancyfoot[R]{\thepage}

% Line at the top of the header
\renewcommand{\headrulewidth}{0.0pt}

\fancypagestyle{plain}{%
  \fancyhf{} % clear all header and footer fields
  \fancyfoot[R]{\thepage}
  \renewcommand{\headrulewidth}{0pt} % remove the header rule
  \renewcommand{\footrulewidth}{0pt} % remove the footer rule
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SELF MADE COLORS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usetikzlibrary{shapes.geometric}
\usetikzlibrary{calc}


\definecolor{myg}{RGB}{56, 140, 70}
\definecolor{myb}{RGB}{45, 111, 177}
\definecolor{myr}{RGB}{199, 68, 64}
\definecolor{mytheorembg}{HTML}{fdf8ea} %orange
\definecolor{mytheoremfr}{HTML}{f19000}
\definecolor{myexamplebg}{HTML}{F2FBF8}
\definecolor{myexamplefr}{HTML}{88D6D1}
\definecolor{myexampleti}{HTML}{2A7F7F}
\definecolor{mydefinitbg}{HTML}{F2F2F9} %blue
\definecolor{mydefinitfr}{HTML}{00007B} 
\definecolor{mypropbg}{RGB}{56, 140, 70} %green
\definecolor{mypropfr}{RGB}{56, 140, 70}
\definecolor{mylemmabg}{RGB}{169, 144, 126}
\definecolor{mylemmafr}{RGB}{169, 144, 126}
\definecolor{notesgreen}{RGB}{0,162,0}
\definecolor{myp}{RGB}{197, 92, 212}
\definecolor{mygr}{HTML}{2C3338}
\definecolor{myred}{RGB}{127,0,0}
\definecolor{myyellow}{RGB}{169,121,69}
\definecolor{OrangeRed}{HTML}{ED135A}
\definecolor{Dandelion}{HTML}{FDBC42}
\definecolor{light-gray}{gray}{0.95}
\definecolor{Emerald}{HTML}{00A99D}
\definecolor{RoyalBlue}{HTML}{0071BC}

% \definecolor{mydefnewbg}{HTML}{FFF0E0}
% \definecolor{mydefnewfr}{HTML}{FF9900}
\definecolor{myRoyalBlue}{RGB}{50,60,150}
\definecolor{myGreen}{RGB}{45,100,45}
\definecolor{mynavy}{RGB}{56, 102, 148} % RGB color model

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% HYPERREF SETUP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\hypersetup{
	colorlinks=true,
	linkcolor=mynavy,
	citecolor=BurntOrange,
	bookmarksnumbered=true,
	bookmarksopen=true,
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TCOLORBOX SETUPS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%================================
% NEW DEFINITION BOX
%================================


\newtcbtheorem[number within=section]{definition}{Definition}
{%
    enhanced
    ,breakable
    ,colback = mydefinitbg
    ,frame hidden
    ,boxrule = 0sp
    ,borderline west = {2pt}{0pt}{mydefinitfr}
    ,sharp corners
    ,detach title
    ,before upper = \tcbtitle\par\smallskip
    ,coltitle = mydefinitfr!85!black
    ,fonttitle = \bfseries\sffamily
    ,description font = \mdseries
    ,separator sign none
    ,segmentation style={solid, mydefinitfr!85!black}
	,label type=definition
}
{th}

\setlength{\parindent}{0.5cm}
%================================
% THEOREM BOX
%================================

\tcbuselibrary{theorems,skins,hooks}
\newtcbtheorem[use counter from=definition, number within=section]{theorem}{Theorem}
{%
	enhanced,
	breakable,
	colback = mytheorembg,
	frame hidden,
	boxrule = 0sp,
	borderline west = {2pt}{0pt}{mytheoremfr},
	sharp corners,
	detach title,
	before upper = \tcbtitle\par\smallskip,
	coltitle = mytheoremfr,
	fonttitle = \bfseries\sffamily,
	description font = \mdseries,
	separator sign none,
	segmentation style={solid, mytheoremfr},
	label type=theorem
}
{th}

\tcbuselibrary{theorems,skins,hooks}
\newtcolorbox{Theoremcon}
{%
	enhanced
	,breakable
	,colback = mytheorembg
	,frame hidden
	,boxrule = 0sp
	,borderline west = {2pt}{0pt}{mytheoremfr}
	,sharp corners
	,description font = \mdseries
	,separator sign none
}


%================================
% Corollary
%================================
\tcbuselibrary{theorems,skins,hooks}
\newtcbtheorem[use counter from=definition, number within=section]{corollary}{Corollary}
{%
	enhanced
	,breakable
	,colback = myp!10
	,frame hidden
	,boxrule = 0sp
	,borderline west = {2pt}{0pt}{myp!85!black}
	,sharp corners
	,detach title
	,before upper = \tcbtitle\par\smallskip
	,coltitle = myp!85!black
	,fonttitle = \bfseries\sffamily
	,description font = \mdseries
	,separator sign none
	,segmentation style={solid, myp!85!black}
	,label type=corollary
}
{th}

%================================
% CLAIM
%================================

\tcbuselibrary{theorems,skins,hooks}
\newtcbtheorem[number within=section]{claim}{Claim}
{%
	enhanced
	,breakable
	,colback = myg!10
	,frame hidden
	,boxrule = 0sp
	,borderline west = {2pt}{0pt}{myg}
	,sharp corners
	,detach title
	,before upper = \tcbtitle\par\smallskip
	,coltitle = myg!85!black
	,fonttitle = \bfseries\sffamily
	,description font = \mdseries
	,separator sign none
	,segmentation style={solid, myg!85!black}
	,label type=claim
}
{th}


\newtcbtheorem[number within=chapter]{Claim}{Claim}
{%
	enhanced
	,breakable
	,colback = myg!10
	,frame hidden
	,boxrule = 0sp
	,borderline west = {2pt}{0pt}{myg}
	,sharp corners
	,detach title
	,before upper = \tcbtitle\par\smallskip
	,coltitle = myg!85!black
	,fonttitle = \bfseries\sffamily
	,description font = \mdseries
	,separator sign none
	,segmentation style={solid, myg!85!black}
	,label type=claim
}
{th}
%================================
% PROPOSITION
%================================

\tcbuselibrary{theorems,skins,hooks}
\newtcbtheorem[use counter from=definition, number within=section]{proposition}{Proposition}
{%
	enhanced
	,breakable
	,colback = mypropbg!10
	,frame hidden
	,boxrule = 0sp
	,borderline west = {2pt}{0pt}{mypropfr!85!black}
	,sharp corners
	,detach title
	,before upper = \tcbtitle\par\smallskip
	,coltitle = mypropfr!85!black
	,fonttitle = \bfseries\sffamily
	,description font = \mdseries
	,separator sign none
	,segmentation style={solid, mypropfr!85!black}
	,label type=proposition
}
{th}

%================================
% LEMMA
%================================

\tcbuselibrary{theorems,skins,hooks}
\newtcbtheorem[use counter from=definition, number within=section]{lemma}{Lemma}
{%
	enhanced
	,breakable
	,colback = mylemmabg!10
	,frame hidden
	,boxrule = 0sp
	,borderline west = {2pt}{0pt}{mylemmafr!85!black}
	,sharp corners
	,detach title
	,before upper = \tcbtitle\par\smallskip
	,coltitle = mylemmafr!85!black
	,fonttitle = \bfseries\sffamily
	,description font = \mdseries
	,separator sign none
	,segmentation style={solid, mylemmafr!85!black}
	,label type=lemma
}
{th}

%================================
% EXAMPLE BOX
%================================
\newtcbtheorem[number within=section]{example}{Example}
{%
    enhanced, % Required for extras and borderline
    colback = myexamplebg,
    breakable,
    colframe = myexamplefr,
    coltitle = myexampleti,
    boxrule = 1pt,
    sharp corners,
    detach title,
    before upper=\tcbtitle\par\smallskip,
    fonttitle = \bfseries\sffamily,
    description font = \mdseries\sffamily,
    separator sign={}, % Correct way to remove the separator
    label type=example,
    %
    % --- THE FIX IS HERE ---
    extras first={
        bottomrule=0pt, % 1. Turn off the solid frame at bottom
        borderline south={1pt}{0pt}{ % 2. Draw the dashed line
            myexamplefr, 
            dashed, 
            dash pattern=on 5pt off 5pt % <--- Makes dashes visible!
        } 
    },
    extras last={
        toprule=0pt, % 1. Turn off the solid frame at top
        borderline north={1pt}{0pt}{
            myexamplefr, 
            dashed, 
            dash pattern=on 5pt off 5pt
        }
    },
    extras middle={
        bottomrule=0pt,
        toprule=0pt,
        borderline south={1pt}{0pt}{
            myexamplefr, dashed, dash pattern=on 5pt off 5pt
        },
        borderline north={1pt}{0pt}{
            myexamplefr, dashed, dash pattern=on 5pt off 5pt
        }
    }
}
{ex}
% \newtcbtheorem[number within=section]{example}{Example}
% {%
%     enhanced % <--- 1. REQUIRED: Enables advanced border handling
%     ,colback = myexamplebg
%     ,breakable
%     ,colframe = myexamplefr
%     ,coltitle = myexampleti
%     ,boxrule = 1pt
%     ,sharp corners
%     ,detach title
%     ,before upper=\tcbtitle\par\smallskip
%     ,fonttitle = \bfseries\sffamily
%     ,description font = \mdseries\sffamily
%     ,separator sign none
%     ,label type=example
%     %
%     % --- 2. THE BREAKING LOGIC ---
%     ,extras first={
%         bottomrule=0pt, % Remove solid bottom line
%         % Draw dashed line using your frame color
%         borderline south={1pt}{0pt}{dashed, myexamplefr} 
%     }
%     ,extras last={
%         toprule=0pt, % Remove solid top line
%         borderline north={1pt}{0pt}{dashed, myexamplefr}
%     }
%     ,extras middle={
%         bottomrule=0pt,
%         toprule=0pt,
%         borderline south={1pt}{0pt}{dashed, myexamplefr},
%         borderline north={1pt}{0pt}{dashed, myexamplefr}
%     }
% }
% {ex}

%%%%%%%%%% temp comment out
% \newtcbtheorem[number within=section]{example}{Example}
% {%
% 	colback = myexamplebg
% 	,breakable
% 	,colframe = myexamplefr
% 	,coltitle = myexampleti
% 	,boxrule = 1pt
% 	,sharp corners
% 	,detach title
% 	,before upper=\tcbtitle\par\smallskip
% 	,fonttitle = \bfseries\sffamily
% 	,description font = \mdseries\sffamily
% 	,separator sign none
% 	%,description delimiters parenthesis
% 	,label type=example
% }
% {ex}

% \newtcbtheorem[number within=chapter]{example}{Example}
% {%
% 	colback = myexamplebg
% 	,breakable
% 	,colframe = myexamplefr
% 	,coltitle = myexampleti
% 	,boxrule = 1pt
% 	,sharp corners
% 	,detach title
% 	,before upper=\tcbtitle\par\smallskip
% 	,fonttitle = \bfseries
% 	,description font = \mdseries
% 	,separator sign none
% 	,description delimiters parenthesis
% 	,label type=example
% }
% {ex}

%================================
% DEFINITION BOX
%================================

% \newtcbtheorem[number within=section]{Definition}{Definition}{enhanced,
% 	before skip=2mm,after skip=2mm, colback=red!5,colframe=red!80!black,boxrule=0.5mm,
% 	attach boxed title to top left={xshift=1cm,yshift*=1mm-\tcboxedtitleheight}, varwidth boxed title*=-3cm,
% 	boxed title style={frame code={
% 					\path[fill=tcbcolback]
% 					([yshift=-1mm,xshift=-1mm]frame.north west)
% 					arc[start angle=0,end angle=180,radius=1mm]
% 					([yshift=-1mm,xshift=1mm]frame.north east)
% 					arc[start angle=180,end angle=0,radius=1mm];
% 					\path[left color=tcbcolback!60!black,right color=tcbcolback!60!black,
% 						middle color=tcbcolback!80!black]
% 					([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)
% 					[rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)
% 					-- (frame.south east) -- (frame.south west)
% 					-- ([xshift=-1mm,yshift=-1mm]frame.north west)
% 					[sharp corners]-- cycle;
% 				},interior engine=empty,
% 		},
% 	fonttitle=\bfseries,
% 	title={#2},#1}{def}
% \newtcbtheorem[number within=chapter]{definition}{Definition}{enhanced,
% 	before skip=2mm,after skip=2mm, colback=red!5,colframe=red!80!black,boxrule=0.5mm,
% 	attach boxed title to top left={xshift=1cm,yshift*=1mm-\tcboxedtitleheight}, varwidth boxed title*=-3cm,
% 	boxed title style={frame code={
% 					\path[fill=tcbcolback]
% 					([yshift=-1mm,xshift=-1mm]frame.north west)
% 					arc[start angle=0,end angle=180,radius=1mm]
% 					([yshift=-1mm,xshift=1mm]frame.north east)
% 					arc[start angle=180,end angle=0,radius=1mm];
% 					\path[left color=tcbcolback!60!black,right color=tcbcolback!60!black,
% 						middle color=tcbcolback!80!black]
% 					([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)
% 					[rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)
% 					-- (frame.south east) -- (frame.south west)
% 					-- ([xshift=-1mm,yshift=-1mm]frame.north west)
% 					[sharp corners]-- cycle;
% 				},interior engine=empty,
% 		},
% 	fonttitle=\bfseries,
% 	title={#2},#1}{def}



%================================
% OPEN QUESTION BOX
%================================

\newtcbtheorem[number within=section]{open}{Open Question}{enhanced,
	before skip=2mm,after skip=2mm, colback=myp!5,colframe=myp!80!black,boxrule=0.5mm,
	attach boxed title to top left={xshift=1cm,yshift*=1mm-\tcboxedtitleheight}, varwidth boxed title*=-3cm,
	boxed title style={frame code={
			\path[fill=tcbcolback]
			([yshift=-1mm,xshift=-1mm]frame.north west)
			arc[start angle=0,end angle=180,radius=1mm]
			([yshift=-1mm,xshift=1mm]frame.north east)
			arc[start angle=180,end angle=0,radius=1mm];
			\path[left color=tcbcolback!60!black,right color=tcbcolback!60!black,
			middle color=tcbcolback!80!black]
			([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)
			[rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)
			-- (frame.south east) -- (frame.south west)
			-- ([xshift=-1mm,yshift=-1mm]frame.north west)
			[sharp corners]-- cycle;
		},interior engine=empty,
	},
	fonttitle=\bfseries,
	title={#2},#1}{def}
\newtcbtheorem[number within=chapter]{Open}{Open Question}{enhanced,
	before skip=2mm,after skip=2mm, colback=myp!5,colframe=myp!80!black,boxrule=0.5mm,
	attach boxed title to top left={xshift=1cm,yshift*=1mm-\tcboxedtitleheight}, varwidth boxed title*=-3cm,
	boxed title style={frame code={
			\path[fill=tcbcolback]
			([yshift=-1mm,xshift=-1mm]frame.north west)
			arc[start angle=0,end angle=180,radius=1mm]
			([yshift=-1mm,xshift=1mm]frame.north east)
			arc[start angle=180,end angle=0,radius=1mm];
			\path[left color=tcbcolback!60!black,right color=tcbcolback!60!black,
			middle color=tcbcolback!80!black]
			([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)
			[rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)
			-- (frame.south east) -- (frame.south west)
			-- ([xshift=-1mm,yshift=-1mm]frame.north west)
			[sharp corners]-- cycle;
		},interior engine=empty,
	},
	fonttitle=\bfseries,
	title={#2},#1}{def}



%================================
% EXERCISE BOX
%================================

\makeatletter
\newtcbtheorem{question}{Question}{enhanced,
	breakable,
	colback=white,
	colframe=myb!80!black,
	attach boxed title to top left={yshift*=-\tcboxedtitleheight},
	fonttitle=\bfseries,
	title={#2},
	boxed title size=title,
	boxed title style={%
			sharp corners,
			rounded corners=northwest,
			colback=tcbcolframe,
			boxrule=0pt,
		},
	underlay boxed title={%
			\path[fill=tcbcolframe] (title.south west)--(title.south east)
			to[out=0, in=180] ([xshift=5mm]title.east)--
			(title.center-|frame.east)
			[rounded corners=\kvtcb@arc] |-
			(frame.north) -| cycle;
		},
	#1
}{def}
\makeatother

%================================
% SOLUTION BOX
%================================

\makeatletter
\newtcolorbox{solution}{enhanced,
	breakable,
	colback=white,
	colframe=myg!80!black,
	attach boxed title to top left={yshift*=-\tcboxedtitleheight},
	title=Solution,
	boxed title size=title,
	boxed title style={%
			sharp corners,
			rounded corners=northwest,
			colback=tcbcolframe,
			boxrule=0pt,
		},
	underlay boxed title={%
			\path[fill=tcbcolframe] (title.south west)--(title.south east)
			to[out=0, in=180] ([xshift=5mm]title.east)--
			(title.center-|frame.east)
			[rounded corners=\kvtcb@arc] |-
			(frame.north) -| cycle;
		},
}
\makeatother

%================================
% Question BOX
%================================

\makeatletter
\newtcbtheorem{qstion}{Question}{enhanced,
	breakable,
	colback=white,
	colframe=mygr,
	attach boxed title to top left={yshift*=-\tcboxedtitleheight},
	fonttitle=\bfseries,
	title={#2},
	boxed title size=title,
	boxed title style={%
			sharp corners,
			rounded corners=northwest,
			colback=tcbcolframe,
			boxrule=0pt,
		},
	underlay boxed title={%
			\path[fill=tcbcolframe] (title.south west)--(title.south east)
			to[out=0, in=180] ([xshift=5mm]title.east)--
			(title.center-|frame.east)
			[rounded corners=\kvtcb@arc] |-
			(frame.north) -| cycle;
		},
	#1
}{def}
\makeatother

\newtcbtheorem[number within=chapter]{wconc}{Wrong Concept}{
	breakable,
	enhanced,
	colback=white,
	colframe=myr,
	arc=0pt,
	outer arc=0pt,
	fonttitle=\bfseries\sffamily\large,
	colbacktitle=myr,
	attach boxed title to top left={},
	boxed title style={
			enhanced,
			skin=enhancedfirst jigsaw,
			arc=3pt,
			bottom=0pt,
			interior style={fill=myr}
		},
	#1
}{def}



%================================
% NOTE BOX
%================================

\usetikzlibrary{arrows,calc,shadows.blur}
\tcbuselibrary{skins}
\newtcolorbox{note}[1][]{%
	enhanced jigsaw,
	colback=gray!20!white,%
	colframe=gray!80!black,
	size=small,
	boxrule=1pt,
	title=\textbf{Note:-},
	halign title=flush center,
	coltitle=black,
	breakable,
	drop shadow=black!50!white,
	attach boxed title to top left={xshift=1cm,yshift=-\tcboxedtitleheight/2,yshifttext=-\tcboxedtitleheight/2},
	minipage boxed title=1.5cm,
	boxed title style={%
			colback=white,
			size=fbox,
			boxrule=1pt,
			boxsep=2pt,
			underlay={%
					\coordinate (dotA) at ($(interior.west) + (-0.5pt,0)$);
					\coordinate (dotB) at ($(interior.east) + (0.5pt,0)$);
					\begin{scope}
						\clip (interior.north west) rectangle ([xshift=3ex]interior.east);
						\filldraw [white, blur shadow={shadow opacity=60, shadow yshift=-.75ex}, rounded corners=2pt] (interior.north west) rectangle (interior.south east);
					\end{scope}
					\begin{scope}[gray!80!black]
						\fill (dotA) circle (2pt);
						\fill (dotB) circle (2pt);
					\end{scope}
				},
		},
	#1,
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SELF MADE COMMANDS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NewDocumentCommand{\EqM}{ m O{black} m}{%
	\tikz[remember picture, baseline, anchor=base] 
	\node[inner sep=0pt, outer sep=3pt, text=#2] (#1) {%
		\ensuremath{#3}%
	};    
}

% \newcommand{\thm}[3][]{\begin{theorem}{#2}{#1}#3\end{theorem}}
% \newcommand{\thmc}[3][]{\begin{theorem}{#2}{#1}#3\end{theorem}}
% \newcommand{\cor}[3][]{\begin{corollary}{#2}{#1}#3\end{corollary}}
% \newcommand{\corc}[3][]{\begin{corollary}{#2}{#1}#3\end{corollary}}
% \newcommand{\clm}[3][]{\begin{claim}{#2}{#1}#3\end{claim}}
% \newcommand{\prop}[3][]{\begin{proposition}{#2}{#1}#3\end{proposition}}
% \newcommand{\lemm}[3][]{\begin{lemma}{#2}{#1}#3\end{lemma}}
% \newcommand{\wc}[3][]{\begin{wconc}{#2}{#1}\setlength{\parindent}{1cm}#3\end{wconc}}
% \newcommand{\thmcon}[1]{\begin{Theoremcon}{#1}\end{Theoremcon}}
% \newcommand{\ex}[3][]{\begin{example}{#2}{#1}#3\end{example}}
% \newcommand{\exc}[3][]{\begin{example}{#2}{#1}#3\end{example}}
% \newcommand{\dfn}[3][]{\begin{definition}{#2}{#1}#3\end{definition}}
% \newcommand{\dfn}[3][]{\begin{Definition}[colbacktitle=red!75!black]{#2}{#1}#3\end{Definition}}
% \newcommand{\dfnc}[3][]{\begin{definition}[colbacktitle=red!75!black]{#2}{#1}#3\end{definition}}
% \newcommand{\opn}[3][]{\begin{open}[colbacktitle=myp!75!black]{#2}{#1}#3\end{open}}
% \newcommand{\opnc}[3][]{\begin{Open}[colbacktitle=myp!75!black]{#2}{#1}#3\end{Open}}
% \newcommand{\qs}[3][]{\begin{question}{#2}{#1}#3\end{question}}
%\newcommand{\pf}[2]{\begin{myproof}[#1]#2\end{myproof}}
% \newcommand{\pf}[2][Proof]{\begin{prf}[#1]#2\end{prf}}
% \newcommand{\nt}[1]{\begin{note}#1\end{note}}

\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
		\node[shape=circle,draw,inner sep=1pt] (char) {#1};}}
\newcommand\getcurrentref[1]{%
	\ifnumequal{\value{#1}}{0}
	{??}
	{\the\value{#1}}%
}
\newcommand{\getCurrentSectionNumber}{\getcurrentref{section}}
\newenvironment{prf}[1][\proofname]{%
	\proof[#1.]%
}{\endproof}
\newcounter{mylabelcounter}

\makeatletter
\newcommand{\setword}[2]{%
	\phantomsection
	#1\def\@currentlabel{\unexpanded{#1}}\label{#2}%
}
\makeatother

\newenvironment{remark}[1][Remark]{%
    \par\noindent\textit{#1.}\hspace{1ex}%
}{\qed\par}


\tikzset{
	symbol/.style={
			draw=none,
			every to/.append style={
					edge node={node [sloped, allow upside down, auto=false]{$#1$}}}
		}
}


%\usepackage{titletoc}

%\patchcmd{\tableofcontents}{\contentsname}{\sffamily\contentsname}{}{}

%\renewenvironment{leftbar}
%{\def\FrameCommand{\hspace{6em}%
%		{\color{myyellow}\vrule width 2pt depth 6pt}\hspace{1em}}%
%	\MakeFramed{\parshape 1 0cm \dimexpr\textwidth-6em\relax\FrameRestore}\vskip2pt%
%}
%{\endMakeFramed}

%\titlecontents{chapter}
%[0em]{\vspace*{2\baselineskip}}
%{\parbox{4.5em}{%
%		\hfill\Huge\sffamily\bfseries\color{myred}\thecontentspage}%
%	\vspace*{-2.3\baselineskip}\leftbar\textsc{\small\chaptername~\thecontentslabel}\\\sffamily}
%{}{\endleftbar}
%\titlecontents{section}
%[8.4em]
%{\sffamily\contentslabel{3em}}{}{}
%{\hspace{0.5em}\nobreak\itshape\color{myred}\contentspage}
%\titlecontents{subsection}
%[8.4em]
%{\sffamily\contentslabel{3em}}{}{}  
%{\hspace{0.5em}\nobreak\itshape\color{myred}\contentspage}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TABLE OF CONTENTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\usepackage{titletoc}
\usepackage{sectsty} % For customizing section titles if needed

\renewcommand{\contentsname}{\selectfont\Huge\bfseries\sffamily Contents}

% Define custom colors as per tstextbook.cls
\definecolor{tssteelblue}{RGB}{70,130,180}
\definecolor{tsorange}{RGB}{255,138,88}

% Customizing the Table of Contents

\contentsmargin{1cm}

% Chapter titles
\titlecontents{chapter}[0.25cm]
{\addvspace{2ex}\Large\bfseries\sffamily} % Spacing and font adjustments before the entry
{\hypersetup{linkcolor=tssteelblue}\color{tssteelblue}\contentslabel[\Large\thecontentslabel]{1.0cm}} % Label (number) formatting
{\hypersetup{linkcolor=tssteelblue}} % For unnumbered chapters
{\color{tssteelblue}\titlerule*[1pc]{.}\contentspage} % Dot leader and page number

% Section titles
\titlecontents{section}[1.5cm] % Indentation
{\addvspace{0.7ex}\large\bfseries\sffamily} % Spacing and font adjustments before the entry
{\hypersetup{linkcolor=black}\contentslabel[\thecontentslabel]{1.25cm}} % Label (number) formatting
{}
{\sffamily\hfill\color{black}\contentspage}[]

\titlecontents{subsection}[2.65cm] % Adjust the left margin to align with subsection indent
{\addvspace{0.25em}\sffamily}
{\hypersetup{linkcolor=black!85}\contentslabel[\thecontentslabel]{3.2em}} % Subsection label formatting
{} % Unnumbered format
{\hfill\color{black}\contentspage} % Page number

