\chapter{Commutative Ring}
\section{Basic Concepts}
A commutative ring $R$ is a commutative $R$-algebra and accordingly a commutative $\mathbb{Z}$-algebra. Furthermore we have a categorical isomorphism 
\[
    \mathsf{CRing}\cong \mathbb{Z}\text{-}\mathsf{CAlg}.
\]



\begin{definition}{Noetherian Commutative Ring}{Noetherian_commutative_ring}
    Let $R$ be a commutative ring. We say $R$ is \textbf{Noetherian} if one of following conditions holds:
    \begin{enumerate}[(i)]
        \item $R$ as an $R$-module is Noetherian.
        \item Every ideal of $R$ is finitely generated.
        \item Every prime ideal of $R$ is finitely generated.
        \item Every ascending chain of ideals of $R$ is eventually constant. That is, if $I_1\subseteq I_2\subseteq I_3\subseteq\cdots$ is a chain of ideals of $R$, then there exists $n\in\mathbb{N}$ such that $I_n=I_{n+1}=\cdots$.
    \end{enumerate}
\end{definition}

\begin{proposition}{Properties of Noetherian rings}{}
    \begin{enumerate}[(i)]
        \item If $R$ is a Noetherian ring, then the polynomial ring $R[X_1,X_2,\cdots,X_n]$ is also Noetherian.
        \item If $R$ is a Noetherian ring, then the  formal power series ring $R[[X_1,X_2,\cdots,X_n]]$ is also Noetherian.
    \end{enumerate}
\end{proposition}

\begin{definition}{Frobenius Endomorphism of a Commutative Ring}{frobenius_endomorphism_of_a_commutative_ring}
    Let $R$ be a commutative ring with prime \hyperref[th:characteristic_of_a_ring]{characteristic} $p$. The \textbf{Frobenius endomorphism} of $R$ is the ring homomorphism defined by
    \begin{align*}
        \varphi: R & \longrightarrow  R \\
        r & \longmapsto  r^p.
    \end{align*}
\end{definition}
\begin{remark}
    The Frobenius endomorphism is a ring homomorphism since
    \begin{align*}
        \varphi(r+s)&=(r+s)^p=\sum_{k=0}^p\binom{p}{k}r^ks^{p-k}=r^p+s^p=\varphi(r)+\varphi(s),\\
        \varphi(rs)&=(rs)^p=r^ps^p=\varphi(r)\varphi(s).
    \end{align*}
\end{remark}

\subsection{Ideals}
\begin{definition}{Ideal}{}
    Let $R$ be a ring. A subset $I\subseteq R$ is called an \textbf{ideal} if
    \begin{enumerate}[(i)]
        \item $I$ is a subgroup of $(R,+)$.
        \item $I$ is closed under multiplication, i.e. $a\in I$ and $b\in R$ implies $ab\in I$.
    \end{enumerate}
\end{definition}


\begin{proposition}{Ideal as Submodule}{}
    Let $R$ be a ring and $I\subseteq R$ be a subset of $R$. Then $I$ is an ideal of $R$ if and only if $I$ is a submodule of $R$ as an $R$-module.
\end{proposition}


\begin{definition}{Prime Ideal}{}
    Let $R$ be a commutative ring. An ideal $I\subseteq R$ is called \textbf{prime} if 
    \begin{enumerate}[(i)]
        \item $I\neq R$, i.e. $I$ is a proper ideal.
        \item $ab\in I\implies a\in I\text{ or }b\in I$, i.e. there exist no two elements in $R$ whose product is in $I$ but neither of them is in $I$.
    \end{enumerate}    
\end{definition}

\begin{proposition}{}{}
    Let $R$ be a commutative ring and $\mathfrak{p}$ be a prime ideal of $R$. If $x_1\cdots x_n\in \mathfrak{p}$, then there exists some $i\in\{1,2\cdots,n\}$ such that $x_i\in \mathfrak{p}$.
\end{proposition}
\begin{prf}
    We prove this by induction on $n$. The case $n=1$ is trivial. Suppose the statement holds for $n=k$. If $x_1\cdots x_{k+1}\in \mathfrak{p}$, then $x_1\cdots x_k\in \mathfrak{p}$ or $x_{k+1}\in \mathfrak{p}$. If $x_1\cdots x_k\in \mathfrak{p}$, then there exists some $i\in\{1,2,\cdots,k\}$ such that $x_i\in \mathfrak{p}$. If $x_{k+1}\in \mathfrak{p}$, then we are done. Hence the statement holds for $n=k+1$.
\end{prf}

\begin{proposition}{Preimage of a Prime Ideal is a Prime Ideal}{}
    Let $f:R\to S$ be a commutative ring homomorphism and $\mathfrak{p}\subseteq S$ be a prime ideal. Then $f^{-1}(\mathfrak{p})$ is a prime ideal of $R$.
\end{proposition}
\begin{corollary}{Contraction of a Prime Ideal is Prime}{contraction_of_prime_ideal_is_prime}
    Let $R$ be a commutative ring and $S\subseteq R$ be a subring. If $\mathfrak{p}\subseteq R$ is a prime ideal, then $\mathfrak{p}\cap S$ is a prime ideal of $S$.
\end{corollary}
\begin{proof}
    Let $\iota:S\hookrightarrow R$ be the inclusion map. Then $\iota^{-1}(\mathfrak{p})=\mathfrak{p}\cap S$ is a prime ideal of $S$.
\end{proof}

\begin{proposition}{Prime Ideal Equivalent Definition}{}
    Let $R$ be a commutative ring and $I\subseteq R$ be an ideal. Then $I$ is prime if and only if $R/I$ is an integral domain.
\end{proposition}

\begin{definition}{Maximal Ideal}{}
    Let $R$ be a commutative ring. An ideal $I\subseteq R$ is called \textbf{maximal} if
    \begin{enumerate}[(i)]
        \item $I\ne R$, i.e. $I$ is a proper ideal.
        \item There exists no ideal $J\subseteq R$ such that $I\subsetneq J\subsetneq R$.
    \end{enumerate}
\end{definition}

\begin{proposition}{Maximal Ideal Equivalent Definition}{}
    Let $R$ be a commutative ring and $I\subseteq R$ be an ideal. Then $I$ is maximal if and only if $R/I$ is a field.  
\end{proposition}

\begin{proposition}{}{}
    If $R$ is a ring and $I$ an ideal of $R$ such that $I \neq R$, then $R$ contains a maximal ideal $\mathfrak{m}$ such that $I \subseteq \mathfrak{m}$.
\end{proposition}

\begin{prf}
    Let $\mathcal{A}$ be the set of ideals of $R$ not equal to $R$, ordered by inclusion. We must show that whenever $\mathcal{C}$ is a chain in $\mathcal{A}$ it has an upper bound in $\mathcal{A}$, since then the result follows immediately from Zorn's lemma. So let's take such a chain $\mathcal{C}$.

Let $I=\bigcup_{J \in \mathcal{C}} J$. Now suppose $x_1, x_2$ are in $I$. Then there are $J_1, J_2$ in $\mathcal{C}$ such that $x_i \in J_i$. Either $J_1 \subseteq J_2$ or $J_2 \subseteq J_1$. Without loss of generality, we assume the former follows. Then $x_1 \in J_2$, so $x_1+x_2 \in J_2 \subset I$. Also if $a \in R$ then $a x_i \in J_2 \subseteq I$ for each $i$. It follows that $I$ is an ideal.

It now just remains to check that $I \neq A$. But $1 \notin J$ for each $J \in \mathcal{C}$, so $1 \notin I$ and $I \neq R$ as required.
\end{prf}

\begin{proposition}{Non-Unit Elements Lies in Maximal Ideals}{non_unit_elements_lies_in_maximal_ideals}
    Let $R$ be a commutative ring. Then the following are equivalent:
    \begin{enumerate}[(i)]
        \item $x\notin R^\times$.
        \item $(x)\ne R$.
        \item $x$ lies in a maximal ideal of $R$.
    \end{enumerate}
\end{proposition}

\begin{prf}
    (i)$\implies$(ii). If $(x)\ne R$, then there exists $r\in R$ such that $rx=1$. Hence $x\in R^\times$.
    
    (ii)$\implies$(iii). If $(x)\ne R$, by the proposition above, there exists a maximal ideal $\mathfrak{m}$ such that $(x)\subseteq \mathfrak{m}$.

    (iii)$\implies$(i). If $x\in R^{\times}$, then $(x)=R$ and there exists no maximal ideal containing $(x)$.
\end{prf}

\begin{corollary}{}{}
    Let $R$ be a commutative ring. Then 
    \[
    R-R^\times=\bigcup_{\substack{\mathfrak{m}\in \mathrm{MaxSpec} R}}\mathfrak{m}.
    \]
\end{corollary}
\begin{prf}
    This is a direct consequence of \Cref{th:non_unit_elements_lies_in_maximal_ideals}.
\end{prf}

\begin{definition}{Ideal generated from subset}{}
    Let $R$ be a commutative ring and $\mathcal I(R)$ be the set of all ideals of $R$. Suppose $S\subseteq R$ be a subset. The \textbf{ideal generated by $S$}, denoted by $(S)$, is the smallest ideal of $R$ containing $S$, i.e. 
    \[
        (S)=\bigcap_{\substack{ I\in \mathcal I(R)\\S\subseteq I}}I=\left\{\sum_{i=1}^n r_is_i\mid n\in\mathbb{Z}_{+},r_i\in R,s_i\in S\right\}.
    \]
    If $S=\{a_1,\dots,a_n\}$, we write 
    \[
        (S)=(a_1,\dots,a_n)=\left\{\sum_{i=1}^n r_ia_i\midv  r_i\in R\right\}.
    \]
    If $S=\mathfrak{p}$ is a prime ideal, we write 
    \[
    (\mathfrak{p})=\mathfrak{p}R = \left\{ \sum_{i=1}^n r_i p \;\middle|\; r_i \in R, p \in \mathfrak{p}, n \in \mathbb{Z}_{+} \right\}.
    \]
\end{definition}

\begin{definition}{Ideal Operations}{}
    \begin{enumerate}[(i)]
        \item Sum: $$I+J=\left\{a+b\mid a\in I,b\in J\right\}=\left(I\cup J\right),$$
        $$
        \sum_{t \in T} I_t=\left\{a_{t_1}+ \cdots +a_{t_n}\mid n\in\mathbb{Z}_{+},t_i\in T,a_{t_i}\in I_{t_i}\right\}.
        $$
        \item Product: $$IJ=\left\{\sum_{i=1}^n a_ib_i\midv n\in\mathbb{Z}_{+},a_i\in I,b_i\in J\right\}=\left(\{ab\mid a\in I,b\in J\}\right).$$
        \item Power: $I^0=R$,
        \[
            I^n=\underbrace{I\cdots I}_{n\text{ times}}=\left(\{a^n\midv a\in I\}\right), 
            \]
        \item Radical: \[
            \sqrt{I} = \left\{ r \in R \mid r^n \in I \text{ for some } n \in \mathbb{Z}_{+} \right\} = \bigcap_{\substack{\mathfrak{p} \in \mathrm{Spec} R \\ I \subseteq \mathfrak{p}}} \mathfrak{p}
            \].
    \end{enumerate}
\end{definition}

\begin{proposition}{Sum of Generated Ideals}{}
    Let $R$ be a commutative ring and $S$ be a subset of $R$. Then 
    $$(S)=\sum_{s\in S}(s).$$ As a result,
    \[
    (a_1,\dots,a_n)+(b_1,\dots,b_m)=(a_1,\dots,a_n,b_1,\dots,b_m).
    \]
\end{proposition}

\begin{prf}
    \begin{align*}
        \sum_{s \in S} (s)&=\left\{a_{s_1}+ \cdots +a_{s_n}\mid n\in\mathbb{Z}_{+},s_i\in S,a_{s_i}\in (s_i)\right\}\\
        &=\left\{r_1s_{1}+ \cdots +r_ns_{n}\mid n\in\mathbb{Z}_{+},s_i\in S,r_i\in R\right\}\\
        &=(S).
    \end{align*}
\end{prf}

\begin{proposition}{Product of Generated Ideals}{}
    Let $R$ be a commutative ring and $S,T$ be subsets of $R$. Then 
    \[
        (S)(T)=(ST).
    \]
    As  a result,
    \[
        (a_1,\dots,a_n)(b_1,\dots,b_m)=(a_1b_1,\dots,a_1b_m,\dots,a_nb_1,\dots,a_nb_m).
    \]
\end{proposition}


\begin{proposition}{Properties of Ideal Operations}{}
    \begin{enumerate}[(i)]
        \item $(I\cap J)^2 \subseteq I J \subseteq I \cap J \subseteq I+J$
        \item ${I} \cap({J}+{K}) \supseteq {I} \cap {J}+{I} \cap {K}$
        \item ${I} ({J}+{K}) = {I}  {J}+{I}  {K}$
        \item $$
        \begin{gathered}
        J\sum_{t \in T} I_t=\sum_{t \in T} J I_t.
        \end{gathered}
        $$
        \item $I(J K)=(I J) K$
        \item $(a)^n=(a^n)$
        \item $I^0 \supseteq \sqrt{I} \supseteq I \supseteq I^2 \supseteq I^3 \supseteq \cdots$
        \item $\sqrt{\sqrt{I}} = \sqrt{I}$,
        \item $\sqrt{I^n}=\sqrt{I}$, $\sqrt{I J}=\sqrt{I \cap J}=\sqrt{I} \cap \sqrt{J}$
    \end{enumerate}
\end{proposition}

\begin{prf}
    \begin{enumerate}[(i)]
        \item Since $\{ab\mid a\in I,b\in J\}\subseteq I\cap J$, we see $IJ=\left(\{ab\mid a\in I,b\in J\}\right)\subseteq I\cap J$. Also we can check $I \cap J \subseteq I \cup J\subseteq (I \cup J)=I+J$.
        \item[(vi)] If $x\in(a)^n$, then $x=r_1(r_2a)^n=r_1r_2^na^n\in(a^n)$. If $y\in(a^n)$, then $y=ra^n\in(a)^n$.
    \end{enumerate}
\end{prf}

\begin{definition}{Semiring of Ideals of a Commutative Ring}{}
    Let $R$ be a commutative ring. Then the set of all ideals of $R$ forms a semiring under the operations of addition and multiplication. The zero ideal $(0)$ is the additive identity and the unit ideal $R$ is the multiplicative identity. 
\end{definition}

\begin{proposition}{Surjective Ring Homomorphism Induces Semiring Homomorphism of Ideals}{surjective_ring_homomorphism_induces_semiring_homomorphism_of_ideals}
    If $\varphi:R\to S$ is a surjective ring homomorphism, then $\varphi$ induces a semiring homomorphism from the semiring of ideals of $R$ to the semiring of ideals of $S$.
\end{proposition}
\begin{prf}
    First, we show $\varphi$ preserves addition of ideals. Let $I,J$ be ideals of $R$. Then
    \begin{align*}
        \varphi(I+J)&=\varphi\left(\left\{a+b\midv a\in I,b\in J\right\}\right)\\
        &=\left\{\varphi(a+b)\midv a\in I,b\in J\right\}\\
        &=\left\{\varphi(a)+\varphi(b)\midv a\in I,b\in J\right\}\\
        &=\left\{x+y\midv x\in \varphi(I),y\in \varphi(J)\right\}\\
        &=\varphi(I)+\varphi(J).
    \end{align*}
    Then we show $\varphi$ preserves multiplication of ideals. Let $I,J$ be ideals of $R$. We have
    \begin{align*}
        \varphi(IJ)&=\varphi\left(\left\{\sum_{i=1}^n a_ib_i\midv n\in\mathbb{Z}_{+},a_i\in I,b_i\in J\right\}\right)\\
        &=\left\{\varphi\left(\sum_{i=1}^n a_ib_i\right)\midv n\in\mathbb{Z}_{+},a_i\in I,b_i\in J\right\}\\
        &=\left\{\sum_{i=1}^n \varphi(a_i)\varphi(b_i)\midv n\in\mathbb{Z}_{+},a_i\in I,b_i\in J\right\}\\
        &=\left\{\sum_{i=1}^n x_iy_i\midv n\in\mathbb{Z}_{+}, x_i\in \varphi(I),y_i\in \varphi(J)\right\}\\
        &=\varphi(I)\varphi(J).
    \end{align*}
    Finally, we show $\varphi$ preserves the multiplicative identity. This follows immediately from the fact that $\varphi$ is surjective.
\end{prf}

\begin{proposition}{}{prime_ideal_contains_product_iff_contains_at_least_one_factor}
    Let $I$ and $J$ be ideals of a commutative ring $R$ and $\mathfrak{p}$ be a prime ideal of $R$. Then 
    \[
        I\cap J\subseteq \mathfrak{p}\iff IJ\subseteq \mathfrak{p}\iff I\subseteq \mathfrak{p}\text{ or }J\subseteq \mathfrak{p}.
    \]
\end{proposition}

\begin{prf}
    We have the following chain of implications:
    \begin{itemize}
        \item $I\cap J\subseteq \mathfrak{p}\implies IJ\subseteq \mathfrak{p}$. Note that $IJ\subseteq I\cap J$. The result follows immediately.
        \item $IJ\subseteq \mathfrak{p}\implies I\subseteq \mathfrak{p}\text{ or }J\subseteq \mathfrak{p}$. Assume $IJ\subseteq \mathfrak{p}$. Suppose $I\subsetneq \mathfrak{p}$ and $J\subsetneq \mathfrak{p}$. Then there exist $a\in I-\mathfrak{p}$ and $b\in J-\mathfrak{p}$. Since $\mathfrak{p}$ is prime, $ab\in IJ\subseteq \mathfrak{p}$ implies $a\in \mathfrak{p}$ or $b\in \mathfrak{p}$, which is a contradiction. Hence $I\subseteq \mathfrak{p}$ or $J\subseteq \mathfrak{p}$.
        \item $I\subseteq \mathfrak{p}\text{ or }J\subseteq \mathfrak{p}\implies I\cap J\subseteq \mathfrak{p}$. Note that $I\cap J\subseteq I$. The result follows immediately.
    \end{itemize}
\end{prf}


\begin{definition}{Radical Ideal}{}
    An ideal $I$ is called a \textbf{radical ideal} if $I=\sqrt{I}$.
\end{definition}

\begin{proposition}{Radical Ideal Equivalent Definition}{}
    Let $R$ be a commutative ring and $I\subseteq R$ be an ideal. Then $I$ is radical if and only if $R/I$ is reduced.
\end{proposition}

\begin{definition}{Nilradical}{}
    The \textbf{nilradical} of $R$, denoted by $\mathfrak{N}_R$, is the radical ideal $\sqrt{0}$ consisting of all the nilpotent elements of $R$. We have
    \[
        \mathfrak{N}_R=\sqrt{0}=\left\{ r \in R \mid r^n=0 \text{ for some } n \in \mathbb{Z}_{+} \right\} = \bigcap_{\substack{\mathfrak{p} \in \mathrm{Spec} R }} \mathfrak{p}
            \]
\end{definition}



\begin{proposition}{Properties of Radical Ideal}{}
    \begin{enumerate}[(i)]
        \item For any ideal $I$, $\sqrt{0}\subseteq \sqrt{I}$.
        \item $\sqrt{I}$ is the smallest radical ideal containing $I$.
        \item $\sqrt{\mathfrak{p}^n}=\sqrt{\mathfrak{p}}=\mathfrak{p}$ for any prime ideal $\mathfrak{p}$, which means prime ideals are radical.
        \item Suppose the natural projection $\pi: R\to R/I$ induces a bijection between the set of ideals of $R$ containing $I$ and the set of ideals of $R/I$, denoted by $\tilde{\pi}:\mathcal{I}(R)\to\mathcal{I}(R/I)$. Then $\tilde{\pi}$ maps $\sqrt{I}$ to $\mathfrak{N}_{R/I}$.
        \item A commutative ring $R$ is reduced if and only if $\mathfrak{N}_R=(0)$. 
    \end{enumerate}
\end{proposition}

In summary, we have the following chain of inclusions:
\[
\left\{\text{maximal ideals of }R\right\} \subseteq \left\{\text{prime ideals of }R\right\} \subseteq \left\{\text{radical ideals of }R\right\} \subseteq \left\{\text{ideals of }R\right\}.
\]
\begin{proposition}{Quotient Preserves Radical, Prime, Maximal Ideals}{}
    Let $R$ be a commutative ring and $I\subseteq R$ be a proper ideal. Then we have bijections between the following sets:
    \begin{align*}
        \left\{\text{ideals of }R\text{ containing }I\right\}&\longleftrightarrow\left\{\text{ideals of }R/I\right\}\\
        J&\longmapsto J/I
    \end{align*}
    The ideal $J\supseteq I$ is radical, prime, or maximal if and only if $J/I$ is radical, prime, or maximal respectively.
\end{proposition}

\begin{definition}{Jacobson Radical}{}
    Let $R$ be a commutative ring and $\mathfrak{m}$ be a maximal ideal of $\mathfrak{m}$. The \textbf{Jacobson radical} of $R$, denoted by $\mathfrak{J}_R$, is the intersection of all maximal ideals of $R$, denoted by
    \[
        \mathfrak{J}_R=\bigcap_{\substack{\mathfrak{m} \in \mathrm{MaxSpec} R }} \mathfrak{m}.
            \]
    
\end{definition}


\subsection{Prime Elements}
\begin{definition}{Divisibility}{}
    Let $R$ be a commutative ring and $a,b\in R$. We say $a$ \textbf{divides} $b$ if there exists $c\in R$ such that $b=ac$, denoted by $a\mid b$. If $a\mid b$. $a$ is called a \textbf{divisor} of $b$, and $b$ is called a \textbf{multiple} of $a$.
\end{definition}


\begin{proposition}{}{divisibility_ideal_characterization}
    Let $R$ be a commutative ring.
    \begin{enumerate}[(i)]
        \item $a \divides b\iff(b) \subseteq (a)$.
        \item $u\in R^\times \iff (u) = R  \iff \forall r\in R,\,u\mid r$.
    \end{enumerate}
\end{proposition}

\begin{definition}{Prime Element}{}
    Let $R$ be a commutative ring. An element $a\in R$ is called \textbf{prime} if
    \begin{enumerate}[(i)]
        \item $a\ne 0$.
        \item $a\notin R^\times$, i.e. $a$ is not a unit.
        \item $a\mid bc\implies a\mid b\text{ or }a\mid c$.
    \end{enumerate}
\end{definition}



\begin{proposition}{Prime Element and Nonzero Prime Ideal}{equivalent_characterization_of_prime_element}
    Suppose $R$ is a commutative ring and $a\in R$. Then
    \[
        a\text{ is prime }\iff (a)\text{ is a nonzero prime ideal}.
    \]
\end{proposition}

\begin{prf}
    \begin{align*}
        a\text{ is prime }\iff &a\ne 0\text{ and }a\notin R^\times\text{ and }a\mid bc\implies a\mid b\text{ or }a\mid c\\
        \iff &(a)\ne 0\text{ and }(a)\ne R\text{ and }bc\in (a)\implies b\in (a)\text{ or }c\in (a)\\
        \iff &(a)\text{ is a nonzero prime ideal}.
    \end{align*}
\end{prf}

\subsection{Local Commutative Ring}

\begin{definition}{Local Commutative Ring}{local_commutative_ring}
    Let $R$ be a commutative ring. Then the following are equivalent:
    \begin{enumerate}[(i)]
        \item $R$ is a local ring.
        \item $R$ has a unique maximal ideal.
        \item $R$ has a maximal ideal $\mathfrak{m}$ and $R - \mathfrak{m}= R^{\times}$.
        \item $R$ is not the zero ring and for every $x \in R$, $x\in R^{\times}$ or $1-x\in R^{\times}$.
        \item $R$ is not the zero ring and if $\sum_{i=1}^n r_i\in R^{\times}$, then there exist some $i$ such that $r_i\in R^{\times}$. 
        \item $R$ is not the zero ring and the sum of any two non-units in $R$ is a non-unit.
    \end{enumerate}
\end{definition}

\begin{lemma}{Nakayama's Lemma}{Nakayama_lemma}
    Let $R$ be a commutative ring and $M$ be a finitely generated $R$-module. If the image of $m_1,\cdots,m_n$ in $M/\mathfrak{J}_R M$ generates $M/\mathfrak{J}_R M$ as an $R/\mathfrak{J}_R$-module, then $m_1,\cdots,m_n$ generates $M$ as an $R$-module.
    
\end{lemma}

\begin{proposition}{}{}
    Let $(R, \mathfrak{m})$ be a local commutative ring and $M$ be a finitely generated $R$-module. Let
    \[
\mathfrak{m}M = \left\{ \sum_{i=1}^n r_i m_i \;\middle|\; r_i \in \mathfrak{m}, m_i \in M, n \in \mathbb{N} \right\}
\]
denote the submodule of $M$ generated by $\mathfrak{m}$-action and $\pi: M \to M/\mathfrak{m}M$ be the natural projection. Then we have
\begin{itemize}
    \item $M/\mathfrak{m}M$ is an $R/\mathfrak{m}$-vector space. 
    \item If $(v_1, \ldots, v_n)$ is a $R/\mathfrak{m}$-basis for $M/\mathfrak{m}M$, then $(\pi^{-1}(v_1), \ldots, \pi^{-1}(v_n))$ is a minimal generating set for $M$.
    \item If $(m_1, \ldots, m_k)$ is a minimal generating set for $M$, then $(\pi(m_1), \ldots, \pi(m_k))$ is a $R/\mathfrak{m}$-basis for $M/\mathfrak{m}M$.
\end{itemize}
As a result, the minimal number of generators of $M$ is equal to $\dim_{R/\mathfrak{m}}(M/\mathfrak{m}M)$.
\end{proposition}
\begin{prf}
   The action of $R/\mathfrak{m}$ on $M/\mathfrak{m}M$ is defined by
    \[
        \overline{r}\cdot\pi(m)=\pi(rm).
    \]
   This is well-defined since if $\overline{r_1}=\overline{r_2}$, then $r_1-r_2=s \in \mathfrak{m}$. For any $m\in M$, we have
    \[
         r_1m-r_2m=sm\in \mathfrak{m}M \implies \pi(r_1m)=\pi(r_2m).
    \]
    Suppose $(v_1, \ldots, v_n)$ is a $R/\mathfrak{m}$-basis for $M/\mathfrak{m}M$. The rest of the proof is a direct application of \hyperlink{th:Nakayama_lemma}{Nakayama's lemma}.
\end{prf}


\section{Integral Domain}

\begin{definition}{Integral Domain}{}
    A commutative ring $R$ is called an \textbf{integral domain} if
    \begin{enumerate}[(i)]
        \item the only zero divisor of $R$ is 0,
        \item $R$ is not the zero ring.
    \end{enumerate}
\end{definition}
\begin{remark}
    Or equivalently, we can define an integral domain as a commutative \hyperref[th:domain]{domain}.
\end{remark}

\begin{proposition}{Cancellation Laws in Integral Domain}{}
    Let $R$ be an integral domain. Then the following cancellation laws hold: given any $a,b,c\in R$, if $a \ne 0$, then $ab = ac$ implies $b = c$.
\end{proposition}

\begin{proposition}{Nonzero Subring of Integral Domain is Integral Domain}{}
    Let $R$ be an integral domain and $S\subseteq R$ be a nonzero subring. Then $S$ is an integral domain.
\end{proposition}
\begin{prf}
    Let $a,b\in S$ be nonzero elements. Since $a,b\in R$, we have $ab=0\implies a=0\text{ or }b=0$. Hence $S$ is an integral domain.
\end{prf}

\begin{definition}{Associate}{}
    Let $R$ be an integral domain. Two elements $a,b\in R$ are called \textbf{associates} if one of the following equivalent conditions holds:
    \begin{enumerate}[(i)]
        \item $a=ub$ for some $u\in R^\times$.
        \item $a\mid b$ and $b\mid a$, i.e. $(a)=(b)$.
    \end{enumerate}
\end{definition}

If $R$ is a general commutative ring, then we only have the implication $(\mathrm i)\implies (\mathrm{ii})$. The converse is not true in general. For example, in $\mathbb{C}[x,y,z]/(x-xyz)$, $\overline{x}\mid \overline{xy}$ and $\overline{xy}\mid \overline{x}$, but there exists no unit $u$ such that $\overline{x}=u\overline{xy}$.

Associatedness can also be described in terms of the action of $R^\times$ on $R$ via multiplication: two elements of $R$ are associates if they are in the same $R^\times$-orbit.
\begin{definition}{Irreducible Element}{}
    Let $R$ be an integral domain. An non-zero element $a\in R$ is called \textbf{irreducible} if
    \begin{enumerate}[(i)]
        \item $a\notin R^\times$, i.e. $a$ is not a unit.
        \item $a=bc\implies b\in R^\times\text{ or }c\in R^\times$.
    \end{enumerate}    
\end{definition}

0 is never an irreducible element.

\begin{proposition}{Dividing Irreducible Element in PID Implies Associate or Unit}{dividing_irreducible_element_in_PID_implies_associate_or_unit}
    Let $R$ be an integral domain and $f,g\in R$. If $f$ is irreducible and $f \in (g)$, then one of the following holds:
    \begin{enumerate}[(i)]
        \item $g \in R^\times$, i.e. $(g) = R$.
        \item $g$ is an associate of $f$, i.e. $(g) = (f)$.
    \end{enumerate}
\end{proposition}
\begin{prf}
    Since $f \in (g)$, there exists $h \in R$ such that $f = gh$. Since $f$ is irreducible, we have $g \in R^\times$ or $h \in R^\times$. If $g \in R^\times$, then $(g) = R$. If $h \in R^\times$, then $g$ is an associate of $f$ and $(g) = (f)$.
\end{prf}



\begin{proposition}{Prime Element $\implies$ Irreducible Element in Integral Domain}{prime_element_implies_irreducible_element_in_integral_domain}
    Let $R$ be an integral domain. Then every prime element in $R$ is irreducible.
\end{proposition}

\begin{prf}
    Let $a\in R$ be a prime element. Suppose $a=bc$ for some $b,c\in R$. Then $a\mid bc$. Since $a$ is prime, there must be $a\mid b$ or $a\mid c$. Without loss of generality, we can assume $a\mid b$. Then $b=ad$ for some $d\in R$. Thus we have $$a=bc=adc\implies a(1-dc)=0\implies dc=1\implies c\in R^\times.$$ That implies $a$ is irreducible.
\end{prf}

\begin{proposition}{Prime Ideal Equivalent Definition}{}
    Let $R$ be a commutative ring. An ideal $I\subseteq R$ is prime if and only if $R/I$ is an integral domain.
\end{proposition}


\section{Unique Factorization Domain}
\begin{definition}{Unique Factorization Domain}{}
    An integral domain $R$ is called a \textbf{unique factorization domain} (UFD) if
    \begin{enumerate}[(i)]
        \item every nonzero nonunit element of $R$ can be written as a product of irreducible elements of $R$.
        \item if $p_1\cdots p_n=q_1\cdots q_m$ for some irreducible elements $p_1,\cdots,p_n,q_1,\cdots,q_m\in R$, then $n=m$ and there exists a permutation $\sigma\in S_n$ such that $p_i$ is an associate of $q_{\sigma(i)}$ for all $i=1,\cdots,n$.
    \end{enumerate}
\end{definition}

\begin{proposition}{Irreducible Element $\iff$ Prime Element in UFD}{irreducible_element_iff_prime_element_in_UFD}
    Let $R$ be a UFD and $a\in R$. Then
    \[
        a \text{ is an irreducible element}\iff a\text{ is a prime element}.
    \]
\end{proposition}

\begin{prf}
    Let $a\in R$ be an irreducible element. Suppose $a\mid bc$ for some $b,c\in R$. Then $bc=ad$ for some $d\in R$. Since $R$ is a UFD, we can write $b=p_1\cdots p_n$ and $c=q_1\cdots q_m$ for some irreducible elements $p_1,\cdots,p_n,q_1,\cdots,q_m\in R$. Then we have $$ad=bc=p_1\cdots p_nq_1\cdots q_m.$$ Since $a$ is irreducible, $a$ must be an associate of one of the $p_i$'s or $q_j$'s. Without loss of generality, we can assume $a\sim p_1$. Then $a\mid b$. That implies $a$ is prime.

    \Cref{th:prime_element_implies_irreducible_element_in_integral_domain} shows the converse.
\end{prf}

\begin{proposition}{UFD $\implies$ Normal Domain}{}
    Every UFD is a \hyperref[th:normal_domain]{normal domain}.
\end{proposition}
\begin{prf}
    Let $R$ be a UFD and $K=\mathrm{Frac}(R)$ be the field of fractions of $R$. Suppose $a/b\in K$ is integral over $R$ and $\gcd\left(a,b\right)=1$. Then $a/b$ satisfies a monic polynomial $f(x)=x^n+r_{n-1}x^{n-1}+\cdots+r_0$ with $r_i\in R$. Multiplying by $b^n$, we have 
    \[
        a^n+r_{n-1}a^{n-1}b+\cdots+r_0b^n=0\implies b \mid a^n.
    \]
    Since $R$ is a UFD, both $a$ and $b$ can be uniquely written as a product of irreducible elements. Either $b$ is a unit or $b$ has an irreducible factor in common with $a$. Since $\gcd\left(a,b\right)=1$, the latter is impossible. Hence $b\in R^\times$ and $a/b\in R$.
\end{prf}

\section{Principal Ideal Domain}
\begin{definition}{Principal Ideal Domain}{}
    An integral domain $R$ is called a \textbf{principal ideal domain} (PID) if every ideal of $R$ is principal.
\end{definition}

\begin{proposition}{}{}
    Let $R$ be a commutative ring. Then the following are equivalent:
    \begin{enumerate}[(i)]
        \item $R$ is a PID.
        \item $R$ is a UFD with Krull dimension $\dim R \le 1$.
    \end{enumerate}
\end{proposition}
\begin{corollary}{PID $\implies$ UFD}{}
    Every PID is a UFD.
\end{corollary}


\begin{proposition}{Nonzero Prime Ideal $\iff$ Maximal Ideal in PID}{nonzero_prime_ideal_iff_maximal_ideal_in_PID}
    Let $R$ be a PID and $p\in R$. Then the following are equivalent:
    \begin{enumerate}[(i)]
        \item $p$ is a prime element.
        \item $p$ is an irreducible element.
        \item $(p)$ is a nonzero prime ideal.
        \item $(p)$ is a maximal ideal.
    \end{enumerate}
\end{proposition}

\begin{prf}
    By \Cref{th:equivalent_characterization_of_prime_element}, (i)$\iff$(iii). Since \hyperref[th:irreducible_element_iff_prime_element_in_UFD]{ in UFD, prime elements are irreducible elements}, (i)$\iff$(ii). Since maximal ideals are prime, (iv)$\implies$(iii).


    To show (ii)$\implies$(iv), suppose $p$ is irreducible. Let $I$ be an ideal of $R$ such that 
    \[
    (p)\subseteq I \subseteq R.
    \]
    Since $R$ is a PID, there exists some $a\in R$ such that $I=(a)$. Then we have $(p)\subseteq (a)$, which implies there exists $r\in R$ such that $p=ra$ by \Cref{th:divisibility_ideal_characterization}. Because $p$ is irreducible, by definition we have $a\in R^\times$ or $r\in R^\times$. 
    \begin{itemize}
        \item If $a\in R^\times$, then $I=(a)=R$.
        \item If $r\in R^\times$, then $a=r^{-1}p$, which implies $(a)\subseteq (p)$ and thus $I=(a)=(p)$.
    \end{itemize}
    This shows that there are no ideals strictly between $(p)$ and $R$. Hence $(p)$ is maximal.
\end{prf}


\section{Construction}

\subsection{Product}
\begin{definition}{Product of Commutative Rings}{}
    Let $(R_i)_{i\in I}$ be a family of commutative rings. The \textbf{product} of the family $(R_i)_{i\in I}$ is the set of all families $(r_i)_{i\in I}$ where $r_i\in R_i$ for all $i\in I$. The addition and multiplication are defined componentwise:
    \begin{align*}
        (r_i)_{i\in I}+(s_i)_{i\in I}&=(r_i+s_i)_{i\in I},\\
        (r_i)_{i\in I}\cdot(s_i)_{i\in I}&=(r_i\cdot s_i)_{i\in I}.
    \end{align*}
\end{definition}



\begin{proposition}{Ideals of Finite Product of Commutative Rings}{}
    Let $R_1, R_2, \cdots, R_n$ be commutative rings. Then $I$ is an ideal of the product $R_1\times R_2\times \cdots \times R_n$ if and only if $I=I_1\times I_2\times \cdots \times I_n$ where $I_i$ is an ideal of $R_i$ for all $i=1,2,\cdots,n$.
\end{proposition}
\begin{prf}
    It is sufficient to show this for $n=2$. Let $I$ be an ideal of $R_1\times R_2$. Let $\mathrm{pr}_1:R_1\times R_2\to R_1$ and $\mathrm{pr}_2:R_1\times R_2\to R_2$ be the natural projections. Then $\mathrm{pr}_1(I)$ and $\mathrm{pr}_2(I)$ are ideals of $R_1$ and $R_2$ respectively. It is easy to check that $I\subseteq \mathrm{pr}_1(I)\times \mathrm{pr}_2(I)$. To show the reverse inclusion, let $(a,b)\in \mathrm{pr}_1(I)\times \mathrm{pr}_2(I)$. Then there exist $(a,y)\in I$ such that $\mathrm{pr}_1((a,y))=a$ and $(x,b)\in I$ such that $\mathrm{pr}_2((x,b))=b$. Then 
    \[
    (a,b)=(1,0)(a,y)+(0,1)(x,b)\in I.
    \]
    This implies $I=\mathrm{pr}_1(I)\times \mathrm{pr}_2(I)$.

    Conversely, let $I_1$ and $I_2$ be ideals of $R_1$ and $R_2$ respectively. Then $I_1\times I_2$ is an additive subgroup of $R_1\times R_2$. For any $(a,b)\in I_1\times I_2$ and $(x,y)\in R_1\times R_2$, we have
    \[
    (x,y)(a,b)=(xa,yb)\in I_1\times I_2.
    \]
    This implies $I_1\times I_2$ is an ideal of $R_1\times R_2$.
\end{prf}

\subsection{Coproduct}
Since we have the isomorphisms of categories
$$
\mathsf{CRing}\cong (\mathsf{CRing}/\mathbb{Z})\cong \mathbb{Z}\hspace{0.5pt}{\text -}\mathsf{CAlg},
$$
the coproduct in the category of commutative rings is given by the tensor product of commutative $\mathbb{Z}$-algebras.
\begin{definition}{Coproduct of Commutative Rings}{}
    Let $R$, $S$ be commutative rings. The \textbf{coproduct} of $R$ and $S$, denoted by $R\otimes_{\mathbb{Z}} S$, is the tensor product of $R$ and $S$ over $\mathbb{Z}$. The addition and multiplication are defined as follows:
    \begin{align*}
        (r_1\otimes s_1)+(r_2\otimes s_2)&=(r_1+r_2)\otimes (s_1+s_2)-r_1\otimes s_2 - r_2\otimes s_1,\\
        (r_1\otimes s_1)\cdot(r_2\otimes s_2)&=(r_1r_2)\otimes (s_1s_2).
    \end{align*}
\end{definition}


\subsection{Quotient Ring}
\begin{definition}{Quotient Ring}{}
    Let $R$ be a commutative ring and $I\subseteq R$ be an ideal. The \textbf{quotient ring} of $R$ by $I$, denoted by $R/I$, is the set of equivalence classes of the relation $\sim$ on $R\times R$ defined by $$(a,b)\sim (c,d)\iff a-d\in I.$$ The equivalence class of $(a,b)$ is denoted by $a+I$. The addition and multiplication on $R/I$ are defined as follows:
    \begin{align*}
        (a+I)+(b+I)&=(a+b)+I\\
        (a+I)\cdot(b+I)&=(ab)+I
    \end{align*}
    The addition identify is $0+I$ and the multiplication identity is $1+I$.
\end{definition}

\begin{proposition}{Universal Property of Quotient Ring}{universal_property_of_quotient_ring}
    Let $R$ be a commutative ring and $I\subseteq R$ be an ideal. The natural projection $\pi:R\to R/I$ satisfies the following universal property: for any ring homomorphism $f:R\to S$ such that $I\subseteq \ker f$ or equivalently $f(I)=\left\{0_S\right\}$, there exists a unique ring homomorphism 
    \begin{align*}
        \overline{f}:R/I&\longrightarrow S\\
        r+I&\longmapsto f(r)
    \end{align*}
    such that the following diagram commutes
    \begin{center}
        \begin{tikzcd}[ampersand replacement=\&]
            R \arrow[d, "\pi"', two heads] \arrow[r, "f"] \& S \\[+0.7em]     
            R/I \arrow[ru, "\overline{f}"', dashed]       \&  
        \end{tikzcd}
    \end{center}
    Moreover, $\overline{f}$ is surjective exactly when $f$ is surjective. $\overline{f}$ is injective exactly when $I=\ker f$.
\end{proposition}
\begin{prf}
    If $\overline{f}$ is surjective, then $f=\overline{f}\circ\pi$ is surjective. If $f$ is surjective, then for any $s\in S$, there exists $r\in R$ such that $f(r)=s$. Thus $\overline{f}(r+I)=f(r)=s$. That implies $\overline{f}$ is surjective. 
    
    If $\overline{f}$ is injective, then $\ker f=\ker \overline{f}\circ\pi=\ker \pi=I$. If $I=\ker f$, then 
    \[
    \ker \overline{f}=\left\{r+I\in R/I\mid \overline{f}(r+I)=0\right\}=\left\{r+I\in R/I\mid f(r)=0\right\}=\left\{r+I\in R/I \mid r\in I\right\}=\left\{0+I\right\}=\left\{0_{R/I}\right\}
    \]
    which implies $\overline{f}$ is injective.
\end{prf}



\subsection{Free Object}

\begin{proposition}{}{}
    Define the following free functor
    \[
        \begin{tikzcd}[ampersand replacement=\&]
            \mathsf{Set}\&[-25pt]\&[+10pt]\&[-30pt]\mathsf{CRing}\&[-30pt]\&[-30pt] \\ [-15pt] 
            \mathcal{X}  \arrow[dd, "f"{name=L, left}] 
            \&[-25pt] \& [+10pt] 
            \& [-30pt] \mathbb{Z}\left[\mathcal{X}\right] \arrow[dd, "\mathrm{Free}(f)"{name=R}] \&[-30pt]\ni
            \&[-30pt]\sum\limits_\alpha n_\alpha X_{1}^{\alpha_1}\cdots X_{n}^{\alpha_n}   \arrow[dd,mapsto]\&[-30pt]\\ [-10pt] 
            \&  \phantom{.}\arrow[r, "\mathrm{Free}", squigarrow]\&\phantom{.}  \&   \\[-10pt] 
            \mathcal{Y}  \& \& \&  \mathbb{Z}\left[\mathcal{Y}\right]\&[-30pt]\ni
            \&[-30pt]\sum\limits_\alpha n_\alpha f\left(X_{1}\right)^{\alpha_1}\cdots f\left(X_{n}\right)^{\alpha_n}  
        \end{tikzcd}
    \]  
    We have a pair of adjoint functors
    \[
        \begin{tikzcd}[ampersand replacement=\&]
            \mathsf{CRing} \arrow[r, "{\mathrm{Free}}"{name=U}, bend left, start anchor=east, yshift=1.7ex, end anchor=west] \&[+12pt] 
            \mathsf{Set} \arrow[l, "U"{name=D, anchor=north}, bend left, start anchor=west, yshift=-1.5ex, end anchor=east]
            \arrow[phantom, from=U, to=D, "\dashv"{rotate=-90}]
        \end{tikzcd}
    \]
    and natural isomorphism
    \[
    \mathrm{Hom}_{\mathsf{CRing}}(\mathrm{Free}\left(\mathcal{X} \right), R)\cong \mathrm{Hom}_{\mathsf{Set}}(\mathcal{X} , U(R)).
    \]
\end{proposition}


\begin{definition}{Free Commutative Ring}{}
    Since $\mathsf{CRing}\cong \mathbb{Z}\text{-}\mathsf{CAlg}$, the \textbf{free commutative ring} on a set $X$ is isomorphic to the polynomial ring $\mathbb{Z}[X]$, which coincides with the free commutative $\mathbb{Z}$-algebra on $X$.
\end{definition}

\subsection{Localization}
\begin{definition}{Multuplicative Subset}{}
    Let $R$ be a commutative ring. A subset $S\subseteq R$ is called \textbf{multiplicative} if $S$ is monoid under the multiplication of $R$, i.e.
    \begin{enumerate}[(i)]
        \item $1\in S$.
        \item $a,b\in S\implies ab\in S$.
    \end{enumerate}
\end{definition}
\begin{proposition}{}{}
    Let $\varphi:R\to R'$ be a ring homomorphism and $S\subseteq R$ be a multiplicative subset. Then $\varphi(S)$ is a multiplicative subset of $\subseteq R'$.
\end{proposition}
\begin{prf}
    Since $1\in S$, we have $1'=\varphi(1)\in \varphi(S)$. For any $a',b'\in \varphi(S)$, there exist $a,b\in S$ such that $a'=\varphi(a)$ and $b'=\varphi(b)$. Since $S$ is multiplicative, we have $ab\in S$. Thus $a'b'=\varphi(a)\varphi(b)=\varphi(ab)\in \varphi(S)$. That implies $\varphi(S)$ is a multiplicative subset of $R'$.
\end{prf}

\begin{definition}{Localization of a Ring}{}
    Let $R$ be a commutative ring and $S\subseteq R$ be a multiplicative subset. The \textbf{localization} of $R$ at $S$ is the ring $S^{-1}R$ defined as the set of equivalence classes of the relation $\sim$ on $R\times S$ defined by $$(a,s)\sim (b,t)\iff \exists u\in S\text{ such that }u(at-bs)=0.$$
    The equivalence class of $(a,s)$ is denoted by $\frac{a}{s}$. The addition and multiplication on $S^{-1}R$ are defined as follows:
    \begin{align*}
        \frac{a}{s}+\frac{b}{t}&=\frac{at+bs}{st}\\
        \frac{a}{s}\cdot\frac{b}{t}&=\frac{ab}{st}
    \end{align*}
    The addition identify is $\frac{0}{1}$ and the multiplication identity is $\frac{1}{1}$.
\end{definition}

The localization of a commutative ring $R$ at a multiplicative subset $S$ is a commutative ring $S^{-1}R$. If we consider $R$ as an $R$-module, then the localization of the $R$-module $R$ at $S$ is an $S^{-1}R$-module $S^{-1}R$. The underlying sets of $S^{-1}R$ as a commutative ring and as an $S^{-1}R$-module are the same. Furthermore, the ring structure of $S^{-1}R$ is compatible with the $S^{-1}R$-module structure, which makes $S^{-1}R$ a commutative $S^{-1}R$-algebra. By composing the localization map $R\to S^{-1}R$, $S^{-1}R$ can also be viewed as a commutative $R$-algebra.

Next we introduce the universal property of localization. It says localization is the most economical way to make a multiplicative subset invertible.


\begin{proposition}{Universal Property of Localization}{universal_property_of_localization}
    Let $R$ be a commutative ring and $S\subseteq R$ be a multiplicative subset. The ring homomorphism
    \begin{align*}
        \varphi:R&\longrightarrow S^{-1}R\\
         r&\longmapsto \frac{r}{1}
    \end{align*}
    satisfies the following universal property: for any ring homomorphism $\psi:R\to T$ such that $\psi(S)\subseteq T^\times$ or equivalently $S\subseteq \psi^{-1}(T^\times)$, there exists a unique ring homomorphism 
    \begin{align*}
        \psi':S^{-1}R&\longrightarrow T\\
        \frac{a}{s}&\longmapsto \psi(a)(\psi(s))^{-1}
    \end{align*}
    such that the following diagram commutes
    \begin{center}
        \begin{tikzcd}[ampersand replacement=\&]
            S^{-1}R\arrow[rr, "\psi'", dashed]\&\& T \&  \\        
            \&R \arrow[ru, "\psi"'] \arrow[lu, "\varphi"] \&                          
        \end{tikzcd}
    \end{center}
    Moreover, if $\psi$ is injective, then $\psi'$ is injective. If $\psi$ is surjective, then $\psi'$ is surjective.
\end{proposition}

\begin{prf}
    First let's check $\psi'$ is well-defined. Suppose $\dfrac{a}{s}=\dfrac{b}{t}$. Then there exists $u\in S$ such that $u(at-bs)=0$. Since $\psi$ is a ring homomorphism, we have 
    $$
    0=\psi(u(at-bs))=\psi(u)\left(\psi(a)\psi(t)-\psi(b)\psi(s)\right).
    $$
    Since $u\in S$ and $\psi(S)\subseteq T^\times$, we have $\psi(u)\in T^\times$. Thus
    $$
    \psi'\left(\frac{a}{s}\right)=\psi(a)(\psi(t))^{-1}=\psi(b)(\psi(s))^{-1}= \psi'\left(\frac{b}{t}\right).
    $$ 
    That implies $\psi'$ is well-defined. It is easy to check $\psi'$ is a ring homomorphism
    \[
        \psi'\left(\frac{a}{s}+\frac{b}{t}\right)=\psi'\left(\frac{at+bs}{st}\right)=\psi(at+bs)(\psi(st))^{-1}=\psi(a)(\psi(s))^{-1}+\psi(b)(\psi(t))^{-1}=\psi'\left(\frac{a}{s}\right)+\psi'\left(\frac{b}{t}\right).  
    \]
    The multiplication is similar. The diagram commutes since
    \[
        \psi'\circ\varphi(r)=\psi'\left(\frac{r}{1}\right)=\psi(r)(\psi(1))^{-1}=\psi(r).
    \]
    Now we show $\psi'$ is unique. Suppose there exists another ring homomorphism $\psi'':S^{-1}R\to T$ such that the diagram commutes. Then for any $\frac{a}{s}\in S^{-1}R$, we have 
    \[
        \psi''\left(\frac{a}{s}\right) = \psi''\left(\frac{a}{1}\frac{1}{s}\right) = \psi''\left(\frac{a}{1}\right)\psi''\left(\frac{1}{s}\right) = \psi''\left(\frac{a}{1}\right)\left(\psi''\left(\frac{s}{1}\right)\right)^{-1} = \psi\left(a\right)(\psi(s))^{-1} =    \psi'\left(\frac{a}{s}\right).
    \]
    That implies $\psi''=\psi'$. Thus $\psi'$ is unique.\\
    Now suppose $\psi$ is injective. Then 
    \[
    \ker \psi' = \left\{ \frac{a}{s} \in S^{-1}R \midv \psi(a)(\psi(s))^{-1} = 0 \right\} = \left\{ \frac{a}{s} \in S^{-1}R \midv \psi(a) = 0 \right\} = \left\{ \frac{0}{s} \midv s \in S \right\} = \left\{ 0 \right\},    
    \]
    which implies $\psi'$ is injective.
\end{prf}

\begin{proposition}{Localization of Commutative Rings as a Functor}{}
    Let $\mathsf{CRingM}$ be the category, whose objects and morphisms defined as follows:
    \begin{itemize}
        \item The objects are pairs $(R,S)$ where $R$ is a commutative ring and $S\subseteq R$ is a multiplicative subset.
        \item The morphisms from $(R,S)$ to $(R',S')$ are ring homomorphisms $f:R\to R'$ such that $f(S)\subseteq S'$.
    \end{itemize}
    Localization of commutative rings is a functor
    \[
        \begin{tikzcd}[ampersand replacement=\&]
            \mathsf{CRingM}\&[-25pt]\&[+10pt]\&[-30pt]\mathsf{CRing}\&[-30pt]\&[-30pt] \\ [-15pt] 
            (R,S)  \arrow[dd, "f"{name=L, left}] 
            \&[-25pt] \& [+10pt] 
            \& [-30pt] S^{-1}R\arrow[dd, "L(f)"{name=R}] \&[-30pt]\ni
            \&[-30pt]\frac{a}{s}\arrow[dd,mapsto]\&[-30pt]\\ [-10pt] 
            \&  \phantom{.}\arrow[r, "L", squigarrow]\&\phantom{.}  \&   \\[-10pt] 
            (R',S') \& \& \&  S'^{-1}R'\&[-30pt]\ni
            \&[-30pt]\frac{f(a)}{f(s)}
        \end{tikzcd}
        \]  
        Let $G:\mathsf{CRing}\to \mathsf{CRingM}$ be functor that sends $R$ to $(R,R^\times)$ and $f:R\to R'$ to $(f,f|_{R^\times})$.
        Then we have a pair of adjoint functors
        \[
            \begin{tikzcd}[ampersand replacement=\&]
                \mathsf{CRingM} \arrow[r, "L"{name=U}, bend left, start anchor=east, yshift=1.7ex, end anchor=west] \&[+12pt] 
                \mathsf{CRing} \arrow[l, "G"{name=D, anchor=north}, bend left, start anchor=west, yshift=-1.5ex, end anchor=east]
                \arrow[phantom, from=U, to=D, "\dashv"{rotate=-90}]
            \end{tikzcd}
        \]
        and natural isomorphism
        \[
        \mathrm{Hom}_{\mathsf{CRing}}(S^{-1}R, T)\cong \mathrm{Hom}_{\mathsf{CRingM}}((R,S), (T,T^\times)).
        \]
\end{proposition}




\begin{proposition}{Localization Functor for $R\text{-}\mathsf{CAlg}$}{} 
    Let $R$ be a commutative ring, $S$ be a multiplicative set in $R$, and $M$ be an $R$-module. Define the localization functor as follows
    \[
        \begin{tikzcd}[ampersand replacement=\&]
           R\text{-}\mathsf{CAlg}\&[-25pt]\&[+10pt]\&[-30pt] S^{-1}R\text{-}\mathsf{CAlg}\&[-30pt]\&[-30pt] \\ [-15pt] 
            A  \arrow[dd, "f"{name=L, left}] 
            \&[-25pt] \& [+10pt] 
            \& [-30pt] S^{-1}A\arrow[dd, "S^{-1}(f)"{name=R}] \&[-30pt]\ni
            \&[-30pt]\frac{a}{s}\arrow[dd,mapsto]\&[-30pt]\\ [-10pt] 
            \&  \phantom{.}\arrow[r, "S^{-1}", squigarrow]\&\phantom{.}  \&   \\[-10pt] 
            B \& \& \&  S^{-1}B\&[-30pt]\ni
            \&[-30pt]\frac{f(a)}{s}
        \end{tikzcd}
        \]  
        Let $\mathrm{Res}_{R\to S^{-1}R}: S^{-1}R\text{-}\mathsf{CAlg}\to R\text{-}\mathsf{CAlg}$ be the functor that regards $S^{-1}R$-algebras as $R$-algebras. Then we have a pair of adjoint functors    
        \[
            \begin{tikzcd}[ampersand replacement=\&]
                R\text{-}\mathsf{CAlg} \arrow[r, "S^{-1}"{name=U}, bend left, start anchor=east, yshift=1.7ex, end anchor=west] \&[+12pt] 
                S^{-1}R\text{-}\mathsf{CAlg} \arrow[l, "{\mathrm{Res}}"{name=D, anchor=north}, bend left, start anchor=west, yshift=-1.5ex, end anchor=east]
                \arrow[phantom, from=U, to=D, "\dashv"{rotate=-90}]
            \end{tikzcd}    
        \]
         and natural isomorphism
        \[
        \mathrm{Hom}_{S^{-1}R\text{-}\mathsf{CAlg}}(S^{-1}A, B)\cong \mathrm{Hom}_{R\text{-}\mathsf{CAlg}}(A, \mathrm{Res}_{R\to S^{-1}R}(B)).    
        \]
        And we have the following commutative diagram in $R\text{-}\mathsf{CAlg}$
        \[
            \begin{tikzcd}
                A \arrow[r, "f"] \arrow[d, "l_1"']      & B \arrow[d, "l_2"] \\
                S^{-1}A \arrow[r, "S^{-1}(f)"', dashed] & S^{-1}B           
            \end{tikzcd}
        \]
\end{proposition}





\begin{proposition}{Properties of Localization of Rings}{prop_of_localization_of_rings}
    Let $R$ be a commutative ring and $S\subseteq R$ be a multiplicative subset. Then
    \begin{enumerate}[(i)]
        \item $S^{-1}R=\{0\}$ if and only if $0\in S$.
        \item If $0\notin S$, then $\frac{a}{s}$ is invertible in $S^{-1}R$ if and only if there exists $r\in R$ such that $ra\in S$.
        \item If $0\notin S$, the localization map $\varphi:R\to S^{-1}R$ is injective if and only if $S$ contains no zero divisors.
        \item Localization preserves nilradical: $\mathfrak{N}_{S^{-1}R}=S^{-1}\mathfrak{N}_R$. Especially, $R$ is reduced $\implies$ $S^{-1}R$ is reduced.
    \end{enumerate}
\end{proposition}

\begin{prf}
    \begin{enumerate}[(i)]
        \item \[
            S^{-1}R=0\iff \frac{1}{1}=\frac{0}{1}\iff \exists s\in S\text{ such that }s\cdot 1=0\iff 0\in S.
            \]
        \item Suppose $0\notin S$. If $\frac{a}{s}$ is invertible in $S^{-1}R$, then there exists $\frac{b}{t}\in S^{-1}R$ such that $\frac{a}{s}\cdot\frac{b}{t}=\frac{1}{1}$, which implies there exists $u\in S$ such that $u(ab-st)=0$. Let $r=ub\in R$ and then we see $ra=ust\in S$. Conversely, suppose there exists $r\in R$ such that $ra\in S$. Then $\frac{a}{s}\cdot\frac{rs}{ra}=\frac{1}{1}$, which implies $\frac{a}{s}$ is invertible.
        \item Suppose $0\notin S$. Given the localization map $\varphi:R\to S^{-1}R$, we have
        \[
            \varphi(r)=0\iff \frac{r}{1}=\frac{0}{1}\iff \exists s\in S\text{ such that }s\cdot r=0.
        \]
        Thus 
        $$
        \varphi\text{ is injective}\iff \ker \varphi=\{0\}\iff \forall s\in S,\forall r\in R-\{0\},sr\ne 0\iff S\text{ contains no zero divisors}.
        $$
        \item By \Cref{th:properties_of_localization_of_ideals}, localization commutes with taking radical. Thus we have $\mathfrak{N}_{S^{-1}R}=\sqrt{0(S^{-1}R)}=S^{-1}\sqrt{0R}=S^{-1}\mathfrak{N}_R$. If $R$ is reduced, then the nilradical of $R$ is $\mathfrak{N}_R=(0)$. Thus we have $\mathfrak{N}_{S^{-1}R}=S^{-1}\mathfrak{N}_R=S^{-1}(0)=(0)$, which implies $S^{-1}R$ is reduced.
    \end{enumerate}
\end{prf}


\begin{definition}{Total Ring of Fractions}{}
    Let $R$ be a commutative ring. Then $S=\left\{r\in R-\{0\}\mid r\text{ is not a zero divisor}\right\}$ is a multiplicative subset. The \textbf{total ring of fractions} of $R$ is the localization $S^{-1}R$, denoted by $\mathrm{Frac}(R)$. The localization map $\varphi:R\hookrightarrow \mathrm{Frac}(R)$ is an injective ring homomorphism.
\end{definition}

\begin{prf}
    Since $0\notin S$ and $S$ contains no zero divisors, $\varphi$ is injective by (iii) of \Cref{th:prop_of_localization_of_rings}.
\end{prf}

\begin{proposition}{Properties of Total Ring of Fractions}{}
    Let $R$ be a commutative ring and $S\subseteq R$ be a multiplicative subset. Then $S^{-1}R$ can be regarded as a subring of $\mathrm{Frac}(R)$. 
\end{proposition}

\begin{prf}
    By the universal property of localization, there exists a unique ring homomorphism $\psi:S^{-1}R\to \mathrm{Frac}(R)$. Since $\varphi:R\hookrightarrow \mathrm{Frac}(R)$ is injective, $\psi$ is also injective.
\end{prf}

\begin{definition}{Field of Fractions}{}
    If $R$ be an integral domain, then $S=R-\{0\}$ is a multiplicative subset. The total ring of fractions $\mathrm{Frac}(R)=S^{-1}R=R_{(0)}$ is a field, call the \textbf{field of fractions} of $R$.
\end{definition}


\begin{definition}{Localization of an Ideal}{}
    Let $R$ be a commutative ring, $S$ be a multiplicative set in $R$, and $I$ be an ideal of $R$. If we regard $I$ as a $R$-module, the \textbf{localization of the ideal} $I$ by $S$, denoted $S^{-1}I$, is the localization of the module $I$ by $S$. That is,
    \[
        S^{-1}I=\left\{\frac{a}{s}\midv a\in I, s\in S\right\}.
    \]
    $S^{-1}I$ is a $S^{-1}R$-submodule of $S^{-1}R$. Suppose the localization map is $l_S:R\to S^{-1}R$, $S^{-1}I$ can also defined as the ideal generated by $l_S(I)$ in $S^{-1}R$
    \[
        S^{-1}I=\langle l_S(I)\rangle=\left\{\frac{r}{s}\frac{a}{1}\midv a\in I, \frac{r}{s}\in S^{-1}R\right\}.
    \]
\end{definition}

\begin{proposition}{Properties of Localization of Ideals}{properties_of_localization_of_ideals}
    Let $R$ be a commutative ring, $S$ be a multiplicative set in $R$, and $0\notin S$. Suppose the localization map is $l_S:R\to S^{-1}R$. Then we have maps between the sets of ideals of $R$ and $S^{-1}R$:
    \begin{align*}
        \mathcal{I}(R)=\left\{\text{ideals of }R\right\}\xrightleftarrows[l_S^{-1}]{\quad S^{-1}\quad}
         \left\{\text{ideals of }S^{-1}R\right\}=\mathcal{I}(S^{-1}R)
    \end{align*}
    \begin{enumerate}[(i)]
        \item $S^{-1}\circ l_S^{-1}=\mathrm{id}_{\mathcal{I}(S^{-1}R)}$. As a result, $S^{-1}$ is surjective and $l_S^{-1}$ is injective.
        \item For any ideal $J$ of $S^{-1}R$, there exists an ideal $I$ of $R$ such that $S^{-1}I=J$. 
        \item If $I$ is a ideal of $R$, then $S^{-1}I=S^{-1}R\iff I\cap S\ne\varnothing$.
        \item $l_S$ induces a bijection between the set of prime ideals of $R$ that do not intersect $S$ and the set of prime ideals of $S^{-1}R$. That is, the following restriction of $S^{-1}$ and $l_S^{-1}$ are bijections:
        \begin{align*}
            \left\{I \in \operatorname{Spec}\left(R\right): I \cap S=\varnothing\right\} \xrightleftarrows[l_S^{-1}]{\quad S^{-1}\quad}
           \spec\left(S^{-1}R\right)
        \end{align*}
        \item  If $I$ is an ideal of $R$, then $S^{-1}\sqrt{I} = \sqrt{S^{-1}I}$.
    \end{enumerate}
\end{proposition}

\begin{prf}
    \begin{enumerate}[(i)]
        \item Let $J$ be an ideal of $S^{-1}R$. We have
        \[
            S^{-1}l_S^{-1}(J)=\left\{\frac{x}{s}\midv x\in l_S^{-1}(J),s\in S\right\}=\left\{\frac{x}{s}\midv \frac{x}{1}\in J,s\in S\right\}=\left\{\frac{1}{s}\frac{x}{1}\midv \frac{x}{1}\in J,s\in S\right\}=J.
        \]
        \item It is a direct consequence of the surjectivity of $S^{-1}$.
        \item Let $I$ be an ideal of $R$. We have
        \[
            S^{-1}I=S^{-1}R\iff \frac{1}{1} \in S^{-1}I \iff \exists t,s\in S,a\in I, t(a-s)=0\iff ta=ts\in I\cap S\ne\varnothing \iff I\cap S\ne\varnothing.
        \]
        \item Omitted.
        \item For any $\frac{a}{s} \in S^{-1}\sqrt{I}$, there exists $n \in \mathbb{N}$ such that $a^n \in I$. Since $s^n \in S$, we have $\left(\frac{a}{s}\right)^n \in S^{-1}I$, which implies $\frac{a}{s} \in \sqrt{S^{-1}I}$. Hence $S^{-1}\sqrt{I} \subseteq \sqrt{S^{-1}I}$.

        Conversely, for any $x \in \sqrt{S^{-1}I}$, since $\sqrt{S^{-1}I}$ is an ideal of $S^{-1}R$, there exists $a\in r$ and $s\in S$ such that $x=\frac{a}{s}$. $\frac{a}{s}\in \sqrt{S^{-1}I}$ means there exists $n \in \mathbb{N}$ such that $\left(\frac{a}{s}\right)^n \in S^{-1}I$. Thus there exists $t \in S$ and $b\in I$ such that $\left(\frac{a}{s}\right)^n =\frac{b}{t}$. And this is equivalent to $uta^n =ubs^n$ for some $u\in S$. Note $(uta)^n=u^nt^{n-1}s^nb\in I$, we have $uta\in\sqrt{I}$. Now we get $x=\frac{a}{s} =\frac{uta}{uts}\in S^{-1}\sqrt{I}$. Hence $\sqrt{S^{-1}I} \subseteq S^{-1}\sqrt{I}$.
    \end{enumerate}
\end{prf}


\begin{proposition}{Localization Respects Quotients}{localization_at_ideal_respects_quotients}
    Let $R$ be a commutative ring, $S$ be a multiplicative set in $R$, and $I$ be an ideal of $R$. Let $\pi_I:R\to R/I$ be the projection and $\overline{S}=\pi_I(S)$. Then we have an $R$-algebra isomorphism $\overline{S}^{-1}(R/I)\cong (S^{-1}R)/(S^{-1}I)$ and the following commutative diagram in $R\text{-}\mathsf{CAlg}$ (and accordingly in $\mathsf{CRing}$)
    \[
        \begin{tikzcd}
            R \arrow[r, "\pi_I"] \arrow[d, "l_S"'] &[+5em] R/I \arrow[d, "l_S"]              \\[+2em]
            S^{-1}R \arrow[r, "\pi_{S^{-1}I}"']       & \overline{S}^{-1}(R/I)\cong (S^{-1}R)/(S^{-1}I)
            \end{tikzcd}
    \]
\end{proposition}
\begin{prf}
    From \Cref{th:localization_respects_quotients} we get the commutative diagram in $R\text{-}\mathsf{Mod}$. Since localization map and quotient map are both ring homomorphisms, the commutative diagram holds in $R\text{-}\mathsf{CAlg}$.
\end{prf}




\begin{definition}{Localization at a Prime Ideal}{}
    Let $R$ be a commutative ring and $\mathfrak{p}$ be a prime ideal of $R$. Then $S=R-\mathfrak{p}$ is a multiplicative set. The localization $S^{-1}R$ is called the \textbf{localization of $R$ at $\mathfrak{p}$}, denoted by $R_\mathfrak{p}$. $R_\mathfrak{p}$ is a local ring with unique maximal ideal 
    \[
    \mathfrak{p}R_\mathfrak{p}=S^{-1}\mathfrak{p}=\left\{\frac{x}{s}\midv x\in \mathfrak{p}, s\in R-\mathfrak{p}\right\}.
    \]
    And we have field isomorphism $R_\mathfrak{p}/\mathfrak{p}R_\mathfrak{p}\cong \mathrm{Frac}(R/\mathfrak{p})$. We call the field $R_\mathfrak{p}/\mathfrak{p}R_\mathfrak{p}$ the \textbf{residue field} of $R$ at $\mathfrak{p}$ and denote it by $\kappa(\mathfrak{p})$.
\end{definition}

\begin{prf}
    Note
    \[
        \{I \in \operatorname{Spec} R: I \cap S=\varnothing\}=\{I \in \operatorname{Spec} R: I \cap (R-\mathfrak{p})=\varnothing\}=\{I \in \operatorname{Spec} R: I\subseteq \mathfrak{p}\}.
    \]
    For any ideal $S^{-1}I \in \spec S^{-1}R$, where
    $I\in  \{I \in \operatorname{Spec} R: I \cap S=\varnothing\}$, we have $I\subseteq \mathfrak{p}$, which implies $S^{-1}I\subseteq  S^{-1}\mathfrak{p}$. Thus we see $S^{-1}\mathfrak{p}$ is the unique maximal ideal of $S^{-1}R$. 
    
    According to \Cref{th:localization_at_ideal_respects_quotients}, we have an isomorphism $(R/\mathfrak{p})_{\mathfrak{p}}\cong R_\mathfrak{p}/\mathfrak{p}R_\mathfrak{p}$ and the following commutative diagram in $R\text{-}\mathsf{CAlg}$ 
    \[
        \begin{tikzcd}
            R \arrow[r, "\pi_\mathfrak{p}"] \arrow[d, "l_{R-\mathfrak{p}}"'] &[+5em] R/\mathfrak{p} \arrow[d, "l_{R-\mathfrak{p}}"]              \\[+2em]
            R_\mathfrak{p} \arrow[r, "\pi_{\mathfrak{p}\hspace{-1pt}R_\mathfrak{p}}"']       & \mathrm{Frac}(R/\mathfrak{p})\cong R_\mathfrak{p}/\mathfrak{p} R_\mathfrak{p}
            \end{tikzcd}
    \]
\end{prf}

\begin{lemma}{}{}
    Let $R$ be a commutative ring and $\mathfrak{p}$ be a prime ideal of $R$. Suppose $l:R\to R_\mathfrak{p}$ is the localization map. Then we have
    \[
    l^{-1}\left(R_\mathfrak{p}^{\times}\right)=l^{-1}\left(R_\mathfrak{p}-\mathfrak{p} R_\mathfrak{p}\right)=R-\mathfrak{p}.
    \]
\end{lemma}
\begin{proof}
    Since \[
    \mathfrak{p}R_\mathfrak{p}=\left\{\frac{x}{s}\midv x\in \mathfrak{p}, s\in R-\mathfrak{p}\right\},
    \]
    we have
    \[
    l^{-1}\left(R_\mathfrak{p}^{\times}\right)=l^{-1}\left(R_\mathfrak{p}-\mathfrak{p} R_\mathfrak{p}\right)=\left\{a\in R \midv \frac{a}{1}\notin \mathfrak{p}R_\mathfrak{p}\right\}=\left\{a\in R\midv a\notin \mathfrak{p}\right\}=R-\mathfrak{p}.
    \]
\end{proof}

\begin{proposition}{}{}
    Suppose $\varphi: R\to S$ is a commutative ring homomorphism. Let $\mathfrak{q}$ be a prime ideal of $S$. Then $\mathfrak{p}:=\varphi^{-1}(\mathfrak{q})$ is a prime ideal of $R$. And we have the following commutative diagram in $\mathsf{CRing}$:
    \[
        \begin{tikzcd}
            R \arrow[r, "\varphi"] \arrow[d, "l_\mathfrak{p}"']                  & S \arrow[d, "l_\mathfrak{q}"]                  \\
            R_\mathfrak{p} \arrow[r, "\psi"', dashed] \arrow[d, "\pi_1"']        & S_{\mathfrak{q}} \arrow[d, "\pi_2"]            \\
            R_\mathfrak{p}/\mathfrak{p}R_\mathfrak{p} \arrow[r, "\eta"', dashed] & S_{\mathfrak{q}}/\mathfrak{q} S_{\mathfrak{q}}
            \end{tikzcd}
    \]
\end{proposition}
\begin{prf}
    Note that
    \[
     (l_\mathfrak{q}\circ \varphi)^{-1}(S_{\mathfrak{q}}^\times)=\varphi^{-1}(l_\mathfrak{q}^{-1}(S_{\mathfrak{q}}^\times))=\varphi^{-1}(S-\mathfrak{q})=R-\varphi^{-1}(\mathfrak{q})=R-\mathfrak{p}.
    \]
    By the \hyperref[th:universal_property_of_localization]{universal property of localization}, since $R-\mathfrak{p}\subseteq (l_\mathfrak{q}\circ \varphi)^{-1}(S_{\mathfrak{q}}^\times)$, there exists a unique ring homomorphism 
    \begin{align*}
        \psi:R_\mathfrak{p}&\longrightarrow S_{\mathfrak{q}}\\
        \frac{a}{s}&\longmapsto \frac{\varphi(a)}{\varphi(s)}
    \end{align*}
    such that $l_\mathfrak{q}\circ \varphi=\psi\circ l_\mathfrak{p}$.
    
    Since $\varphi(\mathfrak{p})=\varphi(\varphi^{-1}(\mathfrak{q}))\subseteq\mathfrak{q}$ and $\varphi(R-\mathfrak{p})=\varphi(\varphi^{-1}(S-\mathfrak{q}))\subseteq S-\mathfrak{q}$, we have
    \[
    \psi(\mathfrak{p}R_\mathfrak{p})=\left\{\frac{\varphi(x)}{\varphi(s)}\midv x\in \mathfrak{p}, s\in R-\mathfrak{p}\right\}\subseteq\left\{\frac{y}{t}\midv y\in \mathfrak{q}, t\in S-\mathfrak{q}\right\}=\mathfrak{q}S_{\mathfrak{q}} ,
    \]
    which means $\psi$ is a local ring homomorphism. Note that
    \[
        \psi(\mathfrak{p}R_\mathfrak{p})\subseteq \mathfrak{q}S_{\mathfrak{q}}=\ker \pi_2\implies \mathfrak{p}R_\mathfrak{p}\subseteq \psi^{-1}(\ker \pi_2)=\ker (\pi_2\circ \psi).
    \]
    By the \hyperref[th:universal_property_of_quotient_ring]{universal property of quotient ring}, there exists a unique ring homomorphism
    \begin{align*}
        \eta:R_\mathfrak{p}/\mathfrak{p}R_\mathfrak{p}&\longrightarrow S_{\mathfrak{q}}/\mathfrak{q}S_{\mathfrak{q}}\\
        \frac{a}{s}+\mathfrak{p}R_\mathfrak{p}&\longmapsto \frac{\varphi(a)}{\varphi(s)}+\mathfrak{q}S_{\mathfrak{q}}
    \end{align*}
    such that $\eta\circ \pi_1=\pi_2\circ \psi$. Hence we obtain the commutative diagram.
\end{prf}

\begin{proposition}{Localization of Integral Domain at a Prime Ideal}{}
    Let $R$ be an integral domain and $\mathfrak{p}$ be a prime ideal of $R$. Then $R_\mathfrak{p}$ is an integral domain and we have
    \[
    R = \bigcap_{\mathfrak{p}\in \spec R} R_\mathfrak{p}= \bigcap_{\mathfrak{m}\in \mathrm{MaxSpec} R} R_\mathfrak{m}.
    \]
   
\end{proposition}
\begin{prf}
    First we need to show $R_\mathfrak{p}$ is an integral domain. Suppose $\frac{a}{s},\frac{b}{t}\in R_\mathfrak{p}$ such that $\frac{a}{s}\cdot\frac{b}{t}=\frac{ab}{st}=\frac{0}{1}$. Then there exists $u\in R-\mathfrak{p}$ such that $uab=0$. Since $R$ is an integral domain and $u\ne0$, either $a=0$ or $b=0$, which implies $R_\mathfrak{p}$ is an integral domain.\\
\end{prf}



\begin{example}{}{}
    Let $R$ be a commutative ring and $f\in R$. Let $S=\{1,f,f^2,\cdots\}$ be the monoid generated by $f$. Then $S$ is a multiplicative set. The localization $S^{-1}R$ is called the \textbf{localization of $R$ at $f$}, denoted by $R_f$ or $R\left[\tfrac{1}{f}\right]$. The notation can be justified by the fact that $R\left[\tfrac{1}{f}\right]\cong R\left[t\right]/(ft-1)$.
    $R_f=\{0\}$ if and only if $f$ is nilpotent.
\end{example}

\begin{prf}
    $R_f=\{0\}\iff 0\in S\iff \exists n\in\mathbb{Z}_{\ge0},\;f^n=0$.
\end{prf}

\section{Commutative Ring Homomorphism}

\subsection{Commutative Ring Homomorphism of Finite Type}

\begin{definition}{Finite-type Commutative Algebra}{}
    Let $R\to A$ be a commutative ring homomorphism. We say $A$ is a \textbf{finite-type $R$-algebra}, or that $R\to A$ is \textbf{of finite type}, if one of the following equivalent conditions holds:
    \begin{enumerate}[(i)]
        \item there exists a finite set of elements $a_1,\cdots,a_n$ of $A$ such that every element of $A$ can be expressed as a polynomial in $a_1,\cdots,a_n$, with coefficients in $R$.
        \item there exists a finite set $X$ such that $A\cong R[X]/I$ as $R$-algebra where $I$ is an ideal of $R[X]$.
    \end{enumerate}
    
\end{definition}



\subsection{Integral Commutative Ring Homomorphism}

Recall the \hyperref[th:free_commutative_algebra]{polynomial ring functor}. Let $\varphi:R\to S$ be a ring homomorphism between two commutative rings. Since $\varphi:R\to S$ induces a ring homomorphism 
\begin{align*}
    \widetilde{\varphi}:R[T]& \longrightarrow S[T]\\
    \sum_{k=0}^n r_k T^k &\longmapsto \sum_{k=0}^n \varphi(r_k) T^k
\end{align*}
we can define $\leftindex^{\varphi}\!f:=\widetilde{\varphi}(f)$ for any $f\in R[T]$.

\begin{definition}{Integral Element}{}
    Let $\varphi:R\to S$ be a ring homomorphism between two commutative rings. An element $x\in S$ is called \textbf{integral} over $R$ if there exists a monic polynomial $f\in R[T]$ such that $\leftindex^{\varphi}\!f(x)=0$.
\end{definition}



\begin{definition}{Generated Subalgebra}{generated_commutative_subalgebra}
    Let $\varphi:R\to A$ be a ring homomorphism between two commutative rings and $(a_i)_{i\in I}$ where $a_i\in A$. Let $\mathcal{T}=(T_i)_{i\in I}$. Define
    \begin{align*}
        \theta: \mathcal{T}&\longrightarrow A\\
        T_i&\longmapsto a_i
    \end{align*}
    By the universal property of polynomial ring, there exists a unique ring homomorphism $\psi:R[\mathcal{T}]\to A$ such that 
    $\psi(T_i)=a_i$ for all $i\in I$, that is, the following diagram commutes
    \begin{center}
        \begin{tikzcd}[ampersand replacement=\&]
            R[\mathcal{T}]\arrow[r, dashed, "\exists !\,\psi"]  \& A\\[0.3cm]
            \mathcal{T}\arrow[u, "\iota"] \arrow[ru, "\theta"'] \&  
        \end{tikzcd}
    \end{center}
    The \textbf{$R$-subalgebra of $A$ generated by $(a_i)_{i\in I}$} is defined as 
    \[
    R[\mathcal{T}]:=\psi\left(R[\mathcal{T}]\right)=\left\{ \sum_{|\alpha|\le n} r_{\alpha} a^{\alpha} \in A\;\middle|\; r_{\alpha}\in R\right\}.
    \]
    The \textbf{$R$-subalgebra of $A$ generated by $a$} is defined as 
    \[
    R[a]:=\psi\left(R[T]\right)=\left\{\sum_{k=0}^n r_k a^k \in A\;\middle|\; r_k\in R\right\}.
    \]
\end{definition}

\begin{proposition}{Equivalent Definition of Integral Element}{equivalent_definition_of_integral_element_of_commutative_ring}
    Let $\varphi:R\to S$ be a ring homomorphism between two commutative rings and $a\in S$. Let $R[a]$ be the \hyperref[th:generated_commutative_subalgebra]{$R$-subalgebra of $S$ generated by $a$}. Then $S$ is an $R[a]$-module. And the following statements are equivalent:
    \begin{enumerate}[(i)]
        \item $a$ is integral over $R$.
        \item $R[a]$ is a finitely generated $R$-module.
        \item There exists a faithful $R[a]$-submodule of $S$ that is finitely generated as an $R$-module and contains $x$.
    \end{enumerate}
    Suppose $a_1,\cdots,a_n\in S$. Let $R[a_1,\cdots,a_n]$ be the \hyperref[th:generated_commutative_subalgebra]{$R$-subalgebra of $S$ generated by $a_1,\cdots,a_n$}. Then the following statements are equivalent:
    \begin{enumerate}[(i)]
        \item $a_1,\cdots,a_n$ are integral over $R$.
        \item $R[a_1,\cdots,a_n]$ is a finitely generated $R$-module.
    \end{enumerate}
\end{proposition}
\begin{prf}
    The first part is a special case of \Cref{th:equivalent_definition_of_integral_element}.
\end{prf}

\begin{definition}{Integral Extension}{}
    Let $\varphi:R\to S$ be a ring homomorphism between two commutative rings. If every element of $S$ is integral over $R$, then we say $\varphi$ is \textbf{integral} and $S$ is an \textbf{integral extension} of $R$.
\end{definition}

\begin{proposition}{Descent of Integrality along Ring Homomorphisms}{descent_of_integrality_along_ring_homomorphisms}
    Let $A\xrightarrow{\varphi}B\xrightarrow{\psi} C$ be ring homomorphisms between commutative rings. 
    \begin{enumerate}[(i)]
        \item If $x\in C$ is integral over $A$, then $x$ is integral over $B$.
        \item If $A\to C$ is integral, then $B\to C$ is integral.
    \end{enumerate}
\end{proposition}
\begin{prf}
    \begin{enumerate}[(i)]
        \item Let $f\in A[T]$ be a monic polynomial such that $\leftindex^{\psi\circ\varphi}\!f(x)=0$. We have $\leftindex^{\varphi}\!f\in B[T]$ and $\leftindex^\psi(\leftindex^\varphi f)(x)=\leftindex^{\psi\circ\varphi}\!f(x)=0$. Hence $x$ is integral over $B$.
        \item Since $A\to C$ is integral, every element of $C$ is integral over $A$. By (i), every element of $C$ is integral over $B$. Hence $B\to C$ is integral.
    \end{enumerate}
\end{prf}

\begin{definition}{Integral Closure}{integral_closure}
    Let $\varphi:R\to S$ be a ring homomorphism between two commutative rings. The set of all elements in $S$ that are integral over $R$ is called the \textbf{integral closure of $R$ in $S$}. The integral closure of $R$ in $S$ is an $R$-subalgebra of $S$, denoted by $\overline{R}^S$. If $\varphi$ is injective, we say that $R$ is \textbf{integrally closed in $S$} if $\varphi(R)=\overline{R}^S$.
\end{definition}
\begin{remark}
    Since for any $b\in \varphi(R)$, there exists $a\in R$ such that $b=\varphi(a)$. Let $P(X)=X-a\in R[X]$. Then 
    \[
        \leftindex^{\varphi}\!P(X)=X-\varphi(a)\implies \leftindex^{\varphi}\!P(b)=b-\varphi(a)=0.
    \]
    Hence $b$ is integral over $R$. Since $\varphi(R)\subseteq \overline{R}^S$, we can define a ring homomorphism $u:R\to \overline{R}^S$ as the composition of $\varphi$ and the inclusion map $\varphi(R)\hookrightarrow \overline{R}^S$.
    \[
    u:= \iota\circ \varphi:R\longrightarrow \overline{R}^S.
    \]
    Therefore, integral closure is a ring extension. Furthermore, if $\varphi$ is injective, then $u: R\to \overline{R}^S$ is also injective.
\end{remark}
\begin{proposition}{Universal Properties of Integral Closure}{universal_properties_of_integral_closure}
    Let $\varphi:R\to S$ be a ring homomorphism between two commutative rings. Then for any integral extension $\psi:R\to T$ and any ring homomorphism $f:T\to S$, there exists a unique ring homomorphism 
    \begin{align*}
        \widetilde{f}:T&\longrightarrow \overline{R}^S\\
        t&\longmapsto f(t)
    \end{align*}
    such that the following diagram commutes
    \[
        \begin{tikzcd}
                & \overline{R}^S \arrow[rdd, "\iota", hook]      &   \\[+1.5em]
                & T \arrow[rd, "f"'] \arrow[u, "\widetilde{f}"', dashed] &   \\
    R \arrow[rr, "\varphi"'] \arrow[ru, "\psi"'] \arrow[ruu, "u"] &                                                & S
    \end{tikzcd}
    \]
    That is, $R\to \overline{R}^S \hookrightarrow S$ is terminal.
\end{proposition}
\begin{prf}
    First we show $f(T)\subseteq \overline{R}^S$. For any $b\in f(T)$, there exists $a\in T$ such that $b=f(a)$. Since $a$ is integral over $R$, there exists a monic polynomial $P(X)=X^n+r_{n-1}X^{n-1}+\cdots+r_0\in R[X]$ such that $\leftindex^{\psi}\!P(a)=0$. By applying $f$ to both sides of the equation, we get
    \[
        f\left(\leftindex^{\psi}\!P(a)\right)=\leftindex^{f\circ \psi}\!P(f(a))=\leftindex^{\varphi}\!P(b)=0,
    \]
    which implies $b$ is integral over $R$. Hence $f(T)\subseteq \overline{R}^S$. So we can define a ring homomorphism
    \begin{align*}
        \widetilde{f}:T&\longrightarrow \overline{R}^S\\
        t&\longmapsto f(t)
    \end{align*}
   such that $\iota\circ \widetilde{f}=f$. Since $\iota$ is injective,
   \[
   \iota\circ \widetilde{f}\circ \psi=f\circ \psi=\varphi=\iota\circ u\implies \widetilde{f}\circ \psi=u.
   \]
   Thus we obtain the commutative diagram.

   Suppose there exists another ring homomorphism $g:T\to \overline{R}^S$ such that $\iota\circ g=f$. Since $\iota$ is injective, we have $g=\widetilde{f}$. This means $\widetilde{f}$ is unique.
\end{prf}
   

\begin{definition}{Integral Closure of Integal Domain in Field of Fractions}{integral_closure_in_field_of_fractions}
    Let $R$ be an integral domain. The \textbf{integral closure of $R$} or \textbf{normalization of $R$} is defined to be the integral closure of $R$ in $\mathrm{Frac}(R)$. 
\end{definition}
\begin{remark}
    We say $R$ is \textbf{integrally closed} or \textbf{normal} if $R$ is integrally closed in $\mathrm{Frac}(R)$. See \Cref{th:normal_domain}
\end{remark}

\begin{proposition}{Fraction Field of Integral Closure of Integral domain}{}
    Let $R$ be an integral domain and $\mathrm{Frac}(R)$ be its field of fractions. If $L/K$ is a finite field extension, and $\overline{R}^L$ is the integral closure of $R$ in $L$, then $L$ is a field of fractions of $\overline{R}^L$.
\end{proposition}
\begin{prf}
    $\overline{R}^L$ is an integral domain because it is a subring of integral domain $L$. Let $l:\overline{R}^L\hookrightarrow \mathrm{Frac}\left(\overline{R}^L\right) $ be the localization map and $\iota:\overline{R}^L\hookrightarrow L$ be the inclusion. According to the universal property of field of fractions, there exists a unique field homomorphism 
    \begin{align*}
        \psi:\mathrm{Frac}\left(\overline{R}^L\right) &\longrightarrow L\\
        \frac{a}{b}&\longmapsto \frac{a}{b}
    \end{align*}
    such that the following diagram commutes
    \[
        \begin{tikzcd}
            \mathrm{Frac}\left(\overline{R}^L\right)  \arrow[r, "\psi", dashed]        & L \\[1em]
            \overline{R}^L \arrow[u, "l", hook] \arrow[ru, "\iota"', hook] &  
            \end{tikzcd}
    \]
    For any $x\in L$, suppose the minimal polynomial of $x$ is
    \[
    f(T) = T^n + a_{n-1}T^{n-1} + \cdots + a_1T + a_0 \in K[T].
    \]
    By multiplying $f(T)$ by the product of the denominators of the coefficients of $f(T)$, we get a polynomial $g(T)\in R[T]$ such that 
    \[
    g(x)=b_n x^n + b_{n-1}x^{n-1} + \cdots + b_1x + b_0 = 0.
    \]
    Multiplying this equation by $b_n^{n-1}$, we get
    \[
    (b_n x)^n + b_{n-1}(b_n x)^{n-1} + \cdots + b_1b_n^{n-2}(b_n x) + b_0 = 0,
    \]
    which implies $b_n x$ is integral over $R$. Since $\overline{R}^L$ is the integral closure of $R$ in $L$, we have $b_n x\in \overline{R}^L$. Hence 
    \[
    x=\psi\left(\frac{b_n x}{b_n}\right)\in \psi\left(\mathrm{Frac}\left(\overline{R}^L\right)\right).
    \]
    Therefore, $\psi$ is a isomorphism between $l:\overline{R}^L\hookrightarrow \mathrm{Frac}\left(\overline{R}^L\right) $ and $\iota:\overline{R}^L\hookrightarrow L$. Since any object isomorphic to an initial object is also initial, we see $L$ is a field of fractions of $\overline{R}^L$.
 
\end{prf}


\begin{proposition}{Quotient and Localization Respect Integral Extensions}{quotient_and_localization_respect_integral_extensions}
    Let $R\subseteq T$ be an integral extension of commutative rings. Then 
    \begin{enumerate}[(i)]
        \item If $\mathfrak{b}$ is an ideal of $T$, then $\mathfrak{a}:= R\cap \mathfrak{b}$ is an ideal of $R$ and $S/\mathfrak{b}$ is integral over $R/\mathfrak{a}$.
        \item If $S$ is a multiplicative set in $R$, then $S^{-1}T$ is integral over $S^{-1}R$.
    \end{enumerate}
\end{proposition}
\begin{prf}
    \begin{enumerate}[(i)]
        \item Since 
    \[
    \ker (\pi_{\mathfrak{b}}\circ \iota )= \iota^{-1}\left(\ker \pi_{\mathfrak{b}}\right)=\iota^{-1}\left(\mathfrak{b}\right)=R \cap \mathfrak{b}=\mathfrak{a},
    \]
    by the universal property of quotient ring, there is an injective ring homomorphism 
    \begin{align*}
        \overline{\iota}:R/\mathfrak{a}&\hookrightarrow T/\mathfrak{b}\\
        r+\mathfrak{a}&\longmapsto r+\mathfrak{b}.
    \end{align*} such that the following diagram commutes
    \[
        \begin{tikzcd}
            R \arrow[r, "\iota", hook] \arrow[d, two heads] & T \arrow[d, "\pi_{\mathfrak{b}}", two heads] \\
            R/\mathfrak{a} \arrow[r, "\overline{\iota}"', dashed, hook]                & T/\mathfrak{b}             
            \end{tikzcd}
    \]
    For any $s + \mathfrak{b}\in T/\mathfrak{b}$, there exists a monic polynomial $f\in R[x]$ such that $\leftindex^{\iota}\!f(s)=0_T$. So we have the following commutative diagram
    \[
        \begin{tikzcd}
            {R[x]} \arrow[r, "\widetilde{\iota}", hook] \arrow[d, "\widetilde{\pi_\mathfrak{a}}"', two heads] & {T[x]} \arrow[d, "\widetilde{\pi_\mathfrak{b}}", two heads] \arrow[r, two heads] & {T[x]/(x-s)} \arrow[d] \arrow[r, "\sim"]           & T \arrow[d]    \\[0.8em]
            {(R/\mathfrak{a})[x]} \arrow[r, "\widetilde{\overline{\iota}}"', dashed, hook]                    & {(T/\mathfrak{b})[x]} \arrow[r, two heads]                                       & {(T/\mathfrak{b})[x]/(x-\pi_{\mathfrak{b}}(s))} \arrow[r, "\sim"] & T/\mathfrak{b}
            \end{tikzcd}
    \]
    By evaluating this diagram at $f \in R[x]$, we see there exists a monic polynomial $g:=\leftindex^{\pi_\mathfrak{a}}\!f \in (R/\mathfrak{a})[x]$ such that 
    \[
    \leftindex^{\overline{\iota}}g(s+\mathfrak{b})=\leftindex^{\iota}\!f(s)+\mathfrak{b}=0_{S/\mathfrak{b}},
    \]
    which implies $s+\mathfrak{b}$ is an integral element over $R/\mathfrak{a}$.
    \item Regard $R,T$ as $R$-modules. Since the localization functor $S^{-1}:R\text{-}\mathsf{Mod}\to S^{-1}R\text{-}\mathsf{Mod}$ is exact, from the exact sequence in $R\text{-}\mathsf{Mod}$
    \[
    0\longrightarrow R\longrightarrow T
    \]
    we get the exact sequence in $S^{-1}R\text{-}\mathsf{Mod}$
    \[
    0\longrightarrow S^{-1}R\longrightarrow S^{-1}T.
    \]
    Note that the underlying sets of the $S^{-1}R$-module $S^{-1}T$ and the commutative ring $S^{-1}T$ coincide and the two algebraic structures on the same underlying set are compatible, which makes $S^{-1}T$ an $S^{-1}R$-algebra. 
    For any $\frac{a}{s}\in S^{-1}T$, there exists a monic polynomial
    \[
    f(x)=x^n+r_{n-1}x^{n-1}+\cdots+r_0\in R[x]
    \]
    such that 
    \[
        \leftindex^{\iota}\!f(a)=a^n+r_{n-1}a^{n-1}+\cdots+r_0=0_T.
    \]
    This equation can be rewritten as
    \[
\left(\frac{a}{s}\right)^n+\frac{r_{n-1}}{s}\left(\frac{a}{s}\right)^{n-1}+\cdots+\frac{r_0}{s^n}=0_{S^{-1}T},
    \]
    which implies $\frac{a}{s}$ is an integral element over $S^{-1}R$.
    

\end{enumerate}
\end{prf}

The following proposition shows that the property of being integral is preserved under field extension.
\begin{proposition}{Injective Ring Extension Preserves Integral Elements}{injective_ring_extension_preserves_integral_elements}
    Suppose $A\xrightarrow{\varphi} B\xhookrightarrow{\iota} C$ are ring homomorphisms between commutative rings and $\iota$ is injective. For any $b\in B$, $b$ is integral over $A$ if and only if $\iota(b)$ is integral over $A$.
\end{proposition}
\begin{prf}
   Let $c=\iota(b)$. We have the following commutative diagram
    \[
        \begin{tikzcd}
            {C[X]} \arrow[r, "\pi_2", two heads]                                  & {C[X]/\left(X-c\right)} \arrow[r, "\mathrm{ev}_c"]      & C                          \\
            {B[X]} \arrow[u, "\tilde{\iota}", hook] \arrow[r, "\pi_1", two heads] & {B[X]/(X-b)} \arrow[r, "\mathrm{ev}_b"] \arrow[u, hook] & B \arrow[u, "\iota", hook] \\
            {A[X]} \arrow[u, "\tilde{\varphi}"]                                   &                                                         &                           
            \end{tikzcd}
    \]
    If $c$ is integral over $A$, there exists a monic polynomial $f\in A[X]$ such that 
    \[
    \mathrm{ev}_c\circ\pi_2\circ\tilde{\iota}\circ\tilde{\varphi}(f)=\leftindex^{\varphi\circ\iota}f(c)=0_C,
    \]
    which implies 
    \[
        \iota\circ\mathrm{ev}_b\circ \pi_1\circ\tilde{\varphi}(f)=\iota(\mathrm{ev}_b\circ \pi_1\circ\tilde{\varphi}(f))=0_C.
    \]
    Since $\iota$ is injective, we have $\mathrm{ev}_b\circ \pi_1\circ\tilde{\varphi}(f)=0_B$, which implies $b$ is integral over $A$.

    Conversely, if $b$ is integral over $A$, there exists a monic polynomial $f\in A[X]$ such that
    \[
        \mathrm{ev}_b\circ \pi_1\circ\tilde{\varphi}(f)=\leftindex^{\varphi}f(b)=0_B.
    \]
    Thus we have
    \[
        \leftindex^{\varphi\circ\iota}f(c)=\mathrm{ev}_c\circ\pi_2\circ\tilde{\iota}\circ\tilde{\varphi}(f)=\iota\circ\mathrm{ev}_b\circ \pi_1\circ\tilde{\varphi}(f)=\iota(\mathrm{ev}_b\circ \pi_1\circ\tilde{\varphi}(f))=\iota(0_B)=0_C,
    \]
    which implies $c$ is integral over $A$.
\end{prf}


\begin{proposition}{Surjectivity of Spectrum Map of Integral Extension}{surjectivity_of_spectrum_map_of_integral_extension}
    Let $R\subseteq S$ be an integral extension of commutative rings and $\varphi:R\hookrightarrow S$ be the inclusion. Then the map $\varphi^{-1}:\spec (S)\to \spec (R)$ is surjective.
\end{proposition}


\begin{proposition}{}{condition_for_subring_of_field_to_be_field}
    Let $R\subseteq K$ be an extension of commutative rings and $K$ be a field. 
    \begin{itemize}
        \item If $K$ is integral over $R$, then $R$ is a field. The field extension $K/R$ is algebraic.
        \item If $K$ is finite over $R$, then $R$ is a field. The field extension $K/R$ is finite.
    \end{itemize}
\end{proposition}
\begin{proof}
    \begin{itemize}
        \item According to \Cref{th:surjectivity_of_spectrum_map_of_integral_extension}, the map $\varphi^{-1}:\spec (K)\to \spec (R)$ is surjective. Since $\spec (K)$ is a singleton, $\spec (R)$ is also a singleton. It is clear that $R$ is a Noetherian ring. According to \Cref{th:equivalent_characterization_of_artinian_rings}, $R$ is an Artinian ring. Since $R$ is a subring of a field, $R$ is an integral domain. Since \hyperref[th:artinian_integral_domain_is_a_field]{Artinian integral domain is a field}, $R$ is a field.
    \end{itemize}
\end{proof}

\begin{proposition}{}{integral_over_field_is_field}
    Let $\varphi:K\to S$ be a ring homomorphism of integral domains and $K$ be a field. 
    \begin{itemize}
        \item If $S$ is integral over $K$, then $S$ is a field.
    \end{itemize}
\end{proposition}

\begin{corollary}{}{integral_extension_of_domains_become_field_simultaneously}
    Let $R\subseteq S$ be an integral extension of integral domains. Then $R$ is a field if and only if $S$ is a field.
\end{corollary}

\begin{prf}
    This is a direct consequence of \Cref{th:condition_for_subring_of_field_to_be_field} and \Cref{th:integral_over_field_is_field}.
\end{prf}

\begin{corollary}{}{lying_over_preserves_maximality}
    Let $R\subseteq S$ be an integral extension of commutative rings. Let $\mathfrak{q}$ be a prime ideal of $S$ and $\mathfrak{p}:=R\cap \mathfrak{q}$. Then  $\mathfrak{q}$ is maximal if and only if $\mathfrak{p}$ is maximal.
\end{corollary}
\begin{prf}
    From \Cref{th:quotient_and_localization_respect_integral_extensions} we see $ R/\mathfrak{p}\hookrightarrow S/\mathfrak{q}$ is an integral extension of integral domains. By \Cref{th:integral_extension_of_domains_become_field_simultaneously} we know $R/\mathfrak{p}$ is a field if and only if $S/\mathfrak{q}$ is a field. This implies $\mathfrak{p}$ is maximal if and only if $\mathfrak{q}$ is maximal.
\end{prf}

\begin{definition}{}{lying_over_and_going_up_properties}
    Let $R\subseteq S$ be an extension of commutative rings.
    \begin{itemize}
        \item \textbf{lying over property}: If there exist $\mathfrak{p}\in \spec R$ and $\mathfrak{q}\in \spec S$ such that $\mathfrak{q}\cap R=\mathfrak{p}$, we say $\mathfrak{q}$ \textbf{lies over} $\mathfrak{p}$ and $\mathfrak{p}$ \textbf{lies under} $\mathfrak{q}$. We say the extension $R\subseteq S$ satisfies the \textbf{lying over property} if every prime ideal of $R$ lies under some prime ideal of $S$.
        \item \textbf{incomparability property}: we say the extension $R\subseteq S$ satisfies the \textbf{incomparability property} if for any two distinct prime ideals $\mathfrak{q}_1, \mathfrak{q}_2$ of $S$ lying over  $\mathfrak{p}\in \spec R$, we have $\mathfrak{q}_1\not\subseteq \mathfrak{q}_2$ and $\mathfrak{q}_2\not\subseteq \mathfrak{q}_1$.
        \item \textbf{going-up property}: we say the extension $R\subseteq S$ satisfies the \textbf{going-up property} if for any prime ideals $\mathfrak{p}_1\subseteq \mathfrak{p}_2$ of $R$ and any prime ideal $\mathfrak{q}_1$ of $S$ lying over $\mathfrak{p}_1$, there exists a prime ideal $\mathfrak{q}_2$ of $S$ lying over $\mathfrak{p}_2$ such that $\mathfrak{q}_1\subseteq \mathfrak{q}_2$.
        \item \textbf{going-down property}: we say the extension $R\subseteq S$ satisfies the \textbf{going-down property} if for any prime ideals $\mathfrak{p}_1\supseteq \mathfrak{p}_2$ of $R$ and any prime ideal $\mathfrak{q}_1$ of $S$ lying over $\mathfrak{p}_1$, there exists a prime ideal $\mathfrak{q}_2$ of $S$ lying over $\mathfrak{p}_2$ such that $\mathfrak{q}_1\supseteq \mathfrak{q}_2$.
    \end{itemize}
\end{definition}

\begin{proposition}{}{}
    if an extension $R \subseteq  T$ satisfies the going-up property, then it also satisfies the lying-over property.
\end{proposition}

The following theorems are also called the Cohen-Seidenberg theorems.
\begin{theorem}{Going-up and Going-down Theorems}{going_up_and_going_down_theorems}
    Let $R\subseteq T$ be an extension of commutative rings. Then the following hold:
    \begin{enumerate}[(i)]
        \item \textbf{Going-up Theorem}: If $R\subseteq T$ is an integral extension, then it satisfies the going-up property and and the incomparability property.
        \item \textbf{Going-down Theorem}: If $R\subseteq T$ is an integral extension, $T$ is an integral domain, and $R$ is integrally closed in $T$, then it satisfies the going-down property.
    \end{enumerate}
    
\end{theorem}
\begin{prf}
    \begin{enumerate}[(i)]
        \item First we prove the incomparability property. It is sufficient to show if $\mathfrak{q}_1, \mathfrak{q}_2$ are prime ideals of $S$ lying over $\mathfrak{p}\in \spec R$ such that $\mathfrak{q}_1\subseteq \mathfrak{q}_2$, then $\mathfrak{q}_1=\mathfrak{q}_2$. Let $S=R-\mathfrak{p}$. According to \Cref{th:quotient_and_localization_respect_integral_extensions}, we obtain an integral extension
        \begin{align*}
            \iota: R_\mathfrak{p}&\hookrightarrow S^{-1}T\\
            \frac{r}{s}&\longmapsto \frac{r}{s}.
        \end{align*}
        
        $\mathfrak{p}R_\mathfrak{p}$ is a maximal ideal of $R_\mathfrak{p}$. Let 
        \begin{align*}
            \mathfrak{a}_1&:=S^{-1}\mathfrak{q}_1=\left\{\frac{q}{s}\in S^{-1}T\midv q\in \mathfrak{q}_1, s\in S\right\},\\
            \mathfrak{a}_2&:=S^{-1}\mathfrak{q}_2=\left\{\frac{q}{s}\in S^{-1}T\midv q\in \mathfrak{q}_2, s\in S\right\}.
        \end{align*}
        Since 
        \[
            \mathfrak{q}_1\cap S=\mathfrak{q}_1\cap (R-\mathfrak{p})=\mathfrak{q}_1\cap(R-(\mathfrak{q}_1\cap R))=\mathfrak{q}_1\cap\left(R-\mathfrak{q}_1\right)=\varnothing,
        \]
        $\mathfrak{a}_1$ and $\mathfrak{a}_2$ are prime ideals of $S^{-1}T$. And we can check that
        \begin{align*}
            \mathfrak{a}_1\cap R_\mathfrak{p}&=\iota^{-1}(\mathfrak{a}_1)\\
            &=\left\{\frac{q}{s}\in R_\mathfrak{p}\midv q\in \mathfrak{q}_1, s\in S\right\}\\
            &=\left\{\frac{q}{s}\in R_\mathfrak{p}\midv q\in \mathfrak{q}_1\cap R, s\in S\right\}\\
            &=\left\{\frac{q}{s}\in R_\mathfrak{p}\midv q\in \mathfrak{p}, s\in S\right\}\\
            &=\mathfrak{p}R_\mathfrak{p}.
        \end{align*}
        Similarly we have $\mathfrak{a}_2\cap R_\mathfrak{p}=\mathfrak{p}R_\mathfrak{p}$. So $\mathfrak{a}_1$ and $\mathfrak{a}_2$ are prime ideals of $S^{-1}T$ lying over $\mathfrak{p}R_\mathfrak{p}$. By \Cref{th:lying_over_preserves_maximality}, both $\mathfrak{a}_1$ and $\mathfrak{a}_2$ are maximal ideals of $S^{-1}T$. Since $\mathfrak{q}_1\subseteq \mathfrak{q}_2$, we have $\mathfrak{a}_1\subseteq \mathfrak{a}_2$. By the maximality of $\mathfrak{a}_1$ and $\mathfrak{a}_2$, we have $\mathfrak{a}_1=\mathfrak{a}_2$. Since 
        \begin{align*}
            S^{-1}:\left\{\mathfrak{q} \in \operatorname{Spec}\left(T\right): \mathfrak{q} \cap S=\varnothing\right\} &\longrightarrow
           \spec\left(S^{-1}T\right)\\
            \mathfrak{q} &\longmapsto S^{-1}\mathfrak{q}
        \end{align*}
        is a bijection, we have $\mathfrak{q}_1=\mathfrak{q}_2$.\\
    \end{enumerate}
\end{prf}
\begin{corollary}{}{}
    Let $R\subseteq S$ be an integral extension of integral domains. Then the unique prime ideal of $S$ which lies over $(0)$ is $(0)$.
\end{corollary}
\begin{proof}
    By \Cref{th:going_up_and_going_down_theorems}, the extension $R\subseteq S$ satisfies the incomparability property. Suppose there exists a nonzero prime ideal $\mathfrak{q}$ of $S$ lying over $(0)$. Since $(0)$ is another prime ideal of $S$ lying over $(0)$, we have $(0)\not\subseteq \mathfrak{q}$, which is a contradiction.
\end{proof}





\begin{proposition}{Composition of Integral Ring Homomorphisms is Integral}{}
    Let $\varphi:R\to S$ and $\psi:S\to T$ be two integral homomorphisms between commutative rings. Then $\psi\circ\varphi:R\to T$ is also integral.
\end{proposition}
\begin{prf}
    Let $t\in T$. Since $\psi$ is integral, there exists a monic polynomial $f(x)=x^n+a_{n-1}x^{n-1}+\cdots+a_0\in S[X]$ such that $f(t)=0_T$. Let $S'=R[a_0,\cdots,a_{n-1}]\subseteq S$. Since $S$ is integral over $R$, we see $a_0,\cdots,a_{n-1}\in S$ are integral over $R$. By \Cref{th:equivalent_definition_of_integral_element_of_commutative_ring}, this implies $S'$ is finite over $R$. Since $t$ is integral over $S'$, again by \Cref{th:equivalent_definition_of_integral_element_of_commutative_ring} $S'[t]$ is finite over $S'$. Thus by \Cref{th:composition_of_finite_ring_homomorphisms_is_finite}, $S'[t]$ is finite over $R$, which implies $S'[t]$ is integral over $R$. Therefore, $t$ is integral over $R$.
\end{prf}


\subsection{Finite Commutative Ring Homomorphism}

\begin{definition}{Finite Commutative Ring Homomorphism}{}
    Let $\varphi:R\to S$ be a homomorphism between two commutative rings. We say $\varphi$ is \textbf{finite} if $S$ as an $R$-module is finitely generated.
\end{definition}

\begin{definition}{Finitely Generated Commutative Algebra}{}
    Let $R\to A$ be a commutative ring homomorphism. We say $A$ is a \textbf{finitely generated $R$-algebra} or $A$ is \textbf{finite} over $R$ if one of the following equivalent conditions holds:
    \begin{enumerate}[(i)]
        \item $R\to A$ is finite.
        \item $A$ as an $R$-module is finitely generated.
    \end{enumerate} 
\end{definition}

\begin{proposition}{}{finiteness_of_R_module_iff_finiteness_of_S_module}
    Let $\varphi:R\to S$ be a finite homomorphism between two commutative rings. Let $M$ be an $S$-module. Then $M$ is a finitely generated $R$-module if and only if $M$ is a finitely generated $S$-module.
\end{proposition}
\begin{prf}
    Suppose $M$ is a finitely generated $R$-module. According to \Cref{th:finiteness_of_R_module_implies_finiteness_of_S_module}, $M$ is a finitely generated $S$-module. 
    
    Conversely, suppose $M$ is a finitely generated $S$-module. Then we have exact sequence of $S$-modules
    \[
    S^m\longrightarrow M \longrightarrow 0.
    \]
    Since \hyperref[th:ring_homomorphism_induces_functor]{the functor: $\varphi_*$ is exact}, the above exact sequence is also exact when we regard $S^m$ as an $R$-module. Since $S$ is a finitely generated $R$-module, we have an exact sequence of $R$-modules
    \[
    R^n\longrightarrow S \longrightarrow 0.
    \]
    Since direct sum is exact, we have an exact sequence of $R$-modules
    \[
    R^{nm}\longrightarrow S^m \longrightarrow 0.
    \]
    By composing $R^{nm}\longrightarrow S^m$ with $S^m\longrightarrow M$, we get a surjective $R$-linear map $R^{nm}\longrightarrow M$. Therefore, $M$ is a finitely generated $R$-module.
\end{prf}

\begin{proposition}{Composition of Finite Ring Homomorphisms is Finite}{composition_of_finite_ring_homomorphisms_is_finite}
    Let $\varphi:R\to S$ and $\psi:S\to T$ be two finite homomorphisms between commutative rings. Then $\psi\circ\varphi:R\to T$ is also finite.
\end{proposition}
\begin{prf}
    If $\varphi:R\to S$ and $\psi:S\to T$ are finite, according to \Cref{th:finiteness_of_R_module_iff_finiteness_of_S_module}, $T$ is also finite over $R$. 
\end{prf}




\begin{proposition}{Finite Generation Implies Finite Type}{finite_generation_implies_finite_type}
    Let $A$ be a $R$-algebra. If $A$ is finitely generated as an $R$-module, then $A$ is a finite-type $R$-algebra.
\end{proposition}

\begin{prf}
    This holds because if each element of $A$ can be expressed as an $R$-linear combination of finitely many elements of $A$, then each element of $A$ can also be expressed as a polynomial in finitely many elements of $A$ with coefficients in $R$.

    An alternative proof can be given by utilizing the universal property of the free contruction. Suppose $A$ is finitely generated as an $R$-module. Then there exists some a finite set $X=\{x_1,\cdots,x_n\}$ and a surjective $R$-linear map $\varphi:R^{\oplus X}\to A$. Define $f=\varphi\circ \iota$, where $\iota:X\to R^{\oplus X}$ is the inclusion map. 
     \begin{center}
        \begin{tikzcd}[ampersand replacement=\&]
            R^{\oplus X}\arrow[r, dashed, "\exists !\,\widetilde{j}"]  \&R[X]\arrow[r, dashed, "\exists !\,\widetilde{f}"]  \& A\\[0.3cm]
            \& X\arrow[ul, "\iota"] \arrow[u, "j"] \arrow[ru, "f:=\varphi\circ \iota"'] \&  
        \end{tikzcd}
    \end{center}
    The universal property of free $R$-module induces a unique $R$-linear map $\widetilde{j}:R^{\oplus}\to R[X]$ such that $j=\widetilde{j}\circ \iota$. And the universal property of free commutative $R$-algebra induces a unique $R$-algebra homomorphism $\widetilde{f}:R[X]\to A$ such that $f=\widetilde{f}\circ j$. Note $f=\varphi\circ \iota=\left(\widetilde{f}\circ \widetilde{j}\right)\circ \iota$. By the uniqueness of the universal property of $R^{\oplus}$, we have $\widetilde{f}\circ \widetilde{j}=\varphi$. Since $\widetilde{f}\circ \widetilde{j}$ is surjective, $\widetilde{f}$ must be surjective, which implies $A$ is a finite-type $R$-algebra.
\end{prf}

\begin{corollary}{Finite $\implies$ Finite Type}{}
    Let $\varphi:R\to A$ be a finite homomorphism between two commutative rings. Then $\varphi$ is of finite type.
\end{corollary}
\begin{prf}
    This is a reformulation of \Cref{th:finite_generation_implies_finite_type}.
\end{prf}



\begin{proposition}{Quotient Respect Finiteness}{quotient_and_localization_respect_finiteness}
    Let $\varphi:R\to T$ be an finite homomorphism of commutative rings. Then 
    \begin{enumerate}[(i)]
        \item Suppose $\mathfrak{b}$ is an ideal of $S$, and $\mathfrak{a}:=\varphi^{-1}(\mathfrak{b})$. Then $\overline{\varphi}:R/\mathfrak{a}\to T/\mathfrak{b}$ is finite.
        \item Suppose $S$ is a multiplicative set of $R$, and $\widetilde{S}=\varphi(S)$. Then $\widetilde{\varphi}:S^{-1}R\to \widetilde{S}^{-1}T$ is finite.
    \end{enumerate}
\end{proposition}
\begin{prf}
    \begin{enumerate}[(i)]
        \item Let $\mathfrak{a}:=\varphi^{-1}(\mathfrak{b})$. Since 
    \[
    \ker (\pi_{\mathfrak{b}}\circ \varphi )= \varphi^{-1}\left(\ker \pi_{\mathfrak{b}}\right)=\varphi^{-1}\left(\mathfrak{b}\right)=\mathfrak{a},
    \]
    by the universal property of quotient ring, there is an injective ring homomorphism 
    \begin{align*}
        \overline{\varphi}:R/\mathfrak{a}&\hookrightarrow T/\mathfrak{b}\\
        r+\mathfrak{a}&\longmapsto \varphi(r)+\mathfrak{b}.
    \end{align*}
     such that the following diagram commutes
    \[
        \begin{tikzcd}
            R \arrow[r, "\varphi", hook] \arrow[d, "\pi_{\mathfrak{a}}"', two heads] & T \arrow[d, "\pi_{\mathfrak{b}}", two heads] \\
            R/\mathfrak{a} \arrow[r, "\overline{\varphi}"', dashed, hook]                & T/\mathfrak{b}             
        \end{tikzcd}
    \]
    Since $T$ is a finitely generated $R$-module, we can suppose the generating set of $T$ is $\{t_1,\cdots,t_n\}$. Then for any $t+\mathfrak{b}\in T/\mathfrak{b}$, there exists $r_1,\cdots,r_n\in R$ such that $t=\sum_{i=1}^n \varphi(r_i)t_i$. Thus we have
    \[
    t+\mathfrak{b}=\left(\sum_{i=1}^n \varphi(r_i)t_i\right)+\mathfrak{b}
    =\sum_{i=1}^n \left(\varphi(r_i)t_i+\mathfrak{b}\right)=\sum_{i=1}^n (\varphi(r_i)+\mathfrak{b})\left(t_i+\mathfrak{b}\right)=\sum_{i=1}^n \overline{\varphi}(r_i+\mathfrak{a})\left(t_i+\mathfrak{b}\right).
    \]
    Hence $\{t_1+\mathfrak{b},\cdots,t_n+\mathfrak{b}\}$ generates $T/\mathfrak{b}$. Therefore we proved $T/\mathfrak{b}$ is a finitely generated $R/\mathfrak{a}$-module, which implies $\overline{\varphi}$ is finite.
    \item Regard $R,T$ as $R$-modules. Since the localization functor $S^{-1}:R\text{-}\mathsf{Mod}\to S^{-1}R\text{-}\mathsf{Mod}$ is exact, from the exact sequence in $R\text{-}\mathsf{Mod}$
    \[
    0\longrightarrow R\longrightarrow T
    \]
    we get the exact sequence in $S^{-1}R\text{-}\mathsf{Mod}$
    \[
    0\longrightarrow S^{-1}R\longrightarrow S^{-1}T.
    \]
    Note that the underlying sets of the $S^{-1}R$-module $S^{-1}T$ and the commutative ring $S^{-1}T$ coincide and the two algebraic structures on the same underlying set are compatible, which makes $S^{-1}T$ an $S^{-1}R$-algebra. 
    For any $\frac{a}{s}\in S^{-1}T$, there exists a monic polynomial
    \[
    f(x)=x^n+r_{n-1}x^{n-1}+\cdots+r_0\in R[x]
    \]
    such that 
    \[
        \leftindex^{\iota}\!f(a)=a^n+r_{n-1}a^{n-1}+\cdots+r_0=0_T.
    \]
    This equation can be rewritten as
    \[
\left(\frac{a}{s}\right)^n+\frac{r_{n-1}}{s}\left(\frac{a}{s}\right)^{n-1}+\cdots+\frac{r_0}{s^n}=0_{S^{-1}T},
    \]
    which implies $\frac{a}{s}$ is an integral element over $S^{-1}R$.
    

\end{enumerate}
\end{prf}



\begin{lemma}{Finite $\implies$ Integral}{}
    Let $\varphi:R\to S$ be a finite homomorphism between two commutative rings. Then $\varphi$ is integral.
\end{lemma}

\begin{proposition}{Equivalent Definition of Finite Ring Homomorphism}{}
    Let $\varphi:R\to S$ be a ring homomorphism between two commutative rings. The following are equivalent:
    \begin{enumerate}[(i)]
        \item $\varphi$ is finite.
        \item $\varphi$ is integral and of finite type.
        \item there exist $x_1,\cdots ,x_n\in S$ such that $S=R[x_1,\cdots ,x_n]$ and each $x_i$ is integral over $R$.
    \end{enumerate}
\end{proposition}

\section{Normal Ring}

Recall the remark in \Cref{th:integral_closure_in_field_of_fractions}.
\begin{definition}{Normal Domain}{normal_domain}
    Suppose $R$ is an integral domain, $\mathrm{Frac}(R)$ be a field of fractions and $l:R\hookrightarrow \mathrm{Frac}(R)$ is the localization map. $R$ is called \textbf{normal} or \textbf{integrally closed} if $l(R)$ equals the \hyperref[th:integral_closure]{integral closure} of $R$ in $\mathrm{Frac}(R)$.
\end{definition}

\begin{proposition}{Equivalent Definition of Normal Domain}{equivalent_definition_of_normal_domain}
    Let $R$ be an integral domain. The following are equivalent:
    \begin{enumerate}[(i)]
        \item $R$ is normal.
        \item For each $x\in \mathrm{Frac}(R)$ integral over $R$, $x\in l(R)$.
        \item For every prime ideal $\mathfrak{p}$ of $R$, the localization $R_\mathfrak{p}$ is normal.
        \item For every maximal ideal $\mathfrak{m}$ of $R$, the localization $R_\mathfrak{m}$ is normal.
    \end{enumerate}
\end{proposition}


\begin{proposition}{}{intersection_of_integral_closure_and_field_of_fractions}
    Suppose $A$ is integrally closed commutative ring with fraction field $K=\mathrm{Frac}(A)$ and $l:A\hookrightarrow K$ is the localization map. Let $\iota: K\hookrightarrow L$ be a finite field extension. If $B=\overline{A}^L$ is the integral closure of $A$ in $L$, then we have commutative diagram
    \[
        \begin{tikzcd}
                & K \arrow[rd, "\iota", hook]      &   \\
    A \arrow[ru, "l", hook] \arrow[rd, "u"', hook] &                                  & L \\
                & B \arrow[ru, "\subseteq"', hook] &  
        \end{tikzcd}
    \]
    and
    \[
    B\cap \iota(K)=\iota(l(A)).
    \]
    Especially, if we have $A\subseteq K\subseteq L$, then $B\cap K=A$.
\end{proposition}
\begin{prf}
    Since for any $a\in A$, there exists monic polynomial $f(x)=x-c\in A[x]$ such that $f(a)=0$, we have $\iota(l(A))\subseteq B$. Since $l(A)\subseteq K$, we have $\iota(l(A))\subseteq \iota(K)$, which implies $\iota(l(A)) \subseteq B\cap \iota(K)$. 

    For any $b\in B\cap \iota(K)$, since $B$ is the integral closure of $A$ in $L$, $b$ is integral over $A$. Since $\iota(K)$ is a field of fractions of $A$ with the localization map $\iota\circ l: A\hookrightarrow \iota(K)$, by the integral closed property of $A$, any integral element over $A$ in $\iota(K)$ must be in $\iota\circ l(A)$. Hence we have $b\in \iota\circ l(A)$, which implies $B\cap \iota(K)\subseteq \iota\circ l(A)$. Therefore, $B\cap \iota(K)=\iota\circ l(A)$.
\end{prf}

\begin{proposition}{}{}
    Let $\varphi: R\to S$ be a commutative ring homomorphism and $\overline{R}^S$ be the integral closure of $R$ in $S$. If $S$ is a normal integral domain, then $\overline{R}^S$ is a normal integral domain.
\end{proposition}
\begin{prf}
    Let $\overline{R}^S$ be the integral closure of $R$ in $S$. $\overline{R}^S$ is an integral domain because it is a subring of integral domain $S$. Suppose $\mathrm{Frac}\left(\overline{R}^S\right)$ is a field of fractions that contains $\overline{R}^S$ and $l:\overline{R}^S\hookrightarrow \mathrm{Frac}\left(\overline{R}^S\right)$ be the localization map. To show $\overline{R}^S$ is normal, by \Cref{th:equivalent_definition_of_normal_domain} it is sufficient to show that for each $x\in \mathrm{Frac}\left(\overline{R}^S\right)$ integral over $\overline{R}^S$, $x\in \overline{R}^S$. 
    
    Suppose $x\in \mathrm{Frac}\left(\overline{R}^S\right)$ is integral over $\overline{R}^S$. Let $\mathrm{Frac}\left(S\right)$ be a field of fractions that contains $S$. By the universal property of the field of fractions, there exists a unique ring homomorphism
    \begin{align*}
        \overline{\iota}:\mathrm{Frac}\left(\overline{R}^S\right)&\longrightarrow \mathrm{Frac}\left(S\right)\\
        \frac{a}{b}&\longmapsto \frac{a}{b}
    \end{align*}
    such that the following diagram commutes
    \[
        \begin{tikzcd}
            \overline{R}^S \arrow[r, "\iota", hook] \arrow[d, "l_1"', hook]                       & S \arrow[d, "l_2", hook] \\
            \mathrm{Frac}\left(\overline{R}^S\right) \arrow[r, "\overline{\iota}"', dashed, hook] & \mathrm{Frac}(S)        
            \end{tikzcd}
    \]
   Since $l_1$ and $l_2\circ \iota$ are injective, $\overline{\iota}$ is injective. According to \Cref{th:injective_ring_extension_preserves_integral_elements}, $\overline{\iota}(x)$ is integral over $\overline{R}^S$ through $\overline{\iota}\circ l_1$, namely  $\overline{\iota}(x)$ is integral over $\overline{R}^S$ through $l_2\circ \iota$. According to \Cref{th:descent_of_integrality_along_ring_homomorphisms}, $\overline{\iota}(x)$ is integral over $S$. Since $S$ is normal, $\overline{\iota}(x)\in S$. Since $\overline{R}^S$ is integral over $S$, we have $\overline{\iota}(x)$ is integral over $R$. Since $\overline{R}^S$ is the integral closure of $R$ in $S$, we have $\overline{\iota}(x)\in \overline{R}^S$. Therefore, $x\in \overline{R}^S$, which completes the proof.
\end{prf}

\begin{proposition}{Characterization of Integrality via Minimal Polynomials}{characterization_of_integrality_via_minimal_polynomials}
    Let $R$ be a normal integral domain and $K=\mathrm{Frac}(R)$ be a field of fractions of $R$ that contains $R$. If $L/K$ is a field extension, then $\alpha\in L$ is integral over $R$ if and only if the minimal polynomial of $\alpha$ over $K$ has coefficients in $R$.
\end{proposition}
\begin{prf}
    Suppose $\alpha\in L$ is integral over $R$. Then $\alpha\in L$ is algebraic over $K$. Let $f(X)=X^n+a_{n-1}X^{n-1}+\cdots+a_0\in K[X]$ be the minimal polynomial of $\alpha$ over $K$. Since $\alpha$ is integral over $R$, there exists a monic polynomial $g(X)=X^m+b_{m-1}X^{m-1}+\cdots+b_0\in R[X]$ such that $g(\alpha)=0$. By the definition of the minimal polynomial, $f(X)$ divides $g(X)$ in $K[X]$. Suppose $M=\overline{K(\alpha)}$ is an algebraic closure of $K(\alpha)$ such that $K(\alpha)\subseteq M$. Then $f$ splits into linear factors over $M$ as 
    \[
    f(X)=\prod_{i=1}^n (X-\alpha_i)\in M[X],
    \]
    with $\alpha=\alpha_k$ for some $k$. Thus we have $g\left(\alpha_i\right)=0$ for $i=1,\cdots,n$, which implies $\alpha_1,\cdots,\alpha_n$ are integral over $R$. By Vieta's formulas, $a_i$ is a symmetric polynomial of $\alpha_1,\cdots,\alpha_n$ for $i=1,\cdots,n$. Hence $a_i$ are also integral over $R$. Since $R$ is normal, we have $a_i\in R$ for $i=1,\cdots,n$, which implies $a \in R$.

    Conversely, suppose the minimal polynomial of $\alpha$ over $K$ has coefficients in $R$. Let $f(X)=X^n+a_{n-1}X^{n-1}+\cdots+a_0\in R[X]$ be the minimal polynomial of $\alpha$ over $K$. Since $f(\alpha)=0$, $\alpha$ is integral over $R$.
\end{prf}

\begin{definition}{Normal Ring}{}
    An commutative $R$ is called \textbf{normal} if for every prime ideal $\mathfrak{p}$ of $R$, the localization $R_\mathfrak{p}$ is a normal integral domain.
\end{definition}
\begin{proposition}{}{}
A normal ring is integrally closed in its total ring of fractions.
\end{proposition}

\section{Japanese Rings}
\begin{definition}{Japanese Ring}{}
    Let $R$ be an integral domain with field of fractions $K=\mathrm{Frac}(R)$.
    \begin{enumerate}[(i)]
        \item We say $R$ is \textbf{N-1} if the integral closure of $R$ in $K$ is a finitely generated $R$-module.
        \item We say $R$ is \textbf{N-2} or \textbf{Japanese} if for any finite extension $L/K$, the \hyperref[th:integral_closure]{integral closure} of $R$ in $L$ is finite over $R$.
    \end{enumerate}
\end{definition}
\begin{remark}
    By definition, a N-2 ring is N-1.
\end{remark}

\begin{proposition}{N-1 and N-2 are Preserved under Localization}{}
    Let $R$ be an integral domain and $S$ be a multiplicative set in $R$. If $R$ is N-1 (resp. N-2), then $S^{-1}R$ is N-1 (resp. N-2).
\end{proposition}

\begin{proposition}{}{}
    Let $R$ be a Noetherian normal domain with fraction field $K=\mathrm{Frac}(R)$. Let $L/K$ be a finite separable field extension. Then the integral closure of $R$ in $L$ is finite over $R$.
\end{proposition}

\begin{proposition}{}{}
    A Noetherian integral domain whose fraction field has characteristic zero is N-1 if and only if it is N-2.
\end{proposition}

\begin{example}{Examples of Japanese Rings}{examples_of_japanese_rings}
    The following types of rings are Nagata rings:
    \begin{itemize}
        \item Dedekind domains with fraction field of characteristic zero.
        \item $\mathbb{Z}$.
        \item Fields.
        \item Noetherian complete local integral domains.
        \item Polynomial rings over any of the above.
    \end{itemize}
\end{example}
\begin{prf}
    \Cref{th:properties_of_polynomial_ring} and \Cref{ex:examples_of_nagata_rings}.
\end{prf}

\begin{definition}{Nagata Ring}{}
    We say a commutative ring $R$ is a \textbf{Nagata ring} if $R$ is Noetherian and for every prime ideal $\mathfrak{p}$ of $R$, $R/\mathfrak{p}$ is a Japanese ring.
\end{definition}

\begin{definition}{Universally Japanese Ring}{}
    We say a commutative ring $R$ is \textbf{universally Japanese} if for any finite type ring homomorphism $R\to S$ with $S$ being an integral domain, $S$ is a Japanese ring.
\end{definition}

\begin{proposition}{Equivalent Characterization of Nagata Ring}{}
    Let $R$ be a Noetherian ring. The following are equivalent:
    \begin{enumerate}[(i)]
        \item $R$ is a Nagata ring.
        \item any finite type $R$-algebra is a Nagata ring.
        \item $R$ is Noetherian and universally Japanese.
    \end{enumerate}
\end{proposition}
\begin{corollary}{Nataga Domain is Japanese}{}
    Suppose $R$ is a Nagata ring. Then $R$ is a Japanese ring if and only if it is an integral domain.
\end{corollary}

\begin{example}{Examples of Nagata Rings}{examples_of_nagata_rings}
    The following types of rings are Nagata rings:
    \begin{itemize}
        \item Dedekind domains with fraction field of characteristic zero.
        \item $\mathbb{Z}$.
        \item Fields.
        \item Noetherian complete local rings.
        \item Finite type ring extensions of any of the above.
    \end{itemize}
\end{example}


\section{Krull Dimension}
\begin{definition}{Length of a Chain of Prime Ideals}{}
    Let $R$ be a commutative ring and $\mathfrak{p}_0\subsetneq\mathfrak{p}_1\subsetneq\cdots\subsetneq\mathfrak{p}_n$ be a chain of prime ideals of $R$. The \textbf{length} of the chain is defined to be $n$.
\end{definition}


\begin{definition}{Height of a Prime Ideal}{}
    Let $R$ be a commutative ring and $\mathfrak{p}$ be a prime ideal of $R$. The \textbf{height} of $\mathfrak{p}$ is defined to be the supremum of the lengths of all chains of prime ideals of $R$ contained in $\mathfrak{p}$
    \[
    \mathrm{ht}(\mathfrak{p})=\sup\left\{n\in\mathbb{N}\mid\exists\text{ a chain of prime ideals }\mathfrak{p}_0\subsetneq\mathfrak{p}_1\subsetneq\cdots\subsetneq\mathfrak{p}_n=\mathfrak{p}\right\}.
    \]
\end{definition}

\begin{definition}{Krull Dimension}{}
    Let $R$ be a commutative ring. The \textbf{Krull dimension} of $R$, denoted by $\dim R$, is defined to be the supremum of the heights of all prime ideals of $R$
    \[
    \dim R=\sup\left\{\mathrm{ht}(\mathfrak{p})\mid\mathfrak{p}\in \mathrm{Spec}(R)\right\}= \sup\left\{\mathrm{ht}(\mathfrak{m})\mid\mathfrak{m}\text{ is a maximal ideal of }R\right\}.
    \]
\end{definition}

\begin{proposition}{}{}
    Let $R$ be a commutative ring and $\mathfrak{p}$ be a prime ideal of $R$. Then 
    \[
    \operatorname{ht}\left(\mathfrak{p}\right) = \dim R_{\mathfrak{p}}.
    \]
\end{proposition}
\begin{proof}
    Let $\mathfrak{p}_0\subsetneq\mathfrak{p}_1\subsetneq\cdots\subsetneq\mathfrak{p}_n=\mathfrak{p}$ be a chain of prime ideals of $R$. Since $R_{\mathfrak{p}}$ is a local ring, $\mathfrak{p}R_{\mathfrak{p}}$ is the unique maximal ideal of $R_{\mathfrak{p}}$. Then we have a chain of prime ideals of $R_{\mathfrak{p}}$
    \[
    \mathfrak{p}_0R_{\mathfrak{p}}\subsetneq\mathfrak{p}_1R_{\mathfrak{p}}\subsetneq\cdots\subsetneq\mathfrak{p}_nR_{\mathfrak{p}}=\mathfrak{p}R_{\mathfrak{p}}.
    \]
     That implies $\dim R_{\mathfrak{p}}\geq n$. Since the chain is arbitrary, we have $\dim R_{\mathfrak{p}}\geq \mathrm{ht}(\mathfrak{p})$. 
    
    On the other hand, any prime ideal of $R_{\mathfrak{p}}$ is of the form $\mathfrak{q}R_{\mathfrak{p}}$ for some prime ideal $\mathfrak{q}$ of $R$ such that $\mathfrak{q}\subseteq\mathfrak{p}\ne \varnothing$. Suppose $\dim R_{\mathfrak{p}}=m$ and 
    \[
    \mathfrak{q}_0R_{\mathfrak{p}}\subsetneq\mathfrak{q}_1R_{\mathfrak{p}}\subsetneq\cdots\subsetneq\mathfrak{q}_{m-1}R_{\mathfrak{p}}\subsetneq\mathfrak{p}R_{\mathfrak{p}}
    \]
    is a chain of prime ideals of $R_{\mathfrak{p}}$. Then we have a chain of prime ideals of $R$
    \[
    \mathfrak{q}_0\subsetneq\mathfrak{q}_1\subsetneq\cdots\subsetneq\mathfrak{q}_{m-1}\subsetneq\mathfrak{p}
    \]
   That implies $\mathrm{ht}(\mathfrak{p})\geq m = \dim R_{\mathfrak{p}}$. Thus we have $\dim R_{\mathfrak{p}}= \mathrm{ht}(\mathfrak{p})$.
\end{proof}

\subsection{Noetherian Local Rings}

\begin{definition}{Ideal of Definition}{}
Let $(R,\mathfrak{m})$ be a \hyperlink{th:Noetherian_commutative_ring}{Noetherian} local commutative ring. An \textbf{ideal of definition} of $R$ is an ideal $\mathfrak{a}$ of $R$ such that $\sqrt{\mathfrak{a}}=\mathfrak{m}$.
\end{definition}


\begin{proposition}{Krull Dimension of Noetherian Local Rings}{}
    Let $R$ be a Noetherian local commutative ring and $d\ge 0$ be an integer. Then the following statements are equivalent:
    \begin{enumerate}[(i)]
        \item $\dim R=d$.
        \item There exists an ideal of definition $\mathfrak{a}=(a_1,\cdots,a_d)$ of $R$, and no ideal of definition of $R$ is generated by fewer than $d$ elements.
    \end{enumerate}
\end{proposition}

\begin{definition}{System of Parameters}{}
    Let $(R,\mathfrak{m})$ be a Noetherian local commutative ring. A \textbf{system of parameters} of $R$ is a sequence of elements $a_1,\cdots,a_d\in \mathfrak{m}$ such that 
    \[
    \sqrt{(a_1,\cdots,a_d)}=\mathfrak{m},
    \]
    that is, $(a_1,\cdots,a_d)$ is an ideal of definition of $R$.
\end{definition}

\begin{definition}{Regular Local Ring}{}
    Let $(R,\mathfrak{m})$ be a Noetherian local commutative ring of dimension $d$. $R$ is called a \textbf{regular local ring} if there $a_1,\cdots,a_d\in \mathfrak{m}$ such that $(a_1,\cdots,a_d)=\mathfrak{m}$. In this case, $a_1,\cdots,a_d$ is called a \textbf{regular system of parameters} of $R$.
    
\end{definition}

A regular local ring is a field if and only if it has Krull dimension $0$. A regular local ring is a DVR if and only if it has Krull dimension $1$.

\begin{definition}{Regular Ring}{}
    Let $R$ be a commutative ring. $R$ is called a \textbf{regular ring} if $R$ is a Noetherian ring and for every prime ideal $\mathfrak{p}$ of $R$, the localization $R_{\mathfrak{p}}$ is a regular local ring.
    
\end{definition}

\subsection{Artinian Rings}
\begin{definition}{Artinian Ring}{artinian_ring}
    A commutative ring $R$ is called \textbf{Artinian} if $R$ satisfies the descending chain condition for ideals: for every chain of ideals
    \[
    \mathfrak{a}_1\supseteq\mathfrak{a}_2\supseteq\mathfrak{a}_3\supseteq\cdots
    \]
    there exists an integer $n$ such that $\mathfrak{a}_n=\mathfrak{a}_{n+1}=\cdots$.
\end{definition}

\begin{proposition}{Equivalent Characterization of Artinian Rings}{equivalent_characterization_of_artinian_rings}
    Let $R$ be a Noetherian commutative ring. The following are equivalent:
    \begin{enumerate}[(i)]
        \item $R$ is Artinian.
        \item $R$ has Krull dimension $0$.
        \item $\operatorname{Spec}(R)$ is discrete and finite.
        \item $\operatorname{Spec}(R)$ is finite.
        \item $R$ is a finite product of Artinian local commutative rings.
    \end{enumerate}

\end{proposition}

\begin{proposition}{Artinian Integral Domain is a Field}{artinian_integral_domain_is_a_field}
    Let $R$ be an Artinian ring. Then $R$ is a field if and only if $R$ is an integral domain.
\end{proposition}
\begin{proof}
    Suppose $R$ is an Artinian integral domain. Suppose $a\in R-\{0\}$ is any nonzero element of $R$. Then the chain of ideals
    \[
    (a)\supseteq (a^2)\supseteq (a^3)\supseteq\cdots
    \]
    must stabilize at some point, say $(a^n)=(a^{n+1})=\cdots$. Therefore, there exists $r\in R$ such that $a^n=ra^{n+1}$. Since $R$ is an integral domain, we have $a^n\ne0$ and $1=ra$. Thus $a \in R^\times$. This implies $R$ is a field.
\end{proof}

\section{Dedekind Domain}

\begin{definition}{Fractional Ideal}{}
    Let $R$ be an integral domain. A \textbf{fractional ideal} of $R$ is an $R$-submodule $I$ of $\mathrm{Frac}(R)$ such that there exists a nonzero $r\in R$ such that $rI\subseteq R$.
\end{definition}

\begin{proposition}{Equivalent Characterization of Fractional Ideal}{}
    Let $R$ be an integral domain and $I$ be a subset of $K:=\mathrm{Frac}(R)$. The following are equivalent:
    \begin{enumerate}[(i)]
        \item $I$ is a fractional ideal of $R$.
        \item there exists a nonzero $r\in R$ and an ideal $J$ such that $I=r^{-1}J$.
    \end{enumerate}
\end{proposition}
\begin{prf}
    \begin{enumerate}[(i)]
        \item $\implies$ (ii). Suppose $I$ is a fractional ideal of $R$. Then there exists a nonzero $r\in R$ such that $rI\subseteq R$. Let $J=r I$. Since $rI=(r)I$, $J$ is also an ideal of $R$. And by \Cref{th:inverse_inclusion_under_scalar_multiplication} we have $I=(r^{-1}r)I=r^{-1}J$.
        \item $\implies$ (i). Suppose there exists a nonzero $r\in R$ and an ideal $J$ such that $I=r^{-1}J$. By \Cref{th:module_homomorphism_induced_by_scalar_multiplication} we see $r^{-1}J$ is an $R$-submodule of $K$. Since $rI=r(r^{-1}J)=J\subseteq R$, $I$ is a fractional ideal of $R$.
    \end{enumerate}
\end{prf}

\begin{definition}{Dedekind Domain}{}
    An integral domain $R$ is called a \textbf{Dedekind domain} if every nonzero ideal $I$ of $R$ can be written as a product of prime ideals of $R$
    \[
    I=\mathfrak{p}_1\cdots\mathfrak{p}_r
    \]
    uniquely up to permutation of the $\mathfrak{p}_i$.
\end{definition}

\begin{proposition}{Equivalent Definition of Dedekind Domain}{equivalent_definition_of_dedekind_domain}
    Let $R$ be a commutative ring. The following are equivalent:
    \begin{enumerate}[(i)]
        \item $R$ is a Dedekind domain.
        \item $R$ is Noetherian domain and for every nonzero maximal ideal $\mathfrak{m}$ of $R$, the localization $R_{\mathfrak{m}}$ is a DVR.
        \item $R$ a Noetherian, normal domain, and $\dim R\le 1$.
        \item Every non-zero fractional ideal of $R$ is invertible.
        \item For any two ideals $I$ and $J$, 
         \[
         I \subseteq J \iff J\text{ divides } I.
         \]
         Here $J$ divides $I$ means there exists an ideal $H$ such that $I=JH$.
    \end{enumerate}
    
\end{proposition}

\begin{corollary}{Containment and Divisibility of Prime Powers}{containment_and_divisibility_of_prime_powers}
    Let $R$ be a Dedekind domain, $\mathfrak{p}$ be a nonzero prime ideal of $R$ and $n\in\mathbb{Z}_{\ge 1}$. If $I$ is a ideal Then we have
    \[
    \mathfrak{p}^n\subseteq I \iff I = \mathfrak{p}^m\text{ for some }0\le m \le n
    \]
    and
    \[
    I \subseteq\mathfrak{p}^n \iff I = \mathfrak{p}^m\text{ for some } m \ge n.
    \]
    Here $\mathfrak{p}^0:=(1_R)=R$.
\end{corollary}
\begin{prf}
    Suppose $\mathfrak{p}^n\subseteq I$. By \Cref{th:equivalent_definition_of_dedekind_domain} we have
    \[
    \mathfrak{p}^n = IJ 
    \]
    for some ideal $J$. Suppose $I$ and $J$ has prime ideal factorization, 
    \[
    I= \mathfrak{a}_1^{e_1}\cdots \mathfrak{a}_r^{e_r}
    \]
    \[
    J= \mathfrak{b}_1^{v_1}\cdots \mathfrak{b}_s^{v_s}
    \]
    By the uniqueness of prime ideal factorization, we have $r=s=1$, $\mathfrak{a}_1=\mathfrak{b}_1=\mathfrak{p}$. Thus
    \[
    \mathfrak{p}^n=\mathfrak{p}^{e_1}\mathfrak{p}^{v_1}=\mathfrak{p}^{e_1+v_1}\implies n=e_1+v_1\implies 0\le e_1 \le n.
    \]
\end{prf}

\begin{proposition}{Properties of Dedekind Domains}{properties_of_dedekind_domains}
    Let $R$ be a Dedekind domain.   
    \begin{enumerate}[(i)]
        \item Every nonzero prime ideal of $R$ is maximal.
        \item If $\mathfrak{p}$ is a maximal ideal of $R$, then $\mathfrak{p}^{n}/\mathfrak{p}^{n+1}$ is 1-dimensional $R/\mathfrak{p}$-vector space.
    \end{enumerate}
\end{proposition}
\begin{prf}
    \begin{enumerate}[(i)]
        \item Suppose $\mathfrak{p}$ is a nonzero prime ideal of $R$, In an integral domain, $(0)$ is a prime ideal, and we have chain of ideals
        \[
        (0)\subseteq \mathfrak{p}.
        \]
        Since the Krull dimension of $R$ is at most $1$, there is no prime ideal strictly between $(0)$ and $\mathfrak{p}$. Thus $\mathfrak{p}$ is maximal.
        \item Since $\mathfrak{p}^{n+1}$ is an $R$-submodule of $\mathfrak{p}^n$, the quotient module $\mathfrak{p}^n/\mathfrak{p}^{n+1}$ is an $R$-module. We need to show that $\mathfrak{p}^n/\mathfrak{p}^{n+1}$ is an $R/\mathfrak{p}$-module.
        
        For any $a\in \mathfrak{p}$ and $x+\mathfrak{p}^{n+1}\in \mathfrak{p}^n/\mathfrak{p}^{n+1}$, we have
        \[
        a\left(x+\mathfrak{p}^{n+1}\right) = ax + \mathfrak{p}^{n+1} = 0+\mathfrak{p}^{n+1},
        \]
        which implies
        \[
        \mathfrak{p}\subseteq \mathrm{Ann}_R\left(\mathfrak{p}^n/\mathfrak{p}^{n+1}\right).
        \]
        Thus according to \Cref{th:annihilator_and_induced_module_structures}, $\mathfrak{p}^n/\mathfrak{p}^{n+1}$ is an $R/\mathfrak{p}$-module. Since $R/\mathfrak{p}$ is a field, $\mathfrak{p}^n/\mathfrak{p}^{n+1}$ is an $R/\mathfrak{p}$-vector space. Let $W\subseteq \mathfrak{p}^n/\mathfrak{p}^{n+1}$ be any $R/\mathfrak{p}$-subspace. $W$ is also an $R$-submodule of $\mathfrak{p}^n/\mathfrak{p}^{n+1}$. Since we have the following bijection of sets
        \begin{align*}
       &\left\{W\midv W \text{ is an }R\text{-submodules of }\mathfrak{p}^n/\mathfrak{p}^{n+1}\right\}  \\
       \longleftrightarrow & \left\{V\midv V \text{ is an }R\text{-submodules of }\mathfrak{p}^n \text{ and }\mathfrak{p}^{n+1}\subseteq V\right\} \\
       \longleftrightarrow & \left\{V\midv V \text{ is an }R\text{-submodules of }R\text{ and }\mathfrak{p}^{n+1}\subseteq V\subseteq \mathfrak{p}^{n}\right\} \\
       \longleftrightarrow& \left\{I\mid I \text{ is an ideal of }R\text{ and }\mathfrak{p}^{n+1}\subseteq I \subseteq \mathfrak{p}^n\right\} 
        \end{align*}
        $W$ corresponds to an ideal $I$ of $R$ such that $\mathfrak{p}^{n+1}\subseteq I \subseteq \mathfrak{p}^n$. By the \Cref{th:containment_and_divisibility_of_prime_powers}, we have $I=\mathfrak{p}^n$ or $I=\mathfrak{p}^{n+1}$. Thus $W=\mathfrak{p}^n/\mathfrak{p}^{n+1}$ or $W=0$. This implies that $\mathfrak{p}^n/\mathfrak{p}^{n+1}$ is a 1-dimensional $R/\mathfrak{p}$-vector space.
    \end{enumerate}
\end{prf}

\subsection{Extensions of Dedekind Domains}
\begin{theorem}{Krull-Akizuki Theorem}{krull_akizuki}
    Let $\mathcalo$ be a one-dimensional Noetherian
    integral domain and $K=\mathrm{Frac}(\mathcalo)$ be its field of fractions. Let $L/K$ be a finite field extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Then $\mathcal{O}$ is a Dedekind domain.
\end{theorem}
\begin{prf}
    We can prove that $\mathcal{O}$ is integrally closed and that every nonzero prime ideal is maximal. It remains to show that $\mathcal{O}$ is Noetherian. Let $\omega_1, \ldots, \omega_n$ be a basis of $L/K$ which is contained in $\mathcal{O}$. Then the ring $\mathcal{O}_0=\mathcal{O}\left[\omega_1, \ldots, \omega_n\right]$ is a finitely generated $\mathcal{O}$-module and in particular is Noetherian since $\mathcal{O}$ is Noetherian. We argue as before that $\mathcal{O}_0$ is one-dimensional and are thus reduced to the case $L=K$. So let $\mathfrak{A}$ be an ideal of $\mathcal{O}$ and $a \in \mathfrak{A} \cap \mathcal{O}, a \neq 0$; then by the above lemma $\mathcal{O} / a \mathcal{O}$ is a finitely generated $\mathcal{O}$-module. Since $\mathcal{O}$ is Noetherian, so is the $\mathcal{O}$-submodule $\mathfrak{A} / a \mathcal{O}$, and also the $\mathcal{O}$-module $\mathfrak{A}$.
\end{prf}


\begin{proposition}{}{}
    Let $\mathcalo$ be a Dedekind domain and $K=\mathrm{Frac}(\mathcalo)$ be its field of fractions. Let $L/K$ be a finite field extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. If $\mathfrak{p}$ is a prime ideal of $\mathcalo$, then $\mathfrak{p}\mathcal{O}\ne \mathcal{O}$, where $\mathfrak{p}\mathcal{O}$ is the ideal of $\mathcal{O}$ generated by $\mathfrak{p}$.
    
    Therefore, if $\mathfrak{p}\ne (0)$, then $\mathfrak{p}\mathcal{O}$ can be factored into a product of prime ideals of $\mathcal{O}$ in a unique way 
    \[
    \mathfrak{p}\mathcal{O}=\mathfrak{P}_1^{e_1}\cdots\mathfrak{P}_r^{e_r},
    \]
    where $\mathfrak{P}_i$ are prime ideals of $\mathcal{O}$. Moreover, $\mathfrak{P}_i$ are exactly those prime ideals of $\mathcal{O}$ \hyperref[th:lying_over_and_going_up_properties]{lying over $\mathfrak{p}$}. 
\end{proposition}
\begin{remark}
    In other words, $\mathfrak{P}_i$ are exactly those prime ideals in $\mathrm{Spec}\left(\mathcal{O}\right)$ such that $\iota^{-1}\left(\mathfrak{P}_i\right)=\mathfrak{p}$, where $\iota:\mathcalo\hookrightarrow \mathcal{O}$ is the embedding. Consider the morphism of affine schemes $\iota^{-1}:\mathrm{Spec}\left(\mathcal{O}\right)\to \mathrm{Spec}\left(\mathcalo\right)$. By \Cref{th:surjectivity_of_spectrum_map_of_integral_extension} we see $\iota^{-1}$ is surjective as a map between the underlying sets. This is equivalent to say the fiber over $\mathfrak{p}$ is $\left\{\mathfrak{P}_1,\cdots, \mathfrak{P}_n\right\}$.
\end{remark}
\begin{prf}
    Since $\mathcalo \subseteq \mathcal{O}$ is an integral extension, by the \hyperref[th:going_up_and_going_down_theorems]{going-up theorem}, if $\mathfrak{p}$ is a prime ideal of $\mathcalo$, then there exists a prime ideal $\mathfrak{P}$ of $\mathcal{O}$ such that $\mathfrak{P}\cap \mathcalo=\mathfrak{p}$. Thus we have 
    \[
    \mathfrak{p}\mathcal{O}\subseteq \mathfrak{P} \mathcal{O}= \mathfrak{P} \subsetneq \mathcal{O}.
    \]
    By \Cref{th:krull_akizuki}, $\mathcal{O}$ is a Dedekind domain. If $\mathfrak{p}\ne 0$, $\mathfrak{p}\mathcal{O}$ is a nonzero proper ideal of $\mathcal{O}$ and $\mathfrak{p}\mathcal{O}$ is a product of prime ideals of $\mathcal{O}$
    \[
    \mathfrak{p}\mathcal{O}=\mathfrak{P}_1^{e_1}\cdots\mathfrak{P}_r^{e_r}.
    \] 
    Since we have
    \[
        \mathfrak{p}\subseteq \mathfrak{p}\mathcal{O} \subseteq \mathfrak{P}_k
    \]
    for $1\le k\le r$, we have $\mathfrak{p}\subseteq \mathfrak{P}_k\cap \mathcalo$ for $1\le k\le r$. From \Cref{th:contraction_of_prime_ideal_is_prime} we see $\mathfrak{P}_k\cap \mathcalo$ are prime ideals of $\mathcalo$. Since nonzero prime ideals of $\mathcalo$ are maximal, we have $\mathfrak{P}_k\cap \mathcalo=\mathfrak{p}$ for $1\le k\le r$. Thus $\mathfrak{P}_k$ are prime ideals of $\mathcal{O}$ lying over $\mathfrak{p}$.

    Conversely, if $\mathfrak{q}$ is any prime ideal of $\mathcal{O}$ lying over $\mathfrak{p}$, then $\mathfrak{q}\cap \mathcalo=\mathfrak{p}$, which implies 
    \[
        \mathfrak{P}_1^{e_1}\cdots\mathfrak{P}_r^{e_r}=\mathfrak{p}\mathcal{O}\subseteq \mathfrak{q} \mathcal{O}=\mathfrak{q}.
    \]
    According to \Cref{th:prime_ideal_contains_product_iff_contains_at_least_one_factor}, there exists some $1\le k\le r$ such that $\mathfrak{P}_k\subseteq \mathfrak{q}$. Since $\mathfrak{P}_k$ is maximal, we have $\mathfrak{q}=\mathfrak{P}_k$. 
\end{prf}

\begin{definition}{Ramification Index}{}
    Let $\mathcalo$ be a Dedekind domain and $K=\mathrm{Frac}(\mathcalo)$ be its field of fractions. Let $L/K$ be a finite field extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Suppose $\mathfrak{p}$ is a nonzero prime ideal of $\mathcalo$, and $\mathfrak{p}\mathcal{O}$ can be factored into a product of prime ideals of $\mathcal{O}$ 
    \[
    \mathfrak{p}\mathcal{O}=\mathfrak{P}_1^{e_1}\cdots\mathfrak{P}_r^{e_r},
    \]
    then $e_i$ is called the \textbf{ramification index} of $\mathfrak{P}_i$ over $\mathfrak{p}$. For each $1\le m\le r$, 
    we have a canonical field extension 
    \begin{align*}
        \mathcalo/\mathfrak{p}&\hookrightarrow \mathcal{O}/\mathfrak{P}_m\\
        a+\mathfrak{p}&\mapsto a+\mathfrak{P}_m.
    \end{align*}
    Let $\kappa(\mathfrak{p})=\mathcalo/\mathfrak{p}$, $\kappa(\mathfrak{P}_m)=\mathcal{O}/\mathfrak{P}_m$. The degree of the field extension $\kappa(\mathfrak{P}_m)/\kappa(\mathfrak{p})$ is called the \textbf{inertia degree} of $\mathfrak{P}_m$ over $\mathfrak{p}$, denoted by 
    \[
    f_m=[\kappa(\mathfrak{P}_m):\kappa(\mathfrak{p})]=[\mathcal{O}/\mathfrak{P}_m:\mathcalo/\mathfrak{p}].
    \]
    \begin{itemize}
        \item The prime ideal $\mathfrak{P}_m$ is called \textbf{unramified over $\mathcalo$} if $e_m=1$ and the field extension $\mathcalo/\mathfrak{p}\hookrightarrow \mathcal{O}/\mathfrak{P}_m$ is separable.
        \item The prime ideal $\mathfrak{P}_m$ is called \textbf{ramified over $\mathcalo$} if it is not unramified.
        \item The prime ideal $\mathfrak{P}_m$ is called \textbf{totally ramified over $\mathcalo$} if it is ramified and $f_m=1$.
        \item The prime ideal $\mathfrak{p}$ is called \textbf{unramified in $L$} if all $\mathfrak{P}_m$ are unramified.
        \item The prime ideal $\mathfrak{p}$ is called \textbf{ramified in $L$} if it is not unramified in $L$.
        \item The field extension $L/K$ is called \textbf{unramified} if all prime ideals of $\mathcalo$ are unramified in $L$.
    \end{itemize}
\end{definition}
\begin{remark}
    By \Cref{th:quotient_and_localization_respect_finiteness}, if $\mathcalo\hookrightarrow \mathcal{O}$ is a finite ring homomorphism, then $\kappa(\mathfrak{P}_m)/\kappa(\mathfrak{p})$ is a finite field extension.
\end{remark}
\begin{prf}
    By the \hyperref[th:universal_property_of_quotient_ring]{universal property of quotient ring}, since 
    \[
    \ker \left( \pi_k\circ \iota\right)=\iota^{-1}(\mathfrak{P}_k)=\mathfrak{P}_k \cap \mathcalo=\mathfrak{p},
    \]
    there exists a unique ring homomorphism $\mathcalo/\mathfrak{p}\to \mathcal{O}/\mathfrak{P}_k$ such that the following diagram commutes
    \[
        \begin{tikzcd}
            \mathcalo \arrow[r, "\iota", hook] \arrow[d, two heads] & \mathcal{O} \arrow[d, "\pi_k", two heads] \\
            \mathcalo/\mathfrak{p} \arrow[r, dashed]                & \mathcal{O}/\mathfrak{P}_k               
            \end{tikzcd}
    \]
    Since both $\mathcalo/\mathfrak{p}$ and $\mathcal{O}/\mathfrak{P}_k$ are fields, $\mathcalo/\mathfrak{p}\to \mathcal{O}/\mathfrak{P}_k$ is a field extension. 
\end{prf}


\begin{proposition}{Fundamental Identity}{}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite separable field extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Suppose $\mathfrak{p}$ is a nonzero prime ideal of $\mathcalo$, and $\mathfrak{p}\mathcal{O}$ can be factored into a product of prime ideals of $\mathcal{O}$ 
    \[
    \mathfrak{p}\mathcal{O}=\mathfrak{P}_1^{e_1}\cdots\mathfrak{P}_r^{e_r},
    \]
    then we have the fundamental identity
    \[
    \sum_{i=1}^r e_i f_i=[L:K].
    \]
 
\end{proposition}
\begin{definition}{Split Completely}{}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite separable field extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Suppose $\mathfrak{p}$ is a nonzero prime ideal of $\mathcalo$, and $\mathfrak{p}\mathcal{O}$ can be factored into a product of prime ideals of $\mathcal{O}$ 
    \[
    \mathfrak{p}\mathcal{O}=\mathfrak{P}_1^{e_1}\cdots\mathfrak{P}_r^{e_r}.
    \]
    \begin{itemize}
        \item $\mathfrak{p}$ is said to \textbf{split completely in $L$} if $[L:K]=r$, or equivalently, $e_m=1$ and $f_m=1$ for all $m = 1,\cdots,r$.
        \item $\mathfrak{p}$ is called \textbf{nonsplit in $L$} if $r=1$.
        \item $\mathfrak{p}$ is called \textbf{inert in $L$} if $r=e_1=1$.
    \end{itemize}
    
\end{definition}


\begin{proposition}{}{}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite separable field extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Then there are only finitely many prime
    ideals of $\mathcalo$ which are ramified in $L$.
\end{proposition}

\subsection{Ramification Theory}
\begin{lemma}{Galois Group Maps Integral Elements to Integral Elements}{galois_group_maps_integral_elements_to_integral_elements}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. For any $\sigma\in \mathrm{Gal}(L/K)$, we have $\sigma(\mathcal{O})\subseteq \mathcal{O}$.
\end{lemma}
\begin{prf}
    Take any $\alpha\in \mathcal{O}$, $\alpha$ is integral over $\mathcalo$. So there exists a monic polynomial $f(x)\in \mathcalo[x]$ such that $f(\alpha)=0$. Since $\sigma$ is a ring homomorphism, we have
    \[
        f(\sigma(\alpha))=\sigma(f(\alpha))=\sigma(0)=0.
    \]
    Thus $\sigma(\alpha)$ is integral over $\mathcalo$, which means $\sigma(\alpha)\in \mathcal{O}$.
\end{prf}

\begin{proposition}{Galois Group Acts on $\mathcal{O}$}{galois_group_acts_on_integral_closure}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Then the Galois group $G:=\mathrm{Gal}(L/K)$ acts on $\mathcal{O}$ through the following group homomorphism
    \begin{align*}
        \mathrm{Gal}(L/K)&\longrightarrow \mathrm{Aut}_{\mathcalo\text{-}\mathsf{Alg}}\left(\mathcal{O}\right)\\
        \sigma&\longmapsto \sigma|_{\mathcal{O}},
    \end{align*}
    which makes $\mathcal{O}$ an $\mathcalo[G]$-module.
\end{proposition}
\begin{prf}
    For any $\sigma\in \mathrm{Gal}(L/K)$, we have $\sigma(\mathcal{O})\subseteq \mathcal{O}$ and $ \sigma^{-1}(\mathcal{O})\subseteq \mathcal{O}$ by the \Cref{th:galois_group_maps_integral_elements_to_integral_elements}. Thus $\mathcal{O}= \sigma(\sigma^{-1}(\mathcal{O}))\subseteq \sigma(\mathcal{O})$, which implies $\sigma(\mathcal{O})=\mathcal{O}$. Since $\sigma$ is an $\mathcalo$-algebra automorphism of $L$, $\sigma|_{\mathcal{O}}$ is an $\mathcalo$-algebra ring automorphism of $\mathcal{O}$. Suppose $\iota:\mathcal{O}\hookrightarrow L$ is the inclusion map. For any $\sigma,\tau\in \mathrm{Gal}(L/K)$, we have
    \[
        (\sigma\circ \tau)|_{\mathcal{O}}=\sigma\circ \tau\circ \iota=\sigma|_{\mathcal{O}} \circ \tau\circ \iota =\sigma|_{\mathcal{O}}\circ \tau|_{\mathcal{O}},
    \]
    which means the map is a group homomorphism.
\end{prf}

\begin{lemma}{Prime Avoidance Lemma}{prime_avoidance_lemma}
    Let $R$ be a commutative ring and $\mathfrak{p}_1,\cdots,\mathfrak{p}_n$ be ideals of $R$. Suppose $E$ is a additive subgroup of $R$ such that for any $x,y \in E$, $xy \in E$. If
    \begin{enumerate}[(i)]
        \item all but two of $\mathfrak{p}_1$ are prime ideals of $R$,
        \item $E \not\subseteq \mathfrak{p}_m$ for $1\le m\le n$,
    \end{enumerate}
    then we have 
    \[
    E \not\subseteq \bigcup_{m=1}^n \mathfrak{p}_m,
    \]
    which means there exists $x\in E$ such that $x\notin \mathfrak{p}_m$ for any $m=1,\cdots,n$.
\end{lemma}

Since we have category isomorphism
\[
\mathcalo \text{-}\mathsf{CAlg}\cong \mathcalo \text{-}\mathsf{AffSch}^{\mathrm{op}},
\]
we can also view the action of $\mathrm{Gal}(L/K)$ on $\mathcal{O}$ as an action on $\operatorname{Spec}\left(\mathcal{O}\right)$.

\begin{proposition}{Galois Group Acts on $\operatorname{Spec}\left(\mathcal{O}\right)$}{galois_group_acts_on_spectrum_of_integral_closure}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Then the Galois group $\mathrm{Gal}(L/K)$ acts on $\operatorname{Spec}\left(\mathcal{O}\right)$ through the following group homomorphism
    \begin{align*}
        \mathrm{Gal}(L/K)&\longrightarrow \mathrm{Aut}_{\mathcalo \text{-}\mathsf{AffSch}}\left(\operatorname{Spec}\left(\mathcal{O}\right)\right)\\
        \sigma&\longmapsto \left(\mathfrak{P}\longmapsto\sigma\left(\mathfrak{P}\right)\right)
    \end{align*}
    The orbits of this action are the prime ideals of $\mathcal{O}$ lying over the same prime ideal $\mathfrak{p}$ of $\mathcalo$. This means the action is transitive on all prime ideals of $\mathcal{O}$ lying over the same prime ideal $\mathfrak{p}\in \spec(\mathcalo)$.
\end{proposition}
\begin{prf}
For any $\sigma,\tau\in \mathrm{Gal}(L/K)$ and any prime ideal $\mathfrak{P}$ of $\mathcal{O}$, we have
\[
    \sigma\left(\tau\left(\mathfrak{P}\right)\right)=\left(\sigma\circ \tau\right)\left(\mathfrak{P}\right),
\]
which means the map is a group homomorphism. If $\mathfrak{P}$ is a prime ideal of $\mathcal{O}$ lying over a prime ideal $\mathfrak{p}$ of $\mathcalo$, then by \Cref{th:image_preimage_laws} we have
\[
\sigma\left(\mathfrak{P}\right)\cap \mathcalo=\sigma\left(\mathfrak{P}\right)\cap \sigma\left(\mathcalo\right)=\sigma\left(\mathfrak{P}\cap \mathcalo\right)=\sigma\left(\mathfrak{p}\right)=\mathfrak{p},
\]
which means each orbit of this action can only contain prime ideals of $\mathcal{O}$ lying over the same prime ideal $\mathfrak{p}$ of $\mathcalo$.

Use the \hyperref[th:going_up_and_going_down_theorems]{incomparability property} of integral extensions, we see $(0)$ is the only prime ideal of $\mathcal{O}$ lying over $(0)$. Thus the action of $\mathrm{Gal}(L/K)$ on $(0)$ is trivial.

Every nonzero prime ideal of a Dedekind domain is a maximal ideal. Let $\mathfrak{P}$ and $\mathfrak{P}^\prime$ be maximal ideals of $\mathcal{O}$ lying over maximal ideal $\mathfrak{p}\in\spec \mathcalo$. Suppose $\mathfrak{P}$ and $\mathfrak{P}^\prime$ are not in the same orbit. Then for any $\sigma\in \mathrm{Gal}(L/K)$, we have $\sigma(\mathfrak{P})\ne \mathfrak{P}^\prime$. Note ring isomorphism maps maximal ideals to maximal ideals. By maximality of $\sigma(\mathfrak{P})$, we have $\mathfrak{P}'\not\subseteq \sigma(\mathfrak{P})$ for all $\sigma\in\mathrm{Gal}(L/K)$. By the \Cref{th:prime_avoidance_lemma}, there exists $x\in \mathfrak{P}'$ such that $x\notin \sigma(\mathfrak{P})$ for all $\sigma\in\mathrm{Gal}(L/K)$. 

Since $\mathrm{id}\in \mathrm{Gal}(L/K)$,
\[
N_{L/K}(x)=\prod_{\sigma\in \mathrm{Gal}(L/K)}\sigma(x)=x \prod_{\sigma\in \mathrm{Gal}(L/K)-\{\mathrm{id}\}}\sigma(x)\in \mathfrak{P}'.
\]
By the property of norm we see $N_{L/K}(x) \in K$. Since Dedekind domains are integral closed, by \Cref{th:intersection_of_integral_closure_and_field_of_fractions} we have $\mathcal{O}\cap K=\mathcalo$. Combining with $\mathfrak{P}'\subseteq \mathcal{O}$ we get $N_{L/K}(x)\in \mathcal{O}\cap K=\mathcalo$. Hence we get 
\[
    N_{L/K}(x)\in \mathfrak{P}' \cap \mathcalo =\mathfrak{p}\subseteq \mathfrak{P}.
\]
Since $\mathfrak{P}$ is a prime ideal, there exists some $\tau\in \mathrm{Gal}(L/K)$ such that $\tau(x)\in \mathfrak{P}$, which means $x\in \tau^{-1}(\mathfrak{P})$. This contradicts the fact that $x\notin \sigma(\mathfrak{P})$ for all $\sigma\in\mathrm{Gal}(L/K)$. Thus $\mathfrak{P}$ and $\mathfrak{P}^\prime$ are in the same orbit.
\end{prf}

\begin{definition}{Decomposition Group}{}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. According to \Cref{th:galois_group_acts_on_spectrum_of_integral_closure}, the Galois group $\mathrm{Gal}(L/K)$ acts on $\operatorname{Spec}\left(\mathcal{O}\right)$. Suppose $\mathfrak{P}\in \operatorname{Spec}\left(\mathcal{O}\right)$, then the stabilizer subgroup of $\mathfrak{P}$ under this action is called the \textbf{decomposition group} of $\mathfrak{P}$, denoted by
    \[
    D_{\mathfrak{P}}:=\mathrm{Stab}_{\mathrm{Gal}(L/K)}\left(\mathfrak{P}\right)=\left\{ \sigma\in \mathrm{Gal}(L/K)\midv \sigma\left(\mathfrak{P}\right)=\mathfrak{P}\right\}.
    \] 
    $D_{\mathfrak{P}}$ as a subgroup of $\mathrm{Gal}(L/K)$ also acts on $L$, and the $D_{\mathfrak{P}}$-invariant elements of $L$ form a subfield of $L$, called the \textbf{decomposition field} of $\mathfrak{P}$, denoted by 
    \[
    L^{D_{\mathfrak{P}}}=\left\{ x\in L\midv \sigma(x)=x\text{ for all }\sigma\in D_{\mathfrak{P}}\right\}.
    \]
\end{definition}

\begin{proposition}{Decomposition Groups for Prime Ideals over $\mathfrak{p}$ are Conjugate}{}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. For any $\sigma\in \mathrm{Gal}(L/K)$ and any $\mathfrak{P}\in\spec\left(\mathcal{O}\right)$, we have
    \[
    D_{\sigma\left(\mathfrak{P}\right)}=\sigma D_{\mathfrak{P}}\sigma^{-1}.
    \]
\end{proposition}
\begin{prf}
    This is a direct consequence of \Cref{th:properties_of_stabilizer_subgroup}.
\end{prf}

\begin{lemma}{Galois Action Induces Isomorphism of Residue Fields}{galois_action_induces_isomorphism_of_residue_fields}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Suppose $\mathfrak{P}$ is a maximal ideal over $\mathfrak{p}\in \spec\left(\mathcalo\right)$.
    \begin{enumerate}[(i)]
        \item If $\sigma\in \mathrm{Gal}(L/K)$, then there exists a unique field isomorphism
    \begin{align*}
        \widetilde{\sigma}:\mathcal{O}/\mathfrak{P}&\longrightarrow \mathcal{O}/\sigma\mathfrak{P}\\
        a+\mathfrak{P}&\longmapsto \sigma(a)+\sigma\mathfrak{P}
    \end{align*}
    such that the following diagram commutes
    \[
        \begin{tikzcd}
            \mathcal{O} \arrow[r, "\sigma|_{\mathcal{O}}"] \arrow[d, "\pi"', two heads] & \mathcal{O} \arrow[d, "\pi'", two heads] \\
            \mathcal{O}/\mathfrak{P} \arrow[r, "\widetilde{\sigma}"', dashed]                         & \mathcal{O}/\sigma\mathfrak{P}          
        \end{tikzcd}
    \]
    \item If $\sigma\in D_{\mathfrak{P}}$, then there exists a unique $\mathcalo/\mathfrak{p}$-field automorphism
    \begin{align*}
        \widetilde{\sigma}:\mathcal{O}/\mathfrak{P}&\longrightarrow \mathcal{O}/\mathfrak{P}\\
        a+\mathfrak{P}&\longmapsto \sigma(a)+\mathfrak{P}
    \end{align*}
    such that the following diagram commutes
    \[
        \begin{tikzcd}
            \mathcal{O} \arrow[r, "\sigma|_{\mathcal{O}}"] \arrow[d, "\pi"', two heads] & \mathcal{O} \arrow[d, "\pi'", two heads] \\
            \mathcal{O}/\mathfrak{P} \arrow[r, "\widetilde{\sigma}"', dashed]                         & \mathcal{O}/\mathfrak{P}          
        \end{tikzcd}
    \]
    \end{enumerate}
    
\end{lemma}
\begin{prf}
    \begin{enumerate}[(i)]
        \item Suppose $\sigma \in \mathrm{Gal}(L/K)$. Since 
    \[
    \ker \left( \pi'\circ \sigma|_{\mathcal{O}}\right)=\sigma^{-1}(\sigma\mathfrak{P})=\mathfrak{P},
    \]
    by the \hyperref[th:universal_property_of_quotient_ring]{universal property of quotient ring} $\mathcal{O}/\mathfrak{P}$, there exists a unique ring homomorphism 
    \begin{align*}
        \widetilde{\sigma}:\mathcal{O}/\mathfrak{P}&\longrightarrow \mathcal{O}/\sigma\mathfrak{P}\\
        a+\mathfrak{P}&\longmapsto \sigma(a)+\sigma\mathfrak{P}
    \end{align*}
    such that the following diagram commutes
    \[
        \begin{tikzcd}
            \mathcal{O} \arrow[r, "\sigma|_{\mathcal{O}}"] \arrow[d, "\pi"', two heads] & \mathcal{O} \arrow[d, "\pi'", two heads] \\
            \mathcal{O}/\mathfrak{P} \arrow[r, "\widetilde{\sigma}"', dashed]                         & \mathcal{O}/\sigma\mathfrak{P}          
        \end{tikzcd}
    \]
    Furthermore, the surjectivity of $\pi'\circ \sigma|_{\mathcal{O}}$ and $\ker \left( \pi'\circ \sigma|_{\mathcal{O}}\right)=\mathfrak{P}$ implies $\widetilde{\sigma}$ is a an isomorphism of fields. 
    
    \item If $\sigma\in D_{\mathfrak{P}}$, then $\sigma(\mathfrak{P})=\mathfrak{P}$. For any $x\in \mathcalo$, we have
    \[
    \widetilde{\sigma}\left(x +\mathfrak{P}\right)=\sigma(x)+\sigma\mathfrak{P}=x+\mathfrak{P},
    \]
    which means $\widetilde{\sigma}$ is an $\mathcalo/\mathfrak{p}$-automorphism of $\mathcal{O}/\mathfrak{P}$, namely $\widetilde{\sigma}\in\mathrm{Aut}_{\left(\kappa(\mathfrak{p})/\mathsf{Field}\right)}\left(\kappa(\mathfrak{P})/\kappa(\mathfrak{p})\right)$.
    \end{enumerate}
\end{prf}

\begin{proposition}{Ramification Index and Inertia Degree for finite Galois Extension}{}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Suppose $\mathfrak p$ is a nonzero prime ideal of $\mathcalo$, and $\mathfrak p\mathcal{O}$ can be factored as
    \[
    \mathfrak p\mathcal{O}=\mathfrak P_1^{e_1}\cdots\mathfrak P_r^{e_r}.
    \]
    Let $G=\mathrm{Gal}(L/K)$. 
    Then we have 
    \[
    e_1=e_2=\cdots=e_r=e, \quad
    f_1=f_2=\cdots=f_r=f,\quad [L:K]=efr,
    \]
    and
    \[
        \mathfrak p\mathcal{O} =\left(  \mathfrak P_1\cdots\mathfrak P_r\right)^e=\left( \prod_{G\cdot \mathfrak P\in G\backslash \!\spec\left(\mathcal{O}\right)}\mathfrak P\right)^e.
    \]
    For any $m\in\{1,\cdots, r\}$, by orbit-stabilizer theorem, we have
    \[
    \frac{\left|G\right|}{\left|D_{\mathfrak{P}_m}\right|}=|G \cdot \mathfrak{P}_m|=r\text{ and }\left|D_{\mathfrak{P}_m}\right|=ef.
    \]
    So the decomposition group $D_{\mathfrak{P}_m}$ characterizes splitting behavior of $\mathfrak{p}$ in $L$:
    \begin{alignat*}{4}
        &D_{\mathfrak{P}_m} = \{\mathrm{id}\} \quad &\iff\quad & L^{D_{\mathfrak{P}_m}} = L \quad &\iff\quad & \mathfrak{p} \text{ splits completely in } L, \\
        &D_{\mathfrak{P}_m} = G              \quad &\iff\quad & L^{D_{\mathfrak{P}_m}} = K \quad &\iff\quad & \mathfrak{p} \text{ is nonsplit in } L.
    \end{alignat*}
\end{proposition}
\begin{prf}
    According to \Cref{th:galois_action_induces_isomorphism_of_residue_fields}, $[\mathcal{O}/\sigma\mathfrak{P}:\mathcalo/\mathfrak{p}]$ is independent of $\sigma$, which implies 
    \[
    f_1=f_2=\cdots=f_r=f.
    \]
    According to \Cref{th:surjective_ring_homomorphism_induces_semiring_homomorphism_of_ideals}, for any $\sigma\in \mathrm{Gal}(L/K)$, we have
    \[
    \sigma\left(\mathfrak{p}\mathcal{O}\right)=\sigma\left(\mathfrak{P}_1^{e_1}\cdots\mathfrak{P}_r^{e_r}\right)=\sigma\left(\mathfrak{P}_1\right)^{e_1}\cdots\sigma\left(\mathfrak{P}_r\right)^{e_r}.
    \]
    Since $\sigma$ fix $K$, we have
    \begin{align*}
        \sigma\left(\mathfrak{p}\mathcal{O}\right)&=\sigma\left(\left\{ \sum_{i=1}^n a_ix_i \midv n\in\mathbb{Z}_+,a_i\in \mathfrak{p}, x_i\in \mathcal{O}\right\}\right)\\
        &=\left\{ \sum_{i=1}^n \sigma(a_i)\sigma(x_i) \midv n\in\mathbb{Z}_+,a_i\in \mathfrak{p}, x_i\in \mathcal{O}\right\}\\
        &=\left\{ \sum_{i=1}^n a_i\sigma(x_i) \midv n\in\mathbb{Z}_+,a_i\in \mathfrak{p}, x_i\in \mathcal{O}\right\}\\
        &\subseteq \mathfrak{p}\mathcal{O}.
    \end{align*}
    Note 
    \[
    \sigma^{-1}\left(\mathfrak{p}\mathcal{O}\right)\subseteq \mathfrak{p}\mathcal{O}\implies \mathfrak{p}\mathcal{O}\subseteq \sigma\left(\mathfrak{p}\mathcal{O}\right).
    \]
    We have 
    \[
    \sigma\left(\mathfrak{p}\mathcal{O}\right)=\mathfrak{p}\mathcal{O}= \mathfrak{P}_1^{e_1}\cdots\mathfrak{P}_r^{e_r}=\sigma\left(\mathfrak{P}_1\right)^{e_1}\cdots\sigma\left(\mathfrak{P}_r\right)^{e_r}.
    \]
    For any $1\le m\le r$, there exists some $\sigma \in \mathrm{Gal}(L/K)$ such that $\sigma\left(\mathfrak{P}_m\right)=\mathfrak{P}_1$. By the uniqueness of prime factorization, there must be $e_m=e_1$. Thus we proved
    \[
    e_1=e_2=\cdots=e_r=e.
    \]
\end{prf}

\begin{definition}{Inertia Group}{}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Suppose $\mathfrak{P}$ is a maximal ideal over $\mathfrak{p}\in \spec\left(\mathcalo\right)$. The \textbf{inertia group} of $\mathfrak{P}$ is defined as the kernel of the surjective group homomorphism
    \begin{align*}
        \xi:D_{\mathfrak{P}}&\longrightarrow \mathrm{Aut}_{\left(\kappa(\mathfrak{p})/\mathsf{Field}\right)}\left(\kappa(\mathfrak{P})/\kappa(\mathfrak{p})\right)\\
        \sigma&\longmapsto \widetilde{\sigma}.
    \end{align*}
    denote by $I_{\mathfrak{P}}:=\ker \xi$. And we have the following exact sequence
    \[
    1\longrightarrow I_{\mathfrak{P}}\longrightarrow D_{\mathfrak{P}}\longrightarrow \mathrm{Aut}\left(\kappa(\mathfrak{P})/\kappa(\mathfrak{p})\right)\longrightarrow 1.
    \]
\end{definition}

\begin{proposition}{}{}
    Let $\mathcalo$ be a normal integral domain with fraction field $K$. Let $L/K$ be a (possibly infinite) Galois extension. Let $G = \text{Gal}(L/K)$ and let
    $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$.
\begin{enumerate}[(i)]
    \item For any two primes
    $\mathfrak P, \mathfrak P' \in \spec(\mathcal{O})$ lying over the same prime in $\mathcalo$, there exists a $\sigma \in G$ with $\sigma(\mathfrak P) = \mathfrak P'$.
    \item Let $\mathfrak P \in \spec(\mathcal{O}) $ be a prime lying over
    $\mathfrak p \in \spec(\mathcalo)$. Then $\kappa(\mathfrak P)/\kappa(\mathfrak p)$
    is an algebraic normal field extension and the map
    $$
    D_{\mathfrak P} = \{\sigma \in G \mid \sigma(\mathfrak P) = \mathfrak q\}
    \longrightarrow
    \text{Aut}(\kappa(\mathfrak P)/\kappa(\mathfrak p))
    $$
is surjective.
\end{enumerate}
\end{proposition}
\begin{prf}
\url{https://stacks.math.columbia.edu/tag/0BRK}
\end{prf}

\begin{definition}{Frobenius Element}{}
    Let $\mathcalo$ be a Dedekind domain with field of fractions $K=\mathrm{Frac}(\mathcalo)$. Let $L/K$ be a finite Galois extension and $\mathcal{O}$ be the integral closure of $\mathcalo$ in $L$. Suppose $\mathfrak{P}$ is a maximal ideal over $\mathfrak{p}\in \spec\left(\mathcalo\right)$ and $\kappa(\mathfrak{p})$ is a finite field isomorphic to $\mathbb{F}_{q}$. Then $\kappa(\mathfrak{P})/\kappa(\mathfrak{p})$ is a finite Galois extension and we have the following exact sequence
    \[
    1\longrightarrow I_{\mathfrak{P}}\longrightarrow D_{\mathfrak{P}}\xlongrightarrow{\xi} \mathrm{Gal}\left(\kappa(\mathfrak{P})/\kappa(\mathfrak{p})\right)\longrightarrow 1.
    \]
    \begin{itemize}
        \item The set of \textbf{Frobenius elements} for $\mathfrak{P}$ is defined as the preimage of the Frobenius automorphism of $\mathrm{Fr}_q:x\mapsto x^q$ in $\mathrm{Gal}\left(\kappa(\mathfrak{P})/\kappa(\mathfrak{p})\right)$, denoted by $\mathrm{Frob}_{\mathfrak{p},\mathfrak{P}}:=\xi^{-1}\left(\mathrm{Fr}_q\right)$.
        \item The \textbf{Frobenius conjugacy class} for a Frobenius element $\sigma\in \mathrm{Frob}_{\mathfrak{p},\mathfrak{P}}$ is defined as the conjugacy class of $\sigma$ in $\mathrm{Gal}(L/K)$. $\sigma \in \mathrm{Frob}_{\mathfrak{p},\mathfrak{P}}$ if and only if $\tau \sigma \tau^{-1}\in  \mathrm{Frob}_{\mathfrak{p},\tau \mathfrak{P}}$ for some $\tau\in \mathrm{Gal}(L/K)$.
        \item If $I_{\mathfrak{P}}$ is trivial, then $\mathfrak{p}$ is unramified in $L$ and the Frobenius element $\mathrm{Frob}_{\mathfrak{p},\mathfrak{P}}$ is unique. We denote the Frobenius conjugacy class of $\mathrm{Frob}_{\mathfrak{p},\mathfrak{P}}$ by $\mathrm{Frob}_{\mathfrak{p}, L}$ or $\mathrm{Frob}_{\mathfrak{p}}$ for short.
        \item If $I_{\mathfrak{P}}$ is trivial and $L/K$ is Abelian, then the Frobenius conjugacy class $\mathrm{Frob}_{\mathfrak{p}, L}$ has only one element, which is called the \textbf{Frobenius element} of $\mathfrak{p}$ in $L$.
    \end{itemize}
    
\end{definition}


\section{Absolute Value}
\begin{definition}{Absolute Value on an Integral Ring}{}
    Let $R$ be an integral ring. An \textbf{absolute value} on $R$ is a function $|\cdot|:R\to \mathbb{R}_{\ge0}$ satisfying the following properties:
    \begin{enumerate}[(i)]
        \item (positive definiteness) $|a|=0\iff a=0$.
        \item (multiplicativity) $|ab|=|a||b|$.
        \item (triangle inequality) $|a+b|\le |a|+|b|$.
    \end{enumerate}
\end{definition}

An absolute value on $R$ induces a metric (and thus a topology) by 
\[
    d(a,b)=|a-b|,
\]
which makes $(R,|\cdot|)$ a topological ring. 
\begin{definition}{Equivalent Absolute Value}{}
    Let $R$ be an integral ring and $|\cdot|,|\cdot|'$ be two absolute values on $R$. $|\cdot|$ and $|\cdot|'$ are called \textbf{equivalent} if they induce the same topology on $R$.
\end{definition}

\begin{definition}{Trivial Absolute Value}{}
    Let $R$ be an integral ring. The \textbf{trivial absolute value} on $R$ is defined by 
    \[
        |a|=\begin{cases}
            0, & a=0_R\\
            1, & a\ne 0_R
        \end{cases}
    \]
\end{definition}

On a finite field, the trivial absolute value is the only absolute value.
\begin{definition}{Archimedean Absolute Value}{}
    If an absolute value $|\cdot|$ satisfies the stronger property 
    \[
        |a+b|\le \max\{|a|,|b|\},
    \]
    then $|\cdot|$ is called an \textbf{non-Archimedean absolute value}. Otherwise, $|\cdot|$ is called an \textbf{Archimedean absolute value}.
\end{definition}

\begin{proposition}{}{}
    Let $R$ be an integral ring and $|\cdot|$ be an absolute value on $R$. Then $|\cdot|$ is non-Archimedean if and only if $\left\{ |n1_R|:n\in \mathbb{Z}\right\}$ is bounded.
\end{proposition}

\begin{prf}
    Suppose $|\cdot|$ is non-Archimedean. Then for any $n\in\mathbb{Z}$, we have
    \[
        |n1_R|=|1_R+\cdots+1_R|\le \max\{|1_R|,\cdots,|1_R|\}=|1_R|=1.
    \]
    Thus $\left\{ |n1_R|:n\in \mathbb{Z}\right\}$ is bounded.\\
    Conversely, suppose $\left\{ |n1_R|:n\in \mathbb{Z}\right\}$ is bounded by $M$. Then for any $a,b\in R$, we have 
    \begin{align*}
        |a+b|^n&=|(a+b)^n|\\
        &=\left| \sum_{i=0}^n\binom{n}{i}a^ib^{n-i}\right|\\
        &\le \sum_{i=0}^n\left|\binom{n}{i}1_R\right||a|^i|b|^{n-i}\\
        &\le \sum_{i=0}^n M\max\{|a|,|b|\}^i\max\{|a|,|b|\}^{n-i}\\
        &=(n+1) M \max\{|a|,|b|\}^n.
    \end{align*}
    As $n\to \infty$, we have
    \[
        |a+b|\le \left((n+1) M \right)^{\frac{1}{n}}\max\{|a|,|b|\}\to \max\{|a|,|b|\}.
        \]
    Thus $|\cdot|$ is non-Archimedean.
\end{prf}



\section{Valuation Ring}

\begin{definition}{Dominance of Local Rings}{}
    A \hyperref[th:local_commutative_ring]{local ring} $S$ is said to \textbf{dominate} another local ring $R$ if one of the following equivalent condition holds
    \begin{enumerate}[(i)]
        \item $R\subseteq S$ and $\mathfrak{m}_R=\mathfrak{m}_S\cap R$, where $\mathfrak{m}_R$ and $\mathfrak{m}_S$ are the maximal ideals of $R$ and $S$ respectively.
        \item The inclusion map $i:R\hookrightarrow S$ is a local ring homomorphism.
    \end{enumerate}
  
\end{definition}

\begin{definition}{Valuation Ring}{}
    Suppose $R$ is an integral domain and has field of fractions $K=\operatorname{Frac}\left(R\right)$. We say $R$ is a \textbf{valuation ring} if $R$ satisfies one of the following equivalent conditions:
    \begin{enumerate}[(i)]
        \item For every $x\in K^\times$, either $x\in R$ or $x^{-1}\in R$.
        \item The ideals of $R$ are totally ordered by inclusion.
        \item The principal ideals of $R$ are totally ordered by inclusion (i.e. the elements in $R$ are, up to units, totally ordered by divisibility.)
        \item $R$ is a local ring and $R$ is maximal among all local rings contained in $K$ partially ordered by dominance.
        \item There is a \hyperref[th:totally_ordered_abelian_group]{totally ordered abelian group} $\left(\Gamma,\le\right)$ and a \hyperref[th:valuation_of_field]{valuation} $v:K \rightarrow \Gamma \cup\{\infty\}$ such that $R$ is the valuation ring of $v$, i.e.
        \[
            R=\mathcal{O}_v=\{x \in K \mid v(x) \ge 0\}.
        \]
    \end{enumerate}
\end{definition}

\begin{prf}
    The equivalence of these conditions can be shown as follows.
    \begin{itemize}[leftmargin=*]
        \item (i)$\implies$(ii). Suppose $I,J$ are two distinct ideals of $R$. Without loss of generality, we can assume $I\subsetneq J$ and there exists $a\in I-J$. Suppose $b\in J$. Since $a\notin J$, there must be $ab^{-1}\notin R$, which forces $ba^{-1}\in R$. Thus there exists $r\in R$ such that $b=ra$, implying $b\in I$. Therefore, we show $J\subseteq I$.
        \item (ii)$\implies$(iii). Trivial.
        \item (iii)$\implies$(i). Given any $x\in K^{\times}$, there exists $a,b\in R$ such $x=ab^{-1}$. Then we have
    \begin{align*}
        (a)\subseteq (b)\text{ or }(b)\subseteq (a) \implies ab^{-1}\in R\text{ or } ba^{-1}\in R \implies x\in R \text{ or } x^{-1}\in R.
    \end{align*}
        \item (i)$\implies$(v). Take $\Gamma=K^\times / R^\times$. Define a binary relation $\le$ on $\Gamma$ by $xR^\times\le yR^\times\iff yx^{-1}\in R$. Then we can check $\left(\Gamma, \le\right)$ is a totally ordered abelian group:
    \begin{enumerate}[(a)]
        \item (reflexivity) For any $xR^\times\in \Gamma$, we have $xx^{-1}=1\in R$, which implies $xR^\times\le xR^\times$.
        \item (antisymmetry) Suppose $x R^{\times} \le y R^{\times}$ and $y R^{\times} \le x R^{\times}$. Then $y x^{-1} \in R$ and $\left(y x^{-1}\right)^{-1}=x y^{-1} \in R$, implying $y x^{-1}\in R^\times$. Therefore, $x R^{\times}=y R^{\times}$.
        \item (transitivity) If $x R^{\times} \leq y R^{\times}$ and $y R^{\times} \leq z R^{\times}$, then $y x^{-1} \in R$ and $z y^{-1} \in R$, so $z x^{-1}=\left(z y^{-1}\right)\left(y x^{-1}\right) \in R$, implying $x R^{\times} \leq z R^{\times}$.
        \item (strong connectivity) For any $xR^\times, yR^\times\in \Gamma$, either $xy^{-1}\in R$ or $y^{-1}x\in R$, which means $xR^\times\le yR^\times$ or $yR^\times\le xR^\times$.
        \item (order preservation) For any $xR^\times, yR^\times, zR^\times\in \Gamma$, we have
        \begin{align*}
            xR^\times\le yR^\times\implies yx^{-1}\in R\implies  (yz)\left(xz\right)^{-1}\in R\implies xzR^\times\le yzR^\times.
        \end{align*}
    \end{enumerate}
    Take $v$ to be the natural projection
    \begin{align*}
        v:K&\longrightarrow \Gamma\cup\{\infty\}\\
        x&\longmapsto \begin{cases}
            xR^\times, &\text{ if } x\ne 0\\
            \infty, &\text{ if } x=0
        \end{cases}
    \end{align*}
    Then we can check that $v$ is a valuation of $K$. For any $x,y\in K$, if $x=0$ or $y=0$ or $x+y=0$, then it is clear to see $v(x+y)=\min\{v(x),v(y)\}$. If $x\ne 0$, $y\ne0$ and $x+y\ne 0$, then we have
    \begin{align*}
        v(x)\le v(x+y)&\iff (x+y)y^{-1}\in R\iff xy^{-1}+1\in R\iff xy^{-1}\in R,\\
        v(y)\le v(x+y)&\iff (x+y)x^{-1}\in R\iff yx^{-1}+1\in R\iff yx^{-1}\in R.
    \end{align*}
    which implies either $v(x+y)\ge v(x)$ or $v(x+y)\ge v(y)$. Therefore, we show $v(x+y)\ge \min\{v(x),v(y)\}$.
    \item (ii)$\implies$(iv). Since ideals of $R$ are totally ordered by inclusion, there exists a unique maximal ideal $\mathfrak{m}$ of $R$. Hence $R$ is a local ring.
\end{itemize}
\end{prf}



\begin{proposition}{}{}
    Let $K$ be a field. Let $R \subseteq K$ be a local subring. Then there exists a valuation ring with fraction field $K$ dominating $R$.
\end{proposition}


\begin{definition}{Discrete Valuation Ring}{}
    Suppose $R$ is an integral domain and has field of fractions $K=\mathrm{Frac}\left(R\right)$. We say $R$ is a \textbf{discrete valuation ring} if $R$ satisfies one of the following equivalent conditions:
    \begin{enumerate}[(i)]
        \item $R$ is a valuation ring such that the induced valuation $v:K\to \Gamma\cup\{\infty\}$ is a discrete valuation.
        \item $R$ is a local PID, and not a field.
        \item $R$ is a PID with a unique non-zero prime ideal.
        \item $R$ is a PID with a unique irreducible element (up to multiplication by units).
        \item $R$ is a UFD with a unique irreducible element (up to multiplication by units).
        \item $R$ is a local Dedekind domain and not a field.
        \item $R$ is a Noetherian local domain whose maximal ideal is principal, and not a field. 
        \item $R$ is an integrally closed Noetherian local ring with Krull dimension one.
        \item $R$ is Noetherian, not a field, and every nonzero fractional ideal of $R$ is irreducible in the sense that it cannot be written as a finite intersection of fractional ideals properly containing it.
    \end{enumerate}
\end{definition}

\begin{proposition}{}{}
    A valuation ring is Noetherian if and only if it is a discrete valuation ring or a field.
\end{proposition}


